<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>&lt;no title&gt; &#8212; twit  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../../../../../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../../../_static/alabaster.css?v=039e1c02" />
    <script data-url_root="../../../../../../../../../" id="documentation_options" src="../../../../../../../../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../../../../../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../../../../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../../../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../../../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p>package com.twitter.timelineranker.model</p>
<p>import com.twitter.servo.util.Gate
import com.twitter.timelines.model.candidate.CandidateTweetSourceId
import com.twitter.timelineranker.{thriftscala =&gt; thrift}
import com.twitter.timelines.common.model._
import com.twitter.timelines.earlybird.common.options.EarlybirdOptions
import com.twitter.timelines.earlybird.common.utils.SearchOperator
import com.twitter.timelines.configapi.{</p>
<blockquote>
<div><p>DependencyProvider =&gt; ConfigApiDependencyProvider,
FutureDependencyProvider =&gt; ConfigApiFutureDependencyProvider,
_</p>
</div></blockquote>
<p>}
import com.twitter.timelines.model.TweetId
import com.twitter.timelines.model.UserId
import com.twitter.timelineservice.DeviceContext</p>
<p>object RecapQuery {</p>
<blockquote>
<div><dl class="simple">
<dt>val EngagedTweetsSupportedTweetKindOption: TweetKindOption.ValueSet = TweetKindOption(</dt><dd><p>includeReplies = false,
includeRetweets = false,
includeExtendedReplies = false,
includeOriginalTweetsAndQuotes = true</p>
</dd>
</dl>
<p>)</p>
<p>val DefaultSearchOperator: SearchOperator.Value = SearchOperator.Exclude
def fromThrift(query: thrift.RecapQuery): RecapQuery = {</p>
<blockquote>
<div><dl>
<dt>RecapQuery(</dt><dd><p>userId = query.userId,
maxCount = query.maxCount,
range = query.range.map(TimelineRange.fromThrift),
options = query.options</p>
<blockquote>
<div><p>.map(options =&gt; TweetKindOption.fromThrift(options.to[Set]))
.getOrElse(TweetKindOption.None),</p>
</div></blockquote>
<dl class="simple">
<dt>searchOperator = query.searchOperator</dt><dd><p>.map(SearchOperator.fromThrift)
.getOrElse(DefaultSearchOperator),</p>
</dd>
</dl>
<p>earlybirdOptions = query.earlybirdOptions.map(EarlybirdOptions.fromThrift),
deviceContext = query.deviceContext.map(DeviceContext.fromThrift),
authorIds = query.authorIds,
excludedTweetIds = query.excludedTweetIds,
searchClientSubId = query.searchClientSubId,
candidateTweetSourceId =</p>
<blockquote>
<div><p>query.candidateTweetSourceId.flatMap(CandidateTweetSourceId.fromThrift),</p>
</div></blockquote>
<p>hydratesContentFeatures = query.hydratesContentFeatures</p>
</dd>
</dl>
<p>)</p>
</div></blockquote>
<p>}</p>
<dl>
<dt>def fromThrift(query: thrift.RecapHydrationQuery): RecapQuery = {</dt><dd><p>require(query.tweetIds.nonEmpty, “tweetIds must be non-empty”)</p>
<dl>
<dt>RecapQuery(</dt><dd><p>userId = query.userId,
tweetIds = Some(query.tweetIds),
searchOperator = DefaultSearchOperator,
earlybirdOptions = query.earlybirdOptions.map(EarlybirdOptions.fromThrift),
deviceContext = query.deviceContext.map(DeviceContext.fromThrift),
candidateTweetSourceId =</p>
<blockquote>
<div><p>query.candidateTweetSourceId.flatMap(CandidateTweetSourceId.fromThrift),</p>
</div></blockquote>
<p>hydratesContentFeatures = query.hydratesContentFeatures</p>
</dd>
</dl>
<p>)</p>
</dd>
</dl>
<p>}</p>
<dl>
<dt>def fromThrift(query: thrift.EngagedTweetsQuery): RecapQuery = {</dt><dd><dl>
<dt>val options = query.tweetKindOptions</dt><dd><p>.map(tweetKindOptions =&gt; TweetKindOption.fromThrift(tweetKindOptions.to[Set]))
.getOrElse(TweetKindOption.None)</p>
</dd>
<dt>if (!(options.isEmpty ||</dt><dd><blockquote>
<div><p>(options == EngagedTweetsSupportedTweetKindOption))) {</p>
</div></blockquote>
<p>throw new IllegalArgumentException(s”Unsupported TweetKindOption value: $options”)</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>RecapQuery(</dt><dd><p>userId = query.userId,
maxCount = query.maxCount,
range = query.range.map(TimelineRange.fromThrift),
options = options,
searchOperator = DefaultSearchOperator,
earlybirdOptions = query.earlybirdOptions.map(EarlybirdOptions.fromThrift),
deviceContext = query.deviceContext.map(DeviceContext.fromThrift),
authorIds = query.userIds,
excludedTweetIds = query.excludedTweetIds,</p>
</dd>
</dl>
<p>)</p>
</dd>
</dl>
<p>}</p>
<dl>
<dt>def fromThrift(query: thrift.EntityTweetsQuery): RecapQuery = {</dt><dd><dl class="simple">
<dt>require(</dt><dd><p>query.semanticCoreIds.isDefined,
“entities(semanticCoreIds) can’t be None”</p>
</dd>
</dl>
<p>)
val options = query.tweetKindOptions</p>
<blockquote>
<div><p>.map(tweetKindOptions =&gt; TweetKindOption.fromThrift(tweetKindOptions.to[Set]))
.getOrElse(TweetKindOption.None)</p>
</div></blockquote>
<dl>
<dt>RecapQuery(</dt><dd><p>userId = query.userId,
maxCount = query.maxCount,
range = query.range.map(TimelineRange.fromThrift),
options = options,
searchOperator = DefaultSearchOperator,
earlybirdOptions = query.earlybirdOptions.map(EarlybirdOptions.fromThrift),
deviceContext = query.deviceContext.map(DeviceContext.fromThrift),
excludedTweetIds = query.excludedTweetIds,
semanticCoreIds = query.semanticCoreIds.map(_.map(SemanticCoreAnnotation.fromThrift).toSet),
hashtags = query.hashtags.map(_.toSet),
languages = query.languages.map(_.map(Language.fromThrift).toSet),
candidateTweetSourceId =</p>
<blockquote>
<div><p>query.candidateTweetSourceId.flatMap(CandidateTweetSourceId.fromThrift),</p>
</div></blockquote>
<p>includeNullcastTweets = query.includeNullcastTweets,
includeTweetsFromArchiveIndex = query.includeTweetsFromArchiveIndex,
authorIds = query.authorIds,
hydratesContentFeatures = query.hydratesContentFeatures</p>
</dd>
</dl>
<p>)</p>
</dd>
</dl>
<p>}</p>
<dl>
<dt>def fromThrift(query: thrift.UtegLikedByTweetsQuery): RecapQuery = {</dt><dd><dl>
<dt>val options = query.tweetKindOptions</dt><dd><p>.map(tweetKindOptions =&gt; TweetKindOption.fromThrift(tweetKindOptions.to[Set]))
.getOrElse(TweetKindOption.None)</p>
</dd>
<dt>RecapQuery(</dt><dd><p>userId = query.userId,
maxCount = query.maxCount,
range = query.range.map(TimelineRange.fromThrift),
options = options,
earlybirdOptions = query.earlybirdOptions.map(EarlybirdOptions.fromThrift),
deviceContext = query.deviceContext.map(DeviceContext.fromThrift),
excludedTweetIds = query.excludedTweetIds,
utegLikedByTweetsOptions = for {</p>
<blockquote>
<div><p>utegCount &lt;- query.utegCount
weightedFollowings &lt;- query.weightedFollowings.map(_.toMap)</p>
</div></blockquote>
<dl>
<dt>} yield {</dt><dd><dl class="simple">
<dt>UtegLikedByTweetsOptions(</dt><dd><p>utegCount = utegCount,
isInNetwork = query.isInNetwork,
weightedFollowings = weightedFollowings</p>
</dd>
</dl>
<p>)</p>
</dd>
</dl>
<p>},
candidateTweetSourceId =</p>
<blockquote>
<div><p>query.candidateTweetSourceId.flatMap(CandidateTweetSourceId.fromThrift),</p>
</div></blockquote>
<p>hydratesContentFeatures = query.hydratesContentFeatures</p>
</dd>
</dl>
<p>)</p>
</dd>
</dl>
<p>}</p>
<p>val paramGate: (Param[Boolean] =&gt; Gate[RecapQuery]) = HasParams.paramGate</p>
<p>type DependencyProvider[+T] = ConfigApiDependencyProvider[RecapQuery, T]
object DependencyProvider extends DependencyProviderFunctions[RecapQuery]</p>
<p>type FutureDependencyProvider[+T] = ConfigApiFutureDependencyProvider[RecapQuery, T]
object FutureDependencyProvider extends FutureDependencyProviderFunctions[RecapQuery]</p>
</div></blockquote>
<p>}</p>
<dl>
<dt>/**</dt><dd><ul class="simple">
<li><p>Model object corresponding to RecapQuery thrift struct.</p></li>
</ul>
<p><a href="#id1"><span class="problematic" id="id2">*</span></a>/</p>
</dd>
<dt>case class RecapQuery(</dt><dd><p>userId: UserId,
maxCount: Option[Int] = None,
range: Option[TimelineRange] = None,
options: TweetKindOption.ValueSet = TweetKindOption.None,
searchOperator: SearchOperator.Value = RecapQuery.DefaultSearchOperator,
earlybirdOptions: Option[EarlybirdOptions] = None,
deviceContext: Option[DeviceContext] = None,
authorIds: Option[Seq[UserId]] = None,
tweetIds: Option[Seq[TweetId]] = None,
semanticCoreIds: Option[Set[SemanticCoreAnnotation]] = None,
hashtags: Option[Set[String]] = None,
languages: Option[Set[Language]] = None,
excludedTweetIds: Option[Seq[TweetId]] = None,
// options used only for yml tweets
utegLikedByTweetsOptions: Option[UtegLikedByTweetsOptions] = None,
searchClientSubId: Option[String] = None,
override val params: Params = Params.Empty,
candidateTweetSourceId: Option[CandidateTweetSourceId.Value] = None,
includeNullcastTweets: Option[Boolean] = None,
includeTweetsFromArchiveIndex: Option[Boolean] = None,
hydratesContentFeatures: Option[Boolean] = None)</p>
<blockquote>
<div><p>extends HasParams {</p>
</div></blockquote>
<dl class="simple">
<dt>override def toString: String = {</dt><dd><dl class="simple">
<dt>s”RecapQuery(userId: $userId, maxCount: $maxCount, range: $range, options: $options, searchOperator: $searchOperator, “ +</dt><dd><p>s”earlybirdOptions: $earlybirdOptions, deviceContext: $deviceContext, authorIds: $authorIds, “ +
s”tweetIds: $tweetIds, semanticCoreIds: $semanticCoreIds, hashtags: $hashtags, languages: $languages, excludedTweetIds: $excludedTweetIds, “ +
s”utegLikedByTweetsOptions: $utegLikedByTweetsOptions, searchClientSubId: $searchClientSubId, “ +
s”params: $params, candidateTweetSourceId: $candidateTweetSourceId, includeNullcastTweets: $includeNullcastTweets, “ +
s”includeTweetsFromArchiveIndex: $includeTweetsFromArchiveIndex), hydratesContentFeatures: $hydratesContentFeatures”</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
<dl>
<dt>def throwIfInvalid(): Unit = {</dt><dd><dl class="simple">
<dt>def noDuplicates[T &lt;: Traversable[_]](elements: T) = {</dt><dd><p>elements.toSet.size == elements.size</p>
</dd>
</dl>
<p>}</p>
<p>maxCount.foreach { max =&gt; require(max &gt; 0, “maxCount must be a positive integer”) }
range.foreach(_.throwIfInvalid())
earlybirdOptions.foreach(_.throwIfInvalid())
tweetIds.foreach { ids =&gt; require(ids.nonEmpty, “tweetIds must be nonEmpty if present”) }
semanticCoreIds.foreach(_.foreach(_.throwIfInvalid()))
languages.foreach(_.foreach(_.throwIfInvalid()))
languages.foreach { langs =&gt;</p>
<blockquote>
<div><p>require(langs.nonEmpty, “languages must be nonEmpty if present”)
require(noDuplicates(langs.map(_.language)), “languages must be unique”)</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>}</p>
<p>throwIfInvalid()</p>
<dl>
<dt>def toThriftRecapQuery: thrift.RecapQuery = {</dt><dd><p>val thriftOptions = Some(TweetKindOption.toThrift(options))
thrift.RecapQuery(</p>
<blockquote>
<div><p>userId,
maxCount,
range.map(_.toTimelineRangeThrift),
deprecatedMinCount = None,
thriftOptions,
earlybirdOptions.map(_.toThrift),
deviceContext.map(_.toThrift),
authorIds,
excludedTweetIds,
Some(SearchOperator.toThrift(searchOperator)),
searchClientSubId,
candidateTweetSourceId.flatMap(CandidateTweetSourceId.toThrift)</p>
</div></blockquote>
<p>)</p>
</dd>
</dl>
<p>}</p>
<dl>
<dt>def toThriftRecapHydrationQuery: thrift.RecapHydrationQuery = {</dt><dd><p>require(tweetIds.isDefined &amp;&amp; tweetIds.get.nonEmpty, “tweetIds must be present”)
thrift.RecapHydrationQuery(</p>
<blockquote>
<div><p>userId,
tweetIds.get,
earlybirdOptions.map(_.toThrift),
deviceContext.map(_.toThrift),
candidateTweetSourceId.flatMap(CandidateTweetSourceId.toThrift)</p>
</div></blockquote>
<p>)</p>
</dd>
</dl>
<p>}</p>
<dl>
<dt>def toThriftEntityTweetsQuery: thrift.EntityTweetsQuery = {</dt><dd><p>val thriftTweetKindOptions = Some(TweetKindOption.toThrift(options))
thrift.EntityTweetsQuery(</p>
<blockquote>
<div><p>userId = userId,
maxCount = maxCount,
range = range.map(_.toTimelineRangeThrift),
tweetKindOptions = thriftTweetKindOptions,
earlybirdOptions = earlybirdOptions.map(_.toThrift),
deviceContext = deviceContext.map(_.toThrift),
excludedTweetIds = excludedTweetIds,
semanticCoreIds = semanticCoreIds.map(_.map(_.toThrift)),
hashtags = hashtags,
languages = languages.map(_.map(_.toThrift)),
candidateTweetSourceId.flatMap(CandidateTweetSourceId.toThrift),
includeNullcastTweets = includeNullcastTweets,
includeTweetsFromArchiveIndex = includeTweetsFromArchiveIndex,
authorIds = authorIds</p>
</div></blockquote>
<p>)</p>
</dd>
</dl>
<p>}</p>
<p>def toThriftUtegLikedByTweetsQuery: thrift.UtegLikedByTweetsQuery = {</p>
<blockquote>
<div><p>val thriftTweetKindOptions = Some(TweetKindOption.toThrift(options))
thrift.UtegLikedByTweetsQuery(</p>
<blockquote>
<div><p>userId = userId,
maxCount = maxCount,
utegCount = utegLikedByTweetsOptions.map(_.utegCount),
range = range.map(_.toTimelineRangeThrift),
tweetKindOptions = thriftTweetKindOptions,
earlybirdOptions = earlybirdOptions.map(_.toThrift),
deviceContext = deviceContext.map(_.toThrift),
excludedTweetIds = excludedTweetIds,
isInNetwork = utegLikedByTweetsOptions.map(_.isInNetwork).get,
weightedFollowings = utegLikedByTweetsOptions.map(_.weightedFollowings),
candidateTweetSourceId = candidateTweetSourceId.flatMap(CandidateTweetSourceId.toThrift)</p>
</div></blockquote>
<p>)</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>}</p>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../../../../../../index2.rst.html">twit</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../../../../../../index2.rst.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, jare.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../../../../../../../_sources/timelineranker/common/src/main/scala/com/twitter/timelineranker/model/RecapQuery.scala.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>&lt;no title&gt; &#8212; twit  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../../../../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../../_static/alabaster.css?v=039e1c02" />
    <script data-url_root="../../../../../../../../" id="documentation_options" src="../../../../../../../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../../../../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../../../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p>package com.twitter.search.earlybird.common.config;</p>
<p>import java.lang.reflect.Modifier;
import java.util.Arrays;
import java.util.List;
import java.util.function.BiFunction;
import java.util.function.Function;
import java.util.stream.Collectors;</p>
<p>import com.google.common.collect.ImmutableList;</p>
<p>import com.twitter.app.Flag;
import com.twitter.app.Flaggable;
import com.twitter.app.Flags;
import com.twitter.finagle.mtls.authentication.ServiceIdentifier;</p>
<dl>
<dt>/**</dt><dd><ul class="simple">
<li><p>Stateless class that represents an Earlybird property that can be specified by a command line</p></li>
<li><p>flag.</p></li>
<li><p>&lt;p&gt;</p></li>
<li><p>This is a regular Java class instead of enum to have a generic type.</p></li>
<li></li>
<li><p>&#64;param &lt;T&gt;</p></li>
</ul>
<p><a href="#id1"><span class="problematic" id="id2">*</span></a>/</p>
</dd>
</dl>
<p>public final class EarlybirdProperty&lt;T&gt; {</p>
<blockquote>
<div><p>private static final class PropertyType&lt;T&gt; {</p>
<blockquote>
<div><dl class="simple">
<dt>private static final PropertyType&lt;Boolean&gt; BOOLEAN = new PropertyType&lt;&gt;(</dt><dd><p>Flaggable.ofJavaBoolean(), EarlybirdConfig::getBool, EarlybirdConfig::getBool);</p>
</dd>
<dt>private static final PropertyType&lt;Integer&gt; INT = new PropertyType&lt;&gt;(</dt><dd><p>Flaggable.ofJavaInteger(), EarlybirdConfig::getInt, EarlybirdConfig::getInt);</p>
</dd>
<dt>private static final PropertyType&lt;String&gt; STRING = new PropertyType&lt;&gt;(</dt><dd><p>Flaggable.ofString(), EarlybirdConfig::getString, EarlybirdConfig::getString);</p>
</dd>
</dl>
<p>private final Flaggable&lt;T&gt; flaggable;
private final Function&lt;String, T&gt; getter;
private final BiFunction&lt;String, T, T&gt; getterWithDefault;</p>
<dl>
<dt>private PropertyType(Flaggable&lt;T&gt; flaggable, Function&lt;String, T&gt; getter,</dt><dd><blockquote>
<div><p>BiFunction&lt;String, T, T&gt; getterWithDefault) {</p>
</div></blockquote>
<p>this.flaggable = flaggable;
this.getter = getter;
this.getterWithDefault = getterWithDefault;</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>}</p>
<dl>
<dt>public static final EarlybirdProperty&lt;String&gt; PENGUIN_VERSION =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“penguin_version”,
“The penguin version to index.”,
PropertyType.STRING,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;Integer&gt; THRIFT_PORT = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“thrift_port”,
“override thrift port from config file”,
PropertyType.INT,
false);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;Integer&gt; WARMUP_THRIFT_PORT = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“warmup_thrift_port”,
“override warmup thrift port from config file”,
PropertyType.INT,
false);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;Integer&gt; SEARCHER_THREADS = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“searcher_threads”,
“override number of searcher threads from config file”,
PropertyType.INT,
false);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; EARLYBIRD_TIER = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“earlybird_tier”,
“the earlybird tier (e.g. tier1), used on Aurora”,
PropertyType.STRING,
true);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;Integer&gt; REPLICA_ID = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“replica_id”,
“the ID in a partition, used on Aurora”,
PropertyType.INT,
true);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;Integer&gt; PARTITION_ID = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“partition_id”,
“partition ID, used on Aurora”,
PropertyType.INT,
true);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;Integer&gt; NUM_PARTITIONS = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“num_partitions”,
“number of partitions, used on Aurora”,
PropertyType.INT,
true);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;Integer&gt; NUM_INSTANCES = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“num_instances”,
“number of instances in the job, used on Aurora”,
PropertyType.INT,
true);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;Integer&gt; SERVING_TIMESLICES = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“serving_timeslices”,
“number of time slices to serve, used on Aurora”,
PropertyType.INT,
true);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; ROLE = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“role”,
“Role in the service path of Earlybird”,
PropertyType.STRING,
true,
true);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; EARLYBIRD_NAME = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“earlybird_name”,
“Name in the service path of Earlybird without hash partition suffix”,
PropertyType.STRING,
true,
true);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; ENV = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“env”,
“Environment in the service path of Earlybird”,
PropertyType.STRING,
true,
true);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; ZONE = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“zone”,
“Zone (data center) in the service path of Earlybird”,
PropertyType.STRING,
true,
true);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; DL_URI = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“dl_uri”,
“DistributedLog URI for default DL reader”,
PropertyType.STRING,
false);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; USER_UPDATES_DL_URI = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“user_updates_dl_uri”,
“DistributedLog URI for user updates DL reader”,
PropertyType.STRING,
false);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; ANTISOCIAL_USERUPDATES_DL_STREAM =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“antisocial_userupdates_dl_stream”,
“DL stream name for antisocial user updates without DL version suffix”,
PropertyType.STRING,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; ZK_APP_ROOT = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“zk_app_root”,
“SZooKeeper base root path for this application”,
PropertyType.STRING,
true);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;Boolean&gt; SEGMENT_LOAD_FROM_HDFS_ENABLED =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“segment_load_from_hdfs_enabled”,
“Whether to load segment data from HDFS”,
PropertyType.BOOLEAN,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;Boolean&gt; SEGMENT_FLUSH_TO_HDFS_ENABLED =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“segment_flush_to_hdfs_enabled”,
“Whether to flush segment data to HDFS”,
PropertyType.BOOLEAN,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; HDFS_SEGMENT_SYNC_DIR = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“hdfs_segment_sync_dir”,
“HDFS directory to sync segment data”,
PropertyType.STRING,
false);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; HDFS_SEGMENT_UPLOAD_DIR = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“hdfs_segment_upload_dir”,
“HDFS directory to upload segment data”,
PropertyType.STRING,
false);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;Boolean&gt; ARCHIVE_DAILY_STATUS_BATCH_FLUSHING_ENABLED =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“archive_daily_status_batch_flushing_enabled”,
“Whether to enable archive daily status batch flushing”,
PropertyType.BOOLEAN,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; HDFS_INDEX_SYNC_DIR = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“hdfs_index_sync_dir”,
“HDFS directory to sync index data”,
PropertyType.STRING,
true);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;Boolean&gt; READ_INDEX_FROM_PROD_LOCATION =</dt><dd><p>new EarlybirdProperty&lt;&gt;(
“read_index_from_prod_location”,
“Read index from prod to speed up startup on staging / loadtest”,
PropertyType.BOOLEAN,
false);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;Boolean&gt; USE_DECIDER_OVERLAY = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“use_decider_overlay”,
“Whether to use decider overlay”,
PropertyType.BOOLEAN,
false);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; DECIDER_OVERLAY_CONFIG = new EarlybirdProperty&lt;&gt;(</dt><dd><p>“decider_overlay_config”,
“Path to decider overlay config”,
PropertyType.STRING,
false);</p>
</dd>
<dt>public static final EarlybirdProperty&lt;Integer&gt; MAX_CONCURRENT_SEGMENT_INDEXERS =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“max_concurrent_segment_indexers”,
“Maximum number of segments indexed concurrently”,
PropertyType.INT,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;Boolean&gt; TF_MODELS_ENABLED =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“tf_models_enabled”,
“Whether tensorflow models should be loaded”,
PropertyType.BOOLEAN,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; TF_MODELS_CONFIG_PATH =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“tf_models_config_path”,
“The configuration path of the yaml file containing the list of tensorflow models to load.”,
PropertyType.STRING,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;Integer&gt; TF_INTER_OP_THREADS =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“tf_inter_op_threads”,
“How many tensorflow inter op threads to use. See TF documentation for more information.”,
PropertyType.INT,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;Integer&gt; TF_INTRA_OP_THREADS =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“tf_intra_op_threads”,
“How many tensorflow intra op threads to use. See TF documentation for more information.”,
PropertyType.INT,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;Integer&gt; MAX_ALLOWED_REPLICAS_NOT_IN_SERVER_SET =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“max_allowed_replicas_not_in_server_set”,
“How many replicas are allowed to be missing from the Earlybird server set.”,
PropertyType.INT,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;Boolean&gt; CHECK_NUM_REPLICAS_IN_SERVER_SET =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“check_num_replicas_in_server_set”,
“Whether CoordinatedEarlybirdActions should check the number of alive replicas”,
PropertyType.BOOLEAN,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;Integer&gt; MAX_QUEUE_SIZE =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“max_queue_size”,
“Maximum size of searcher worker executor queue. If &lt;= 0 queue is unbounded.”,
PropertyType.INT,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; KAFKA_ENV =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“kafka_env”,
“The environment to use for kafka topics.”,
PropertyType.STRING,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; KAFKA_PATH =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“kafka_path”,
“Wily path to the Search kafka cluster.”,
PropertyType.STRING,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; TWEET_EVENTS_KAFKA_PATH =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“tweet_events_kafka_path”,
“Wily path to the tweet-events kafka cluster.”,
PropertyType.STRING,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; USER_UPDATES_KAFKA_TOPIC =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“user_updates_topic”,
“Name of the Kafka topic that contain user updates.”,
PropertyType.STRING,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; USER_SCRUB_GEO_KAFKA_TOPIC =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“user_scrub_geo_topic”,
“Name of the Kafka topic that contain UserScrubGeoEvents.”,
PropertyType.STRING,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;String&gt; EARLYBIRD_SCRUB_GEN =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“earlybird_scrub_gen”,
“SCRUB_GEN TO DEPLOY”,
PropertyType.STRING,
false);</p>
</dd>
</dl>
</dd>
<dt>public static final EarlybirdProperty&lt;Boolean&gt; CONSUME_GEO_SCRUB_EVENTS =</dt><dd><dl class="simple">
<dt>new EarlybirdProperty&lt;&gt;(</dt><dd><p>“consume_geo_scrub_events”,
“Whether to consume user scrub geo events or not”,
PropertyType.BOOLEAN,
false);</p>
</dd>
</dl>
</dd>
<dt>private static final List&lt;EarlybirdProperty&lt;?&gt;&gt; ALL_PROPERTIES =</dt><dd><dl>
<dt>Arrays.stream(EarlybirdProperty.class.getDeclaredFields())</dt><dd><dl>
<dt>.filter(field -&gt;</dt><dd><dl class="simple">
<dt>(field.getModifiers() &amp; Modifier.STATIC) &gt; 0</dt><dd><p>&amp;&amp; field.getType() == EarlybirdProperty.class)</p>
</dd>
</dl>
</dd>
<dt>.map(field -&gt; {</dt><dd><dl class="simple">
<dt>try {</dt><dd><p>return (EarlybirdProperty&lt;?&gt;) field.get(EarlybirdProperty.class);</p>
</dd>
<dt>} catch (Exception e) {</dt><dd><p>throw new RuntimeException(e);</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
<p>})
.collect(Collectors.collectingAndThen(Collectors.toList(), ImmutableList::copyOf));</p>
</dd>
</dl>
</dd>
<dt>public static ServiceIdentifier getServiceIdentifier() {</dt><dd><dl class="simple">
<dt>return new ServiceIdentifier(</dt><dd><p>ROLE.get(),
EARLYBIRD_NAME.get(),
ENV.get(),
ZONE.get());</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
<p>private final String name;
private final String help;
private final PropertyType&lt;T&gt; type;
private final boolean requiredOnAurora;
private final boolean requiredOnDedicated;</p>
<dl>
<dt>private EarlybirdProperty(String name, String help, PropertyType&lt;T&gt; type,</dt><dd><blockquote>
<div><p>boolean requiredOnAurora) {</p>
</div></blockquote>
<p>this(name, help, type, requiredOnAurora, false);</p>
</dd>
</dl>
<p>}</p>
<dl>
<dt>private EarlybirdProperty(String name, String help, PropertyType&lt;T&gt; type,</dt><dd><blockquote>
<div><p>boolean requiredOnAurora, boolean requiredOnDedicated) {</p>
</div></blockquote>
<p>this.name = name;
this.help = help;
this.type = type;
this.requiredOnAurora = requiredOnAurora;
this.requiredOnDedicated = requiredOnDedicated;</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>public String name() {</dt><dd><p>return name;</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>public boolean isRequiredOnAurora() {</dt><dd><p>return requiredOnAurora;</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>public boolean isRequiredOnDedicated() {</dt><dd><p>return requiredOnDedicated;</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>public Flag&lt;T&gt; createFlag(Flags flags) {</dt><dd><p>return flags.createMandatory(name, help, null, type.flaggable);</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>public T get() {</dt><dd><p>return type.getter.apply(name);</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>public T get(T devaultValue) {</dt><dd><p>return type.getterWithDefault.apply(name, devaultValue);</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>public static EarlybirdProperty[] values() {</dt><dd><p>return ALL_PROPERTIES.toArray(new EarlybirdProperty[0]);</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>}</p>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../../../../../index.html">twit</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../../../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, jare.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../../../../../../_sources/src/java/com/twitter/search/earlybird/common/config/EarlybirdProperty.java.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
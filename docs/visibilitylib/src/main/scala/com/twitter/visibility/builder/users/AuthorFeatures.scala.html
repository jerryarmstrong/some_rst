<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>&lt;no title&gt; &#8212; twit  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../../../../../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../../../_static/alabaster.css?v=039e1c02" />
    <script data-url_root="../../../../../../../../../" id="documentation_options" src="../../../../../../../../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../../../../../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../../../../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../../../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../../../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p>package com.twitter.visibility.builder.users</p>
<p>import com.twitter.finagle.stats.StatsReceiver
import com.twitter.gizmoduck.thriftscala.Label
import com.twitter.gizmoduck.thriftscala.Labels
import com.twitter.gizmoduck.thriftscala.Profile
import com.twitter.gizmoduck.thriftscala.Safety
import com.twitter.gizmoduck.thriftscala.User
import com.twitter.stitch.NotFound
import com.twitter.stitch.Stitch
import com.twitter.tseng.withholding.thriftscala.TakedownReason
import com.twitter.util.Duration
import com.twitter.util.Time
import com.twitter.visibility.builder.FeatureMapBuilder
import com.twitter.visibility.common.UserSource
import com.twitter.visibility.features._</p>
<dl>
<dt>class AuthorFeatures(userSource: UserSource, statsReceiver: StatsReceiver) {</dt><dd><p>private[this] val scopedStatsReceiver = statsReceiver.scope(“author_features”)</p>
<p>private[this] val requests = scopedStatsReceiver.counter(“requests”)</p>
<dl>
<dt>private[this] val authorUserLabels =</dt><dd><p>scopedStatsReceiver.scope(AuthorUserLabels.name).counter(“requests”)</p>
</dd>
<dt>private[this] val authorIsSuspended =</dt><dd><p>scopedStatsReceiver.scope(AuthorIsSuspended.name).counter(“requests”)</p>
</dd>
<dt>private[this] val authorIsProtected =</dt><dd><p>scopedStatsReceiver.scope(AuthorIsProtected.name).counter(“requests”)</p>
</dd>
<dt>private[this] val authorIsDeactivated =</dt><dd><p>scopedStatsReceiver.scope(AuthorIsDeactivated.name).counter(“requests”)</p>
</dd>
<dt>private[this] val authorIsErased =</dt><dd><p>scopedStatsReceiver.scope(AuthorIsErased.name).counter(“requests”)</p>
</dd>
<dt>private[this] val authorIsOffboarded =</dt><dd><p>scopedStatsReceiver.scope(AuthorIsOffboarded.name).counter(“requests”)</p>
</dd>
<dt>private[this] val authorIsNsfwUser =</dt><dd><p>scopedStatsReceiver.scope(AuthorIsNsfwUser.name).counter(“requests”)</p>
</dd>
<dt>private[this] val authorIsNsfwAdmin =</dt><dd><p>scopedStatsReceiver.scope(AuthorIsNsfwAdmin.name).counter(“requests”)</p>
</dd>
<dt>private[this] val authorTakedownReasons =</dt><dd><p>scopedStatsReceiver.scope(AuthorTakedownReasons.name).counter(“requests”)</p>
</dd>
<dt>private[this] val authorHasDefaultProfileImage =</dt><dd><p>scopedStatsReceiver.scope(AuthorHasDefaultProfileImage.name).counter(“requests”)</p>
</dd>
<dt>private[this] val authorAccountAge =</dt><dd><p>scopedStatsReceiver.scope(AuthorAccountAge.name).counter(“requests”)</p>
</dd>
<dt>private[this] val authorIsVerified =</dt><dd><p>scopedStatsReceiver.scope(AuthorIsVerified.name).counter(“requests”)</p>
</dd>
<dt>private[this] val authorScreenName =</dt><dd><p>scopedStatsReceiver.scope(AuthorScreenName.name).counter(“requests”)</p>
</dd>
<dt>private[this] val authorIsBlueVerified =</dt><dd><p>scopedStatsReceiver.scope(AuthorIsBlueVerified.name).counter(“requests”)</p>
</dd>
<dt>def forAuthor(author: User): FeatureMapBuilder =&gt; FeatureMapBuilder = {</dt><dd><p>requests.incr()</p>
<dl class="simple">
<dt>_.withConstantFeature(AuthorId, Set(author.id))</dt><dd><p>.withConstantFeature(AuthorUserLabels, authorUserLabels(author))
.withConstantFeature(AuthorIsProtected, authorIsProtected(author))
.withConstantFeature(AuthorIsSuspended, authorIsSuspended(author))
.withConstantFeature(AuthorIsDeactivated, authorIsDeactivated(author))
.withConstantFeature(AuthorIsErased, authorIsErased(author))
.withConstantFeature(AuthorIsOffboarded, authorIsOffboarded(author))
.withConstantFeature(AuthorTakedownReasons, authorTakedownReasons(author))
.withConstantFeature(AuthorHasDefaultProfileImage, authorHasDefaultProfileImage(author))
.withConstantFeature(AuthorAccountAge, authorAccountAge(author))
.withConstantFeature(AuthorIsNsfwUser, authorIsNsfwUser(author))
.withConstantFeature(AuthorIsNsfwAdmin, authorIsNsfwAdmin(author))
.withConstantFeature(AuthorIsVerified, authorIsVerified(author))
.withConstantFeature(AuthorScreenName, authorScreenName(author))
.withConstantFeature(AuthorIsBlueVerified, authorIsBlueVerified(author))</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
<dl>
<dt>def forAuthorNoDefaults(author: User): FeatureMapBuilder =&gt; FeatureMapBuilder = {</dt><dd><p>requests.incr()</p>
<dl class="simple">
<dt>_.withConstantFeature(AuthorId, Set(author.id))</dt><dd><p>.withConstantFeature(AuthorUserLabels, authorUserLabelsOpt(author))
.withConstantFeature(AuthorIsProtected, authorIsProtectedOpt(author))
.withConstantFeature(AuthorIsSuspended, authorIsSuspendedOpt(author))
.withConstantFeature(AuthorIsDeactivated, authorIsDeactivatedOpt(author))
.withConstantFeature(AuthorIsErased, authorIsErasedOpt(author))
.withConstantFeature(AuthorIsOffboarded, authorIsOffboarded(author))
.withConstantFeature(AuthorTakedownReasons, authorTakedownReasons(author))
.withConstantFeature(AuthorHasDefaultProfileImage, authorHasDefaultProfileImage(author))
.withConstantFeature(AuthorAccountAge, authorAccountAge(author))
.withConstantFeature(AuthorIsNsfwUser, authorIsNsfwUserOpt(author))
.withConstantFeature(AuthorIsNsfwAdmin, authorIsNsfwAdminOpt(author))
.withConstantFeature(AuthorIsVerified, authorIsVerifiedOpt(author))
.withConstantFeature(AuthorScreenName, authorScreenName(author))
.withConstantFeature(AuthorIsBlueVerified, authorIsBlueVerified(author))</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
<dl>
<dt>def forAuthorId(authorId: Long): FeatureMapBuilder =&gt; FeatureMapBuilder = {</dt><dd><p>requests.incr()</p>
<dl class="simple">
<dt>_.withConstantFeature(AuthorId, Set(authorId))</dt><dd><p>.withFeature(AuthorUserLabels, authorUserLabels(authorId))
.withFeature(AuthorIsProtected, authorIsProtected(authorId))
.withFeature(AuthorIsSuspended, authorIsSuspended(authorId))
.withFeature(AuthorIsDeactivated, authorIsDeactivated(authorId))
.withFeature(AuthorIsErased, authorIsErased(authorId))
.withFeature(AuthorIsOffboarded, authorIsOffboarded(authorId))
.withFeature(AuthorTakedownReasons, authorTakedownReasons(authorId))
.withFeature(AuthorHasDefaultProfileImage, authorHasDefaultProfileImage(authorId))
.withFeature(AuthorAccountAge, authorAccountAge(authorId))
.withFeature(AuthorIsNsfwUser, authorIsNsfwUser(authorId))
.withFeature(AuthorIsNsfwAdmin, authorIsNsfwAdmin(authorId))
.withFeature(AuthorIsVerified, authorIsVerified(authorId))
.withFeature(AuthorScreenName, authorScreenName(authorId))
.withFeature(AuthorIsBlueVerified, authorIsBlueVerified(authorId))</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>def forNoAuthor(): FeatureMapBuilder =&gt; FeatureMapBuilder = {</dt><dd><dl class="simple">
<dt>_.withConstantFeature(AuthorId, Set.empty[Long])</dt><dd><p>.withConstantFeature(AuthorUserLabels, Seq.empty)
.withConstantFeature(AuthorIsProtected, false)
.withConstantFeature(AuthorIsSuspended, false)
.withConstantFeature(AuthorIsDeactivated, false)
.withConstantFeature(AuthorIsErased, false)
.withConstantFeature(AuthorIsOffboarded, false)
.withConstantFeature(AuthorTakedownReasons, Seq.empty)
.withConstantFeature(AuthorHasDefaultProfileImage, false)
.withConstantFeature(AuthorAccountAge, Duration.Zero)
.withConstantFeature(AuthorIsNsfwUser, false)
.withConstantFeature(AuthorIsNsfwAdmin, false)
.withConstantFeature(AuthorIsVerified, false)
.withConstantFeature(AuthorIsBlueVerified, false)</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>def authorUserLabels(author: User): Seq[Label] =</dt><dd><p>authorUserLabels(author.labels)</p>
</dd>
<dt>def authorIsSuspended(authorId: Long): Stitch[Boolean] =</dt><dd><p>userSource.getSafety(authorId).map(safety =&gt; authorIsSuspended(Some(safety)))</p>
</dd>
<dt>def authorIsSuspendedOpt(author: User): Option[Boolean] = {</dt><dd><p>authorIsSuspended.incr()
author.safety.map(_.suspended)</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>private def authorIsSuspended(safety: Option[Safety]): Boolean = {</dt><dd><p>authorIsSuspended.incr()
safety.exists(_.suspended)</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>def authorIsProtected(author: User): Boolean =</dt><dd><p>authorIsProtected(author.safety)</p>
</dd>
<dt>def authorIsDeactivated(authorId: Long): Stitch[Boolean] =</dt><dd><p>userSource.getSafety(authorId).map(safety =&gt; authorIsDeactivated(Some(safety)))</p>
</dd>
<dt>def authorIsDeactivatedOpt(author: User): Option[Boolean] = {</dt><dd><p>authorIsDeactivated.incr()
author.safety.map(_.deactivated)</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>private def authorIsDeactivated(safety: Option[Safety]): Boolean = {</dt><dd><p>authorIsDeactivated.incr()
safety.exists(_.deactivated)</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>def authorIsErased(author: User): Boolean = {</dt><dd><p>authorIsErased.incr()
author.safety.exists(_.erased)</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>def authorIsOffboarded(authorId: Long): Stitch[Boolean] = {</dt><dd><p>userSource.getSafety(authorId).map(safety =&gt; authorIsOffboarded(Some(safety)))</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>def authorIsNsfwUser(author: User): Boolean = {</dt><dd><p>authorIsNsfwUser(author.safety)</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>def authorIsNsfwUser(authorId: Long): Stitch[Boolean] = {</dt><dd><p>userSource.getSafety(authorId).map(safety =&gt; authorIsNsfwUser(Some(safety)))</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>def authorIsNsfwUser(safety: Option[Safety]): Boolean = {</dt><dd><p>authorIsNsfwUser.incr()
safety.exists(_.nsfwUser)</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>def authorIsNsfwAdminOpt(author: User): Option[Boolean] = {</dt><dd><p>authorIsNsfwAdmin.incr()
author.safety.map(_.nsfwAdmin)</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>def authorTakedownReasons(authorId: Long): Stitch[Seq[TakedownReason]] = {</dt><dd><p>authorTakedownReasons.incr()
userSource.getTakedownReasons(authorId)</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>def authorHasDefaultProfileImage(authorId: Long): Stitch[Boolean] =</dt><dd><p>userSource.getProfile(authorId).map(profile =&gt; authorHasDefaultProfileImage(Some(profile)))</p>
</dd>
<dt>def authorAccountAge(authorId: Long): Stitch[Duration] =</dt><dd><p>userSource.getCreatedAtMsec(authorId).map(authorAccountAgeFromTimestamp)</p>
</dd>
<dt>def authorIsVerified(authorId: Long): Stitch[Boolean] =</dt><dd><p>userSource.getSafety(authorId).map(safety =&gt; authorIsVerified(Some(safety)))</p>
</dd>
<dt>def authorIsVerifiedOpt(author: User): Option[Boolean] = {</dt><dd><p>authorIsVerified.incr()
author.safety.map(_.verified)</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>private def authorIsVerified(safety: Option[Safety]): Boolean = {</dt><dd><p>authorIsVerified.incr()
safety.exists(_.verified)</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>def authorScreenName(author: User): Option[String] = {</dt><dd><p>authorScreenName.incr()
author.profile.map(_.screenName)</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>def authorScreenName(authorId: Long): Stitch[String] = {</dt><dd><p>authorScreenName.incr()
userSource.getProfile(authorId).map(profile =&gt; profile.screenName)</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
<p>}</p>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../../../../../../index.html">twit</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../../../../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, jare.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../../../../../../../_sources/visibilitylib/src/main/scala/com/twitter/visibility/builder/users/AuthorFeatures.scala.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
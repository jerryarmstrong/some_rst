<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>&lt;no title&gt; &#8212; twit  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../../../../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../../_static/alabaster.css?v=039e1c02" />
    <script data-url_root="../../../../../../../../" id="documentation_options" src="../../../../../../../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../../../../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../../../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p>package com.twitter.search.common.schema.earlybird;</p>
<p>import java.util.Collection;
import java.util.EnumSet;
import java.util.List;
import java.util.Map;
import java.util.Set;</p>
<p>import javax.annotation.Nullable;</p>
<p>import com.google.common.annotations.VisibleForTesting;
import com.google.common.collect.ImmutableList;
import com.google.common.collect.ImmutableMap;
import com.google.common.collect.ImmutableSet;
import com.google.common.collect.Sets;</p>
<p>import com.twitter.search.common.indexing.thriftjava.ThriftGeoLocationSource;
import com.twitter.search.common.schema.ImmutableSchema;
import com.twitter.search.common.schema.SchemaBuilder;
import com.twitter.search.common.schema.base.FeatureConfiguration;
import com.twitter.search.common.schema.base.FieldNameToIdMapping;
import com.twitter.search.common.schema.thriftjava.ThriftFeatureNormalizationType;</p>
<dl>
<dt>/**</dt><dd><ul class="simple">
<li><p>Field names, field IDs etc.</p></li>
</ul>
<p><a href="#id1"><span class="problematic" id="id2">*</span></a>/</p>
</dd>
<dt>public class EarlybirdFieldConstants extends FieldNameToIdMapping {</dt><dd><p>&#64;VisibleForTesting
public static final String ENCODED_TWEET_FEATURES_FIELD_NAME = “encoded_tweet_features”;</p>
<p>&#64;VisibleForTesting
public static final String EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME =</p>
<blockquote>
<div><p>“extended_encoded_tweet_features”;</p>
</div></blockquote>
<dl class="simple">
<dt>private enum FlagFeatureFieldType {</dt><dd><p>NON_FLAG_FEATURE_FIELD,
FLAG_FEATURE_FIELD</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>private enum UnusedFeatureFieldType {</dt><dd><p>USED_FEATURE_FIELD,
UNUSED_FEATURE_FIELD</p>
</dd>
</dl>
<p>}</p>
<dl>
<dt>/**</dt><dd><ul class="simple">
<li><p>CSF_NAME_TO_MIN_ENGAGEMENT_FIELD_MAP and MIN_ENGAGEMENT_FIELD_TO_CSF_NAME_MAP are used in</p></li>
<li><p>EarlybirdLuceneQueryVisitor to map the CSFs REPLY_COUNT, RETWEET_COUNT, and FAVORITE_COUNT to</p></li>
<li><p>their respective min engagement fields, and vice versa.</p></li>
</ul>
<p><a href="#id3"><span class="problematic" id="id4">*</span></a>/</p>
</dd>
<dt>public static final ImmutableMap&lt;String, EarlybirdFieldConstant&gt;</dt><dd><dl>
<dt>CSF_NAME_TO_MIN_ENGAGEMENT_FIELD_MAP = ImmutableMap.&lt;String, EarlybirdFieldConstant&gt;builder()</dt><dd><dl class="simple">
<dt>.put(EarlybirdFieldConstant.REPLY_COUNT.getFieldName(),</dt><dd><p>EarlybirdFieldConstant.NORMALIZED_REPLY_COUNT_GREATER_THAN_OR_EQUAL_TO_FIELD)</p>
</dd>
<dt>.put(EarlybirdFieldConstant.RETWEET_COUNT.getFieldName(),</dt><dd><p>EarlybirdFieldConstant.NORMALIZED_RETWEET_COUNT_GREATER_THAN_OR_EQUAL_TO_FIELD)</p>
</dd>
<dt>.put(EarlybirdFieldConstant.FAVORITE_COUNT.getFieldName(),</dt><dd><p>EarlybirdFieldConstant.NORMALIZED_FAVORITE_COUNT_GREATER_THAN_OR_EQUAL_TO_FIELD)</p>
</dd>
</dl>
<p>.build();</p>
</dd>
</dl>
</dd>
<dt>public static final ImmutableMap&lt;String, EarlybirdFieldConstant&gt;</dt><dd><p>MIN_ENGAGEMENT_FIELD_TO_CSF_NAME_MAP = ImmutableMap.&lt;String, EarlybirdFieldConstant&gt;builder()
.put(EarlybirdFieldConstant.NORMALIZED_REPLY_COUNT_GREATER_THAN_OR_EQUAL_TO_FIELD</p>
<blockquote>
<div><blockquote>
<div><p>.getFieldName(),</p>
</div></blockquote>
<p>EarlybirdFieldConstant.REPLY_COUNT)</p>
</div></blockquote>
<dl>
<dt>.put(EarlybirdFieldConstant.NORMALIZED_RETWEET_COUNT_GREATER_THAN_OR_EQUAL_TO_FIELD</dt><dd><blockquote>
<div><p>.getFieldName(),</p>
</div></blockquote>
<p>EarlybirdFieldConstant.RETWEET_COUNT)</p>
</dd>
<dt>.put(EarlybirdFieldConstant.NORMALIZED_FAVORITE_COUNT_GREATER_THAN_OR_EQUAL_TO_FIELD</dt><dd><blockquote>
<div><p>.getFieldName(),</p>
</div></blockquote>
<p>EarlybirdFieldConstant.FAVORITE_COUNT)</p>
</dd>
</dl>
<p>.build();</p>
</dd>
<dt>/**</dt><dd><ul class="simple">
<li><p>A list of Earlybird field names and field IDs, and the clusters that need them.</p></li>
</ul>
<p><a href="#id5"><span class="problematic" id="id6">*</span></a>/</p>
</dd>
<dt>public enum EarlybirdFieldConstant {</dt><dd><p>// These enums are grouped by category and sorted alphabetically.
// Next indexed field ID is 76
// Next CSF field ID is 115
// Next encoded_features CSF field ID is 185
// Next extended_encoded_features CSF field ID is 284</p>
<p>// Text searchable fields
// Provides slow ID Mapping from tweet ID to doc ID through TermsEnum.seekExact().
ID_FIELD(“id”, 0, EarlybirdCluster.ALL_CLUSTERS),
RESOLVED_LINKS_TEXT_FIELD(“resolved_links_text”, 1),
TEXT_FIELD(“text”, 2),
TOKENIZED_FROM_USER_FIELD(“tokenized_from_user”, 3),</p>
<p>// Other indexed fields
CARD_TITLE_FIELD(“card_title”, 4),
CARD_DESCRIPTION_FIELD(“card_description”, 5),
// We require the createdAt field to be set so we can properly filter tweets based on time.
CREATED_AT_FIELD(“created_at”, 6, EarlybirdCluster.ALL_CLUSTERS),
// 7 was formerly EVENT_IDS_FIELD(“event_ids”, 7, EarlybirdCluster.REALTIME)
ENTITY_ID_FIELD(“entity_id”, 40),
// The screen name of the user that created the tweet. Should be set to the normalized value in
// the com.twitter.gizmoduck.thriftjava.Profile.screen_name field.
FROM_USER_FIELD(“from_user”, 8),
// The numeric ID of the user that created the tweet.
FROM_USER_ID_FIELD(“from_user_id”, 9, EarlybirdCluster.ALL_CLUSTERS),
CARD_DOMAIN_FIELD(“card_domain”, 11),
CARD_NAME_FIELD(“card_name”, 12),
GEO_HASH_FIELD(“geo_hash”, 13),
HASHTAGS_FIELD(“hashtags”, 14),
HF_PHRASE_PAIRS_FIELD(ImmutableSchema.HF_PHRASE_PAIRS_FIELD, 15),
HF_TERM_PAIRS_FIELD(ImmutableSchema.HF_TERM_PAIRS_FIELD, 16),
IMAGE_LINKS_FIELD(“image_links”, 17),
IN_REPLY_TO_TWEET_ID_FIELD(“in_reply_to_tweet_id”, 59),
IN_REPLY_TO_USER_ID_FIELD(“in_reply_to_user_id”, 38),
// The internal field is used for many purposes:
// 1. to store facet skiplists
// 2. to power the filter operator, by storing posting list for terms like __filter_twimg
// 3. to store posting lists for positive and negative smileys
// 4. to store geo location types.
// etc.
INTERNAL_FIELD(“internal”, 18, EarlybirdCluster.ALL_CLUSTERS),
ISO_LANGUAGE_FIELD(“iso_lang”, 19),
LINK_CATEGORY_FIELD(“link_category”, 36),
LINKS_FIELD(“links”, 21),
MENTIONS_FIELD(“mentions”, 22),
// Field 23 used to be NAMED_ENTITIES_FIELD
NEWS_LINKS_FIELD(“news_links”, 24),
NORMALIZED_SOURCE_FIELD(“norm_source”, 25),
PLACE_FIELD(“place”, 26),
// Field 37 used to be PUBLICLY_INFERRED_USER_LOCATION_PLACE_ID_FIELD
// The ID of the source tweet. Set for retweets only.
RETWEET_SOURCE_TWEET_ID_FIELD(“retweet_source_tweet_id”, 60,</p>
<blockquote>
<div><p>EarlybirdCluster.ALL_CLUSTERS),</p>
</div></blockquote>
<p>// The ID of the source tweet’s author. Set for retweets only.
RETWEET_SOURCE_USER_ID_FIELD(“retweet_source_user_id”, 39),
SOURCE_FIELD(“source”, 29),
STOCKS_FIELD(“stocks”, 30),
// The screen name of the user that a tweet was directed at.
TO_USER_FIELD(“to_user”, 32),
// Field 33 used to be TOPIC_IDS_FIELD and is now unused. It can be reused later.
TWIMG_LINKS_FIELD(“twimg_links”, 34),
VIDEO_LINKS_FIELD(“video_links”, 35),
CAMELCASE_USER_HANDLE_FIELD(“camelcase_tokenized_from_user”, 41),
// This field should be set to the the tokenized and normalized value in the
// com.twitter.gizmoduck.thriftjava.Profile.name field.
TOKENIZED_USER_NAME_FIELD(“tokenized_from_user_display_name”, 42),
CONVERSATION_ID_FIELD(“conversation_id”, 43),
PLACE_ID_FIELD(“place_id”, 44),
PLACE_FULL_NAME_FIELD(“place_full_name”, 45),
PLACE_COUNTRY_CODE_FIELD(“place_country_code”, 46),
PROFILE_GEO_COUNTRY_CODE_FIELD(“profile_geo_country_code”, 47),
PROFILE_GEO_REGION_FIELD(“profile_geo_region”, 48),
PROFILE_GEO_LOCALITY_FIELD(“profile_geo_locality”, 49),
LIKED_BY_USER_ID_FIELD(“liked_by_user_id”, 50, EarlybirdCluster.REALTIME),
NORMALIZED_REPLY_COUNT_GREATER_THAN_OR_EQUAL_TO_FIELD(</p>
<blockquote>
<div><p>“normalized_reply_count_greater_than_or_equal_to”, 51, EarlybirdCluster.FULL_ARCHIVE),</p>
</div></blockquote>
<dl class="simple">
<dt>NORMALIZED_RETWEET_COUNT_GREATER_THAN_OR_EQUAL_TO_FIELD(</dt><dd><p>“normalized_retweet_count_greater_than_or_equal_to”, 52, EarlybirdCluster.FULL_ARCHIVE),</p>
</dd>
<dt>NORMALIZED_FAVORITE_COUNT_GREATER_THAN_OR_EQUAL_TO_FIELD(</dt><dd><p>“normalized_favorite_count_greater_than_or_equal_to”, 53, EarlybirdCluster.FULL_ARCHIVE),</p>
</dd>
</dl>
<p>COMPOSER_SOURCE(“composer_source”, 54),
QUOTED_TWEET_ID_FIELD(“quoted_tweet_id”, 55),
QUOTED_USER_ID_FIELD(“quoted_user_id”, 56),
RETWEETED_BY_USER_ID(“retweeted_by_user_id”, 57, EarlybirdCluster.REALTIME),
REPLIED_TO_BY_USER_ID(“replied_to_by_user_id”, 58, EarlybirdCluster.REALTIME),
CARD_LANG(“card_lang”, 61),
// SEARCH-27823: Field ID 62 used to be named_entity, which was the combination of all
// named_entity* fields below. We need to leave 62 unused for backwards compatibility.
NAMED_ENTITY_FROM_URL_FIELD(“named_entity_from_url”, 63),
NAMED_ENTITY_FROM_TEXT_FIELD(“named_entity_from_text”, 64),
NAMED_ENTITY_WITH_TYPE_FROM_URL_FIELD(“named_entity_with_type_from_url”, 65),
NAMED_ENTITY_WITH_TYPE_FROM_TEXT_FIELD(“named_entity_with_type_from_text”, 66),
DIRECTED_AT_USER_ID_FIELD(“directed_at_user_id”, 67),
SPACE_ID_FIELD(“space_id”, 68,</p>
<blockquote>
<div><p>EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_GENERAL_PURPOSE_CLUSTERS),</p>
</div></blockquote>
<dl class="simple">
<dt>SPACE_TITLE_FIELD(“space_title”, 69,</dt><dd><p>EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_GENERAL_PURPOSE_CLUSTERS),</p>
</dd>
</dl>
<p>// Detailed description of the space admin fields can be found at go/earlybirdfields.
SPACE_ADMIN_FIELD(“space_admin”, 70,</p>
<blockquote>
<div><p>EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_GENERAL_PURPOSE_CLUSTERS),</p>
</div></blockquote>
<dl class="simple">
<dt>TOKENIZED_SPACE_ADMIN_FIELD(“tokenized_space_admin”, 71,</dt><dd><p>EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_GENERAL_PURPOSE_CLUSTERS),</p>
</dd>
<dt>CAMELCASE_TOKENIZED_SPACE_ADMIN_FIELD(“camelcase_tokenized_space_admin”, 72,</dt><dd><p>EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_GENERAL_PURPOSE_CLUSTERS),</p>
</dd>
<dt>TOKENIZED_SPACE_ADMIN_DISPLAY_NAME_FIELD(“tokenized_space_admin_display_name”, 73,</dt><dd><p>EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_GENERAL_PURPOSE_CLUSTERS),</p>
</dd>
</dl>
<p>URL_DESCRIPTION_FIELD(“url_description”, 74),
URL_TITLE_FIELD(“url_title”, 75),</p>
<p>// CSF
CARD_TYPE_CSF_FIELD(“card_type_csf”, 100),
ENCODED_TWEET_FEATURES_FIELD(ENCODED_TWEET_FEATURES_FIELD_NAME, 102,</p>
<blockquote>
<div><p>EarlybirdCluster.ALL_CLUSTERS),</p>
</div></blockquote>
<p>// Provides the doc ID -&gt; original tweet ID mapping for retweets.
SHARED_STATUS_ID_CSF(“shared_status_id_csf”, 106, EarlybirdCluster.ALL_CLUSTERS),
// Provides the doc ID -&gt; tweet author’s user ID mapping.
FROM_USER_ID_CSF(“from_user_id_csf”, 103, EarlybirdCluster.ALL_CLUSTERS),
CREATED_AT_CSF_FIELD(“created_at_csf”, 101, EarlybirdCluster.ARCHIVE_CLUSTERS),
// Provides the doc ID -&gt; tweet ID mapping.
ID_CSF_FIELD(“id_csf”, 104, EarlybirdCluster.ARCHIVE_CLUSTERS),
LAT_LON_CSF_FIELD(“latlon_csf”, 105),
CONVERSATION_ID_CSF(“conversation_id_csf”, 107, EarlybirdCluster.ALL_CLUSTERS),
QUOTED_TWEET_ID_CSF(“quoted_tweet_id_csf”, 108),
QUOTED_USER_ID_CSF(“quoted_user_id_csf”, 109),
CARD_LANG_CSF(“card_lang_csf”, 110),
DIRECTED_AT_USER_ID_CSF(“directed_at_user_id_csf”, 111),
REFERENCE_AUTHOR_ID_CSF(“reference_author_id_csf”, 112),
EXCLUSIVE_CONVERSATION_AUTHOR_ID_CSF(“exclusive_conversation_author_id_csf”, 113),
CARD_URI_CSF(“card_uri_csf”, 114),</p>
<p>// CSF Views on top of ENCODED_TWEET_FEATURES_FIELD
IS_RETWEET_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “IS_RETWEET_FLAG”, 150,</p>
<blockquote>
<div><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</div></blockquote>
<dl>
<dt>IS_OFFENSIVE_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “IS_OFFENSIVE_FLAG”, 151,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>HAS_LINK_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “HAS_LINK_FLAG”, 152,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>HAS_TREND_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “HAS_TREND_FLAG”, 153,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>IS_REPLY_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “IS_REPLY_FLAG”, 154,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>IS_SENSITIVE_CONTENT(ENCODED_TWEET_FEATURES_FIELD_NAME, “IS_SENSITIVE_CONTENT”, 155,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>HAS_MULTIPLE_HASHTAGS_OR_TRENDS_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“HAS_MULTIPLE_HASHTAGS_OR_TRENDS_FLAG”, 156, FlagFeatureFieldType.FLAG_FEATURE_FIELD,
EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>FROM_VERIFIED_ACCOUNT_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “FROM_VERIFIED_ACCOUNT_FLAG”,</dt><dd><p>157,
FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>TEXT_SCORE(ENCODED_TWEET_FEATURES_FIELD_NAME, “TEXT_SCORE”, 158,</dt><dd><p>FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>LANGUAGE(ENCODED_TWEET_FEATURES_FIELD_NAME, “LANGUAGE”, 159,</dt><dd><p>FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>LINK_LANGUAGE(ENCODED_TWEET_FEATURES_FIELD_NAME, “LINK_LANGUAGE”, 160,</dt><dd><p>FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>HAS_IMAGE_URL_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “HAS_IMAGE_URL_FLAG”, 161,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>HAS_VIDEO_URL_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “HAS_VIDEO_URL_FLAG”, 162,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>HAS_NEWS_URL_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “HAS_NEWS_URL_FLAG”, 163,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>HAS_EXPANDO_CARD_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “HAS_EXPANDO_CARD_FLAG”, 164,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>HAS_MULTIPLE_MEDIA_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “HAS_MULTIPLE_MEDIA_FLAG”, 165,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>PROFILE_IS_EGG_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “PROFILE_IS_EGG_FLAG”, 166,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>NUM_MENTIONS(ENCODED_TWEET_FEATURES_FIELD_NAME, “NUM_MENTIONS”, 167,</dt><dd><p>FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>NUM_HASHTAGS(ENCODED_TWEET_FEATURES_FIELD_NAME, “NUM_HASHTAGS”, 168,</dt><dd><p>FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>HAS_CARD_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “HAS_CARD_FLAG”, 169,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>HAS_VISIBLE_LINK_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “HAS_VISIBLE_LINK_FLAG”, 170,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>USER_REPUTATION(ENCODED_TWEET_FEATURES_FIELD_NAME, “USER_REPUTATION”, 171,</dt><dd><p>FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>IS_USER_SPAM_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “IS_USER_SPAM_FLAG”, 172,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>IS_USER_NSFW_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “IS_USER_NSFW_FLAG”, 173,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>IS_USER_BOT_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “IS_USER_BOT_FLAG”, 174,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>IS_USER_NEW_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “IS_USER_NEW_FLAG”, 175,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>PREV_USER_TWEET_ENGAGEMENT(ENCODED_TWEET_FEATURES_FIELD_NAME, “PREV_USER_TWEET_ENGAGEMENT”,</dt><dd><p>176,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>COMPOSER_SOURCE_IS_CAMERA_FLAG(</dt><dd><p>ENCODED_TWEET_FEATURES_FIELD_NAME,
“COMPOSER_SOURCE_IS_CAMERA_FLAG”,
177,
FlagFeatureFieldType.FLAG_FEATURE_FIELD,
EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>RETWEET_COUNT(</dt><dd><p>ENCODED_TWEET_FEATURES_FIELD_NAME,
“RETWEET_COUNT”,
178,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.ALL_CLUSTERS,
ThriftFeatureNormalizationType.LEGACY_BYTE_NORMALIZER_WITH_LOG2),</p>
</dd>
<dt>FAVORITE_COUNT(</dt><dd><p>ENCODED_TWEET_FEATURES_FIELD_NAME,
“FAVORITE_COUNT”,
179,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.ALL_CLUSTERS,
ThriftFeatureNormalizationType.LEGACY_BYTE_NORMALIZER_WITH_LOG2),</p>
</dd>
<dt>REPLY_COUNT(</dt><dd><p>ENCODED_TWEET_FEATURES_FIELD_NAME,
“REPLY_COUNT”,
180,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.ALL_CLUSTERS,
ThriftFeatureNormalizationType.LEGACY_BYTE_NORMALIZER_WITH_LOG2),</p>
</dd>
<dt>PARUS_SCORE(ENCODED_TWEET_FEATURES_FIELD_NAME, “PARUS_SCORE”, 181,</dt><dd><p>FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>/**</dt><dd><ul class="simple">
<li><p>This is the rough percentage of the nth token at 140 divided by num tokens</p></li>
<li><p>and is basically n / num tokens where n is the token starting before 140 characters</p></li>
</ul>
<p><a href="#id7"><span class="problematic" id="id8">*</span></a>/</p>
</dd>
<dt>VISIBLE_TOKEN_RATIO(ENCODED_TWEET_FEATURES_FIELD_NAME, “VISIBLE_TOKEN_RATIO”, 182,</dt><dd><p>FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>HAS_QUOTE_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “HAS_QUOTE_FLAG”, 183,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>FROM_BLUE_VERIFIED_ACCOUNT_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“FROM_BLUE_VERIFIED_ACCOUNT_FLAG”,
184,
FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>TWEET_SIGNATURE(ENCODED_TWEET_FEATURES_FIELD_NAME, “TWEET_SIGNATURE”, 188,</dt><dd><p>FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
</dl>
<p>// MEDIA TYPES
HAS_CONSUMER_VIDEO_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “HAS_CONSUMER_VIDEO_FLAG”, 189,</p>
<blockquote>
<div><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</div></blockquote>
<dl class="simple">
<dt>HAS_PRO_VIDEO_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “HAS_PRO_VIDEO_FLAG”, 190,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>HAS_VINE_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “HAS_VINE_FLAG”, 191,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>HAS_PERISCOPE_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “HAS_PERISCOPE_FLAG”, 192,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
<dt>HAS_NATIVE_IMAGE_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “HAS_NATIVE_IMAGE_FLAG”, 193,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
</dl>
<p>// NOTE: if possible, please reserve field ID 194 to 196 for future media types (SEARCH-9131)</p>
<dl class="simple">
<dt>IS_NULLCAST_FLAG(ENCODED_TWEET_FEATURES_FIELD_NAME, “IS_NULLCAST_FLAG”, 197,</dt><dd><p>FlagFeatureFieldType.FLAG_FEATURE_FIELD, EarlybirdCluster.ALL_CLUSTERS),</p>
</dd>
</dl>
<p>// EXTENDED ENCODED TWEET FEATURES that’s not available on archive clusters
EXTENDED_ENCODED_TWEET_FEATURES_FIELD(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME, 200,</p>
<blockquote>
<div><p>EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</div></blockquote>
<dl class="simple">
<dt>EMBEDS_IMPRESSION_COUNT(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“EMBEDS_IMPRESSION_COUNT”,
221,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.LEGACY_BYTE_NORMALIZER),</p>
</dd>
<dt>EMBEDS_URL_COUNT(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“EMBEDS_URL_COUNT”,
222,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.LEGACY_BYTE_NORMALIZER),</p>
</dd>
<dt>VIDEO_VIEW_COUNT(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“VIDEO_VIEW_COUNT”,
223,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.LEGACY_BYTE_NORMALIZER),</p>
</dd>
</dl>
<p>// empty bits in integer 0 (starting bit 24, 8 bits)
EXTENDED_FEATURE_UNUSED_BITS_0_24_8(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</p>
<blockquote>
<div><p>“UNUSED_BITS_0_24_8”, 244,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
UnusedFeatureFieldType.UNUSED_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</div></blockquote>
<p>// SEARCH-8564 - Reference Tweet Author ID
REFERENCE_AUTHOR_ID_LEAST_SIGNIFICANT_INT(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</p>
<blockquote>
<div><p>“REFERENCE_AUTHOR_ID_LEAST_SIGNIFICANT_INT”, 202,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</div></blockquote>
<dl class="simple">
<dt>REFERENCE_AUTHOR_ID_MOST_SIGNIFICANT_INT(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“REFERENCE_AUTHOR_ID_MOST_SIGNIFICANT_INT”, 203,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</dd>
</dl>
<p>// SEARCHQUAL-8130: engagement counters v2
// Integer 3
RETWEET_COUNT_V2(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</p>
<blockquote>
<div><p>“RETWEET_COUNT_V2”, 225,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</div></blockquote>
<dl class="simple">
<dt>FAVORITE_COUNT_V2(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“FAVORITE_COUNT_V2”, 226,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</dd>
<dt>REPLY_COUNT_V2(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“REPLY_COUNT_V2”, 227,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</dd>
<dt>EMBEDS_IMPRESSION_COUNT_V2(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“EMBEDS_IMPRESSION_COUNT_V2”,
228,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</dd>
</dl>
<p>// Integer 4
EMBEDS_URL_COUNT_V2(</p>
<blockquote>
<div><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“EMBEDS_URL_COUNT_V2”,
229,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</div></blockquote>
<dl class="simple">
<dt>VIDEO_VIEW_COUNT_V2(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“VIDEO_VIEW_COUNT_V2”,
230,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</dd>
<dt>QUOTE_COUNT(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“QUOTE_COUNT”,
231,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</dd>
</dl>
<p>// Tweet Safety Labels
LABEL_ABUSIVE_FLAG(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</p>
<blockquote>
<div><p>“LABEL_ABUSIVE_FLAG”, 232,
FlagFeatureFieldType.FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</div></blockquote>
<dl class="simple">
<dt>LABEL_ABUSIVE_HI_RCL_FLAG(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“LABEL_ABUSIVE_HI_RCL_FLAG”, 233,
FlagFeatureFieldType.FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</dd>
<dt>LABEL_DUP_CONTENT_FLAG(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“LABEL_DUP_CONTENT_FLAG”, 234,
FlagFeatureFieldType.FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</dd>
<dt>LABEL_NSFW_HI_PRC_FLAG(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“LABEL_NSFW_HI_PRC_FLAG”, 235,
FlagFeatureFieldType.FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</dd>
<dt>LABEL_NSFW_HI_RCL_FLAG(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“LABEL_NSFW_HI_RCL_FLAG”, 236,
FlagFeatureFieldType.FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</dd>
<dt>LABEL_SPAM_FLAG(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“LABEL_SPAM_FLAG”, 237,
FlagFeatureFieldType.FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</dd>
<dt>LABEL_SPAM_HI_RCL_FLAG(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“LABEL_SPAM_HI_RCL_FLAG”, 238,
FlagFeatureFieldType.FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</dd>
</dl>
<p>// please save this bit for other safety labels
EXTENDED_TEST_FEATURE_UNUSED_BITS_4_31_1(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</p>
<blockquote>
<div><p>“UNUSED_BITS_4_31_1”, 239,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
UnusedFeatureFieldType.UNUSED_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</div></blockquote>
<p>// Integer 5
WEIGHTED_RETWEET_COUNT(</p>
<blockquote>
<div><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“WEIGHTED_RETWEET_COUNT”,
240,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</div></blockquote>
<dl class="simple">
<dt>WEIGHTED_REPLY_COUNT(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“WEIGHTED_REPLY_COUNT”,
241,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</dd>
<dt>WEIGHTED_FAVORITE_COUNT(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“WEIGHTED_FAVORITE_COUNT”,
242,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</dd>
<dt>WEIGHTED_QUOTE_COUNT(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“WEIGHTED_QUOTE_COUNT”,
243,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</dd>
</dl>
<p>// Integer 6
// Periscope features
PERISCOPE_EXISTS(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</p>
<blockquote>
<div><p>“PERISCOPE_EXISTS”, 245,
FlagFeatureFieldType.FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</div></blockquote>
<dl class="simple">
<dt>PERISCOPE_HAS_BEEN_FEATURED(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“PERISCOPE_HAS_BEEN_FEATURED”, 246,
FlagFeatureFieldType.FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</dd>
<dt>PERISCOPE_IS_CURRENTLY_FEATURED(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“PERISCOPE_IS_CURRENTLY_FEATURED”, 247,
FlagFeatureFieldType.FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</dd>
<dt>PERISCOPE_IS_FROM_QUALITY_SOURCE(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“PERISCOPE_IS_FROM_QUALITY_SOURCE”, 248,
FlagFeatureFieldType.FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</dd>
<dt>PERISCOPE_IS_LIVE(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“PERISCOPE_IS_LIVE”, 249,
FlagFeatureFieldType.FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</dd>
<dt>IS_TRENDING_NOW_FLAG(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“IS_TRENDING_NOW_FLAG”, 292,
FlagFeatureFieldType.FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</dd>
</dl>
<p>// remaining bits for integer 6 (starting bit 6, 26 remaining bits)
EXTENDED_TEST_FEATURE_UNUSED_BITS_7_6_26(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</p>
<blockquote>
<div><p>“UNUSED_BITS_7_6_26”, 250,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
UnusedFeatureFieldType.UNUSED_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</div></blockquote>
<p>// Decaying engagement counters
// Integer 7
DECAYED_RETWEET_COUNT(</p>
<blockquote>
<div><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“DECAYED_RETWEET_COUNT”,
251,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</div></blockquote>
<dl class="simple">
<dt>DECAYED_REPLY_COUNT(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“DECAYED_REPLY_COUNT”,
252,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</dd>
<dt>DECAYED_FAVORITE_COUNT(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“DECAYED_FAVORITE_COUNT”,
253,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</dd>
<dt>DECAYED_QUOTE_COUNT(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“DECAYED_QUOTE_COUNT”,
254,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</dd>
</dl>
<p>// Fake engagement counters. The fake here is in the sense of spam, not in the sense of testing.
// Refer to [JIRA SEARCHQUAL-10736 Remove Fake Engagements in Search] for more details.
// Integer 8
FAKE_RETWEET_COUNT(</p>
<blockquote>
<div><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“FAKE_RETWEET_COUNT”, 269,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</div></blockquote>
<dl class="simple">
<dt>FAKE_REPLY_COUNT(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“FAKE_REPLY_COUNT”, 270,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</dd>
<dt>FAKE_FAVORITE_COUNT(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“FAKE_FAVORITE_COUNT”, 271,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</dd>
<dt>FAKE_QUOTE_COUNT(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“FAKE_QUOTE_COUNT”, 272,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</dd>
</dl>
<p>// Last engagement timestamps. These features use the Tweet’s creation time as base and
// are incremented every 1 hour
// Integer 9
LAST_RETWEET_SINCE_CREATION_HRS(</p>
<blockquote>
<div><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“LAST_RETWEET_SINCE_CREATION_HRS”,
273,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.NONE),</p>
</div></blockquote>
<dl class="simple">
<dt>LAST_REPLY_SINCE_CREATION_HRS(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“LAST_REPLY_SINCE_CREATION_HRS”,
274,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.NONE),</p>
</dd>
<dt>LAST_FAVORITE_SINCE_CREATION_HRS(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“LAST_FAVORITE_SINCE_CREATION_HRS”,
275,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.NONE),</p>
</dd>
<dt>LAST_QUOTE_SINCE_CREATION_HRS(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“LAST_QUOTE_SINCE_CREATION_HRS”,
276,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.NONE),</p>
</dd>
</dl>
<p>// 4 bits hashtag count, mention count and stock count (SEARCH-24336)
// Integer 10
NUM_HASHTAGS_V2(</p>
<blockquote>
<div><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“NUM_HASHTAGS_V2”,
277,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.NONE</p>
</div></blockquote>
<p>),
NUM_MENTIONS_V2(</p>
<blockquote>
<div><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“NUM_MENTIONS_V2”,
278,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.NONE</p>
</div></blockquote>
<p>),
NUM_STOCKS(</p>
<blockquote>
<div><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“NUM_STOCKS”,
279,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.NONE</p>
</div></blockquote>
<p>),</p>
<p>// Integer 11
// Blink engagement counters
BLINK_RETWEET_COUNT(</p>
<blockquote>
<div><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“BLINK_RETWEET_COUNT”,
280,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</div></blockquote>
<dl class="simple">
<dt>BLINK_REPLY_COUNT(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“BLINK_REPLY_COUNT”,
281,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</dd>
<dt>BLINK_FAVORITE_COUNT(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“BLINK_FAVORITE_COUNT”,
282,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</dd>
<dt>BLINK_QUOTE_COUNT(</dt><dd><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“BLINK_QUOTE_COUNT”,
283,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.SMART_INTEGER_NORMALIZER),</p>
</dd>
</dl>
<p>// Integer 10 (remaining)
// Production Toxicity and PBlock score from HML (go/toxicity, go/pblock)
TOXICITY_SCORE(</p>
<blockquote>
<div><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“TOXICITY_SCORE”, 284,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.PREDICTION_SCORE_NORMALIZER</p>
</div></blockquote>
<p>),
PBLOCK_SCORE(</p>
<blockquote>
<div><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“PBLOCK_SCORE”, 285,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.PREDICTION_SCORE_NORMALIZER</p>
</div></blockquote>
<p>),</p>
<p>// Integer 12
// Experimental health model scores from HML
EXPERIMENTAL_HEALTH_MODEL_SCORE_1(</p>
<blockquote>
<div><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“EXPERIMENTAL_HEALTH_MODEL_SCORE_1”, 286,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.PREDICTION_SCORE_NORMALIZER</p>
</div></blockquote>
<p>),
EXPERIMENTAL_HEALTH_MODEL_SCORE_2(</p>
<blockquote>
<div><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“EXPERIMENTAL_HEALTH_MODEL_SCORE_2”, 287,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.PREDICTION_SCORE_NORMALIZER</p>
</div></blockquote>
<p>),
EXPERIMENTAL_HEALTH_MODEL_SCORE_3(</p>
<blockquote>
<div><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“EXPERIMENTAL_HEALTH_MODEL_SCORE_3”, 288,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.PREDICTION_SCORE_NORMALIZER</p>
</div></blockquote>
<p>),
// remaining bits for index 12 (unused_bits_12)
EXTENDED_TEST_FEATURE_UNUSED_BITS_12_30_2(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</p>
<blockquote>
<div><p>“UNUSED_BITS_12_30_2”, 289,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
UnusedFeatureFieldType.UNUSED_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</div></blockquote>
<p>// Integer 13
// Experimental health model scores from HML (cont.)
EXPERIMENTAL_HEALTH_MODEL_SCORE_4(</p>
<blockquote>
<div><p>EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,
“EXPERIMENTAL_HEALTH_MODEL_SCORE_4”, 290,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.PREDICTION_SCORE_NORMALIZER</p>
</div></blockquote>
<p>),
// Production pSpammyTweet score from HML (go/pspammytweet)
P_SPAMMY_TWEET_SCORE(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</p>
<blockquote>
<div><p>“P_SPAMMY_TWEET_SCORE”, 291,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.PREDICTION_SCORE_NORMALIZER</p>
</div></blockquote>
<p>),
// Production pReportedTweet score from HML (go/preportedtweet)
P_REPORTED_TWEET_SCORE(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</p>
<blockquote>
<div><p>“P_REPORTED_TWEET_SCORE”, 293,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.PREDICTION_SCORE_NORMALIZER</p>
</div></blockquote>
<p>),
// remaining bits for index 13 (unused_bits_13)
EXTENDED_TEST_FEATURE_UNUSED_BITS_13_30_2(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</p>
<blockquote>
<div><p>“UNUSED_BITS_13_30_2”, 294,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
UnusedFeatureFieldType.UNUSED_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS</p>
</div></blockquote>
<p>),</p>
<p>// Integer 14
// Health model scores from HML (cont.)
// Prod Spammy Tweet Content model score from Platform Manipulation (go/spammy-tweet-content)
SPAMMY_TWEET_CONTENT_SCORE(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</p>
<blockquote>
<div><p>“SPAMMY_TWEET_CONTENT_SCORE”, 295,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS,
ThriftFeatureNormalizationType.PREDICTION_SCORE_NORMALIZER</p>
</div></blockquote>
<p>),
// remaining bits for index 14 (unused_bits_14)
EXTENDED_TEST_FEATURE_UNUSED_BITS_14_10_22(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</p>
<blockquote>
<div><p>“UNUSED_BITS_14_10_22”, 296,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
UnusedFeatureFieldType.UNUSED_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS</p>
</div></blockquote>
<p>),</p>
<p>// Note that the integer block index i in the names UNUSED_BITS{i}” below is 1-based, but the
// index j in UNUSED_BITS_{j}_x_y above is 0-based.
EXTENDED_TEST_FEATURE_UNUSED_BITS_16(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</p>
<blockquote>
<div><p>“UNUSED_BITS16”, 216,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
UnusedFeatureFieldType.UNUSED_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</div></blockquote>
<dl class="simple">
<dt>EXTENDED_TEST_FEATURE_UNUSED_BITS_17(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“UNUSED_BITS17”, 217,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
UnusedFeatureFieldType.UNUSED_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</dd>
<dt>EXTENDED_TEST_FEATURE_UNUSED_BITS_18(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“UNUSED_BITS18”, 218,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
UnusedFeatureFieldType.UNUSED_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</dd>
<dt>EXTENDED_TEST_FEATURE_UNUSED_BITS_19(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“UNUSED_BITS19”, 219,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
UnusedFeatureFieldType.UNUSED_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS),</p>
</dd>
<dt>EXTENDED_TEST_FEATURE_UNUSED_BITS_20(EXTENDED_ENCODED_TWEET_FEATURES_FIELD_NAME,</dt><dd><p>“UNUSED_BITS20”, 220,
FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,
UnusedFeatureFieldType.UNUSED_FEATURE_FIELD,
EarlybirdCluster.TWITTER_IN_MEMORY_INDEX_FORMAT_ALL_CLUSTERS);</p>
</dd>
</dl>
<p>// Filter field terms. These end up as terms in the “internal” field (id=18). So for example
// you can have a doc with field(internal) = “__filter_nullcast”, “__filter_vine” and that will
// be a nullcast tweet with a vine link in it.
public static final String NULLCAST_FILTER_TERM = “nullcast”;
public static final String VERIFIED_FILTER_TERM = “verified”;
public static final String BLUE_VERIFIED_FILTER_TERM = “blue_verified”;
public static final String NATIVE_RETWEETS_FILTER_TERM = “nativeretweets”;
public static final String QUOTE_FILTER_TERM = “quote”;
public static final String REPLIES_FILTER_TERM = “replies”;
public static final String CONSUMER_VIDEO_FILTER_TERM = “consumer_video”;
public static final String PRO_VIDEO_FILTER_TERM = “pro_video”;
public static final String VINE_FILTER_TERM = “vine”;
public static final String PERISCOPE_FILTER_TERM = “periscope”;
public static final String PROFILE_GEO_FILTER_TERM = “profile_geo”;
public static final String SELF_THREAD_FILTER_TERM = “self_threads”;
public static final String DIRECTED_AT_FILTER_TERM = “directed_at”;
public static final String EXCLUSIVE_FILTER_TERM = “exclusive”;</p>
<p>// Reserved terms for the internal field.
public static final String HAS_POSITIVE_SMILEY = “__has_positive_smiley”;
public static final String HAS_NEGATIVE_SMILEY = “__has_negative_smiley”;
public static final String IS_OFFENSIVE = “__is_offensive”;</p>
<p>// Facet fields
public static final String MENTIONS_FACET = “mentions”;
public static final String HASHTAGS_FACET = “hashtags”;
public static final String STOCKS_FACET = “stocks”;
public static final String VIDEOS_FACET = “videos”;
public static final String IMAGES_FACET = “images”;
public static final String NEWS_FACET = “news”;
public static final String LANGUAGES_FACET = “languages”;
public static final String SOURCES_FACET = “sources”;
public static final String TWIMG_FACET = “twimg”;
public static final String FROM_USER_ID_FACET = “user_id”;
public static final String RETWEETS_FACET = “retweets”;
public static final String LINKS_FACET = “links”;
public static final String SPACES_FACET = “spaces”;</p>
<dl>
<dt>/**</dt><dd><ul class="simple">
<li><p>Used by the query parser to check that the operator of a [filter X] query is valid.</p></li>
<li><p>Also used by blender, though it probably shouldn’t be.</p></li>
</ul>
<p><a href="#id9"><span class="problematic" id="id10">*</span></a>/</p>
</dd>
<dt>public static final ImmutableSet&lt;String&gt; FACETS = ImmutableSet.&lt;String&gt;builder()</dt><dd><p>.add(MENTIONS_FACET)
.add(HASHTAGS_FACET)
.add(STOCKS_FACET)
.add(VIDEOS_FACET)
.add(IMAGES_FACET)
.add(NEWS_FACET)
.add(LINKS_FACET)
.add(LANGUAGES_FACET)
.add(SOURCES_FACET)
.add(TWIMG_FACET)
.add(SPACES_FACET)
.build();</p>
</dd>
<dt>/**</dt><dd><ul class="simple">
<li><p>Used by blender to convert facet names to field names. We should find a way to get the</p></li>
<li><p>information we need in blender without needing this map.</p></li>
</ul>
<p><a href="#id11"><span class="problematic" id="id12">*</span></a>/</p>
</dd>
<dt>public static final ImmutableMap&lt;String, String&gt; FACET_TO_FIELD_MAP =</dt><dd><dl class="simple">
<dt>ImmutableMap.&lt;String, String&gt;builder()</dt><dd><p>.put(MENTIONS_FACET, MENTIONS_FIELD.getFieldName())
.put(HASHTAGS_FACET, HASHTAGS_FIELD.getFieldName())
.put(STOCKS_FACET, STOCKS_FIELD.getFieldName())
.put(VIDEOS_FACET, VIDEO_LINKS_FIELD.getFieldName())
.put(IMAGES_FACET, IMAGE_LINKS_FIELD.getFieldName())
.put(NEWS_FACET, NEWS_LINKS_FIELD.getFieldName())
.put(LANGUAGES_FACET, ISO_LANGUAGE_FIELD.getFieldName())
.put(SOURCES_FACET, SOURCE_FIELD.getFieldName())
.put(TWIMG_FACET, TWIMG_LINKS_FIELD.getFieldName())
.put(LINKS_FACET, LINKS_FIELD.getFieldName())
.put(SPACES_FACET, SPACE_ID_FIELD.getFieldName())
.build();</p>
</dd>
</dl>
</dd>
<dt>public static String getFacetSkipFieldName(String fieldName) {</dt><dd><p>return “__has_” + fieldName;</p>
</dd>
</dl>
<p>}</p>
<p>private final String fieldName;
private final int fieldId;
private final EnumSet&lt;EarlybirdCluster&gt; clusters;
private final FlagFeatureFieldType flagFeatureField;</p>
<p>private final UnusedFeatureFieldType unusedField;</p>
<p>// Only set for feature fields.
&#64;Nullable
private final FeatureConfiguration featureConfiguration;</p>
<p>// Only set for feature fields.
private final ThriftFeatureNormalizationType featureNormalizationType;</p>
<p>// To simplify field configurations and reduce duplicate code, we give clusters a default value
EarlybirdFieldConstant(String fieldName, int fieldId) {</p>
<blockquote>
<div><p>this(fieldName, fieldId, EarlybirdCluster.GENERAL_PURPOSE_CLUSTERS, null);</p>
</div></blockquote>
<p>}</p>
<dl class="simple">
<dt>EarlybirdFieldConstant(String fieldName, int fieldId, Set&lt;EarlybirdCluster&gt; clusters) {</dt><dd><p>this(fieldName, fieldId, clusters, null);</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>EarlybirdFieldConstant(String fieldName, int fieldId, EarlybirdCluster cluster) {</dt><dd><p>this(fieldName, fieldId, ImmutableSet.&lt;EarlybirdCluster&gt;of(cluster), null);</p>
</dd>
</dl>
<p>}</p>
<dl>
<dt>/**</dt><dd><ul class="simple">
<li><p>Base field name is needed here in order to construct the full</p></li>
<li><p>name of the feature. Our convention is that a feature should be named</p></li>
<li><p>as: baseFieldName.featureName.  For example: encoded_tweet_features.retweet_count.</p></li>
</ul>
<p><a href="#id13"><span class="problematic" id="id14">*</span></a>/</p>
</dd>
<dt>EarlybirdFieldConstant(</dt><dd><blockquote>
<div><p>String baseName,
String fieldName,
int fieldId,
FlagFeatureFieldType flagFeatureField,
Set&lt;EarlybirdCluster&gt; clusters) {</p>
</div></blockquote>
<dl class="simple">
<dt>this((baseName + SchemaBuilder.CSF_VIEW_NAME_SEPARATOR + fieldName).toLowerCase(),</dt><dd><p>fieldId, clusters, flagFeatureField, null);</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
<dl>
<dt>EarlybirdFieldConstant(</dt><dd><blockquote>
<div><p>String baseName,
String fieldName,
int fieldId,
FlagFeatureFieldType flagFeatureField,
UnusedFeatureFieldType unusedField,
Set&lt;EarlybirdCluster&gt; clusters) {</p>
</div></blockquote>
<dl class="simple">
<dt>this((baseName + SchemaBuilder.CSF_VIEW_NAME_SEPARATOR + fieldName).toLowerCase(),</dt><dd><p>fieldId, clusters, flagFeatureField, unusedField, null);</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
<dl>
<dt>EarlybirdFieldConstant(</dt><dd><blockquote>
<div><p>String baseName,
String fieldName,
int fieldId,
FlagFeatureFieldType flagFeatureField,
Set&lt;EarlybirdCluster&gt; clusters,
ThriftFeatureNormalizationType featureNormalizationType) {</p>
</div></blockquote>
<dl class="simple">
<dt>this((baseName + SchemaBuilder.CSF_VIEW_NAME_SEPARATOR + fieldName).toLowerCase(),</dt><dd><p>fieldId, clusters, flagFeatureField, UnusedFeatureFieldType.USED_FEATURE_FIELD,
featureNormalizationType, null);</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
<dl>
<dt>/**</dt><dd><ul class="simple">
<li><p>Constructor.</p></li>
</ul>
<p><a href="#id15"><span class="problematic" id="id16">*</span></a>/</p>
</dd>
<dt>EarlybirdFieldConstant(String fieldName, int fieldId, Set&lt;EarlybirdCluster&gt; clusters,</dt><dd><blockquote>
<div><p>&#64;Nullable FeatureConfiguration featureConfiguration) {</p>
</div></blockquote>
<dl class="simple">
<dt>this(fieldName, fieldId, clusters, FlagFeatureFieldType.NON_FLAG_FEATURE_FIELD,</dt><dd><p>featureConfiguration);</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
<dl>
<dt>/**</dt><dd><ul class="simple">
<li><p>Constructor.</p></li>
</ul>
<p><a href="#id17"><span class="problematic" id="id18">*</span></a>/</p>
</dd>
<dt>EarlybirdFieldConstant(String fieldName,</dt><dd><blockquote>
<div><p>int fieldId,
Set&lt;EarlybirdCluster&gt; clusters,
FlagFeatureFieldType flagFeatureField,
&#64;Nullable FeatureConfiguration featureConfiguration) {</p>
</div></blockquote>
<dl class="simple">
<dt>this(fieldName, fieldId, clusters, flagFeatureField,</dt><dd><p>UnusedFeatureFieldType.USED_FEATURE_FIELD, featureConfiguration);</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
<dl>
<dt>/**</dt><dd><ul class="simple">
<li><p>Constructor.</p></li>
</ul>
<p><a href="#id19"><span class="problematic" id="id20">*</span></a>/</p>
</dd>
<dt>EarlybirdFieldConstant(String fieldName,</dt><dd><blockquote>
<div><p>int fieldId,
Set&lt;EarlybirdCluster&gt; clusters,
FlagFeatureFieldType flagFeatureField,
UnusedFeatureFieldType unusedField,
&#64;Nullable FeatureConfiguration featureConfiguration) {</p>
</div></blockquote>
<p>this(fieldName, fieldId, clusters, flagFeatureField, unusedField, null, featureConfiguration);</p>
</dd>
</dl>
<p>}</p>
<dl>
<dt>/**</dt><dd><ul class="simple">
<li><p>Constructor.</p></li>
</ul>
<p><a href="#id21"><span class="problematic" id="id22">*</span></a>/</p>
</dd>
<dt>EarlybirdFieldConstant(String fieldName,</dt><dd><blockquote>
<div><p>int fieldId,
Set&lt;EarlybirdCluster&gt; clusters,
FlagFeatureFieldType flagFeatureField,
UnusedFeatureFieldType unusedField,
&#64;Nullable ThriftFeatureNormalizationType featureNormalizationType,
&#64;Nullable FeatureConfiguration featureConfiguration) {</p>
</div></blockquote>
<p>this.fieldId = fieldId;
this.fieldName = fieldName;
this.clusters = EnumSet.copyOf(clusters);
this.flagFeatureField = flagFeatureField;
this.unusedField = unusedField;
this.featureNormalizationType = featureNormalizationType;
this.featureConfiguration = featureConfiguration;</p>
</dd>
</dl>
<p>}</p>
<p>// Override toString to make replacing StatusConstant Easier.
&#64;Override
public String toString() {</p>
<blockquote>
<div><p>return fieldName;</p>
</div></blockquote>
<p>}</p>
<dl class="simple">
<dt>public boolean isValidFieldInCluster(EarlybirdCluster cluster) {</dt><dd><p>return clusters.contains(cluster);</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>public String getFieldName() {</dt><dd><p>return fieldName;</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>public int getFieldId() {</dt><dd><p>return fieldId;</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>public FlagFeatureFieldType getFlagFeatureField() {</dt><dd><p>return flagFeatureField;</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>public boolean isFlagFeatureField() {</dt><dd><p>return flagFeatureField == FlagFeatureFieldType.FLAG_FEATURE_FIELD;</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>public boolean isUnusedField() {</dt><dd><p>return unusedField == UnusedFeatureFieldType.UNUSED_FEATURE_FIELD;</p>
</dd>
</dl>
<p>}</p>
<p>&#64;Nullable
public FeatureConfiguration getFeatureConfiguration() {</p>
<blockquote>
<div><p>return featureConfiguration;</p>
</div></blockquote>
<p>}</p>
<p>&#64;Nullable
public ThriftFeatureNormalizationType getFeatureNormalizationType() {</p>
<blockquote>
<div><p>return featureNormalizationType;</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>}</p>
<p>private static final Map&lt;String, EarlybirdFieldConstant&gt; NAME_TO_ID_MAP;
private static final Map&lt;Integer, EarlybirdFieldConstant&gt; ID_TO_FIELD_MAP;
static {</p>
<blockquote>
<div><dl class="simple">
<dt>ImmutableMap.Builder&lt;String, EarlybirdFieldConstant&gt; nameToIdMapBuilder =</dt><dd><p>ImmutableMap.builder();</p>
</dd>
<dt>ImmutableMap.Builder&lt;Integer, EarlybirdFieldConstant&gt; idToFieldMapBuilder =</dt><dd><p>ImmutableMap.builder();</p>
</dd>
</dl>
<p>Set&lt;String&gt; fieldNameDupDetector = Sets.newHashSet();
Set&lt;Integer&gt; fieldIdDupDetector = Sets.newHashSet();
for (EarlybirdFieldConstant fc : EarlybirdFieldConstant.values()) {</p>
<blockquote>
<div><dl class="simple">
<dt>if (fieldNameDupDetector.contains(fc.getFieldName())) {</dt><dd><p>throw new IllegalStateException(“detected fields sharing field name: “ + fc.getFieldName());</p>
</dd>
</dl>
<p>}
if (fieldIdDupDetector.contains(fc.getFieldId())) {</p>
<blockquote>
<div><p>throw new IllegalStateException(“detected fields sharing field id: “ + fc.getFieldId());</p>
</div></blockquote>
<p>}</p>
<p>fieldNameDupDetector.add(fc.getFieldName());
fieldIdDupDetector.add(fc.getFieldId());
nameToIdMapBuilder.put(fc.getFieldName(), fc);
idToFieldMapBuilder.put(fc.getFieldId(), fc);</p>
</div></blockquote>
<p>}
NAME_TO_ID_MAP = nameToIdMapBuilder.build();
ID_TO_FIELD_MAP = idToFieldMapBuilder.build();</p>
</div></blockquote>
<p>}</p>
<p>// This define the list of boolean features, but the name does not have “flag” inside.  This
// definition is only for double checking purpose to prevent code change mistakes.  The setting
// of the flag feature is based on FlagFeatureFieldType.FLAG_FEATURE_FIELD.
public static final Set&lt;EarlybirdFieldConstants.EarlybirdFieldConstant&gt; EXTRA_FLAG_FIELDS =</p>
<blockquote>
<div><p>Sets.newHashSet(EarlybirdFieldConstants.EarlybirdFieldConstant.IS_SENSITIVE_CONTENT);</p>
</div></blockquote>
<p>public static final String FLAG_STRING = “flag”;</p>
<p>private static final List&lt;EarlybirdFieldConstant&gt; FLAG_FEATURE_FIELDS;
static {</p>
<blockquote>
<div><p>ImmutableList.Builder&lt;EarlybirdFieldConstant&gt; flagFieldBuilder = ImmutableList.builder();
for (EarlybirdFieldConstant fc : EarlybirdFieldConstant.values()) {</p>
<blockquote>
<div><dl>
<dt>if (fc.getFlagFeatureField() == FlagFeatureFieldType.FLAG_FEATURE_FIELD</dt><dd><blockquote>
<div><p>&amp;&amp; !fc.isUnusedField()) {</p>
</div></blockquote>
<p>flagFieldBuilder.add(fc);</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>}
FLAG_FEATURE_FIELDS = flagFieldBuilder.build();</p>
</div></blockquote>
<p>}</p>
<dl>
<dt>/**</dt><dd><ul class="simple">
<li><p>Get all the flag features meaning that they are boolean features with only 1 bit in the packed</p></li>
<li><p>feature encoding.</p></li>
</ul>
<p><a href="#id23"><span class="problematic" id="id24">*</span></a>/</p>
</dd>
<dt>public static Collection&lt;EarlybirdFieldConstant&gt; getFlagFeatureFields() {</dt><dd><p>return FLAG_FEATURE_FIELDS;</p>
</dd>
</dl>
<p>}</p>
<dl>
<dt>/**</dt><dd><ul class="simple">
<li><p>Get the EarlybirdFieldConstant for the specified field.</p></li>
</ul>
<p><a href="#id25"><span class="problematic" id="id26">*</span></a>/</p>
</dd>
<dt>public static EarlybirdFieldConstant getFieldConstant(String fieldName) {</dt><dd><p>EarlybirdFieldConstant field = NAME_TO_ID_MAP.get(fieldName);
if (field == null) {</p>
<blockquote>
<div><p>throw new IllegalArgumentException(“Unknown field: “ + fieldName);</p>
</div></blockquote>
<p>}
return field;</p>
</dd>
</dl>
<p>}</p>
<dl>
<dt>/**</dt><dd><ul class="simple">
<li><p>Get the EarlybirdFieldConstant for the specified field.</p></li>
</ul>
<p><a href="#id27"><span class="problematic" id="id28">*</span></a>/</p>
</dd>
<dt>public static EarlybirdFieldConstant getFieldConstant(int fieldId) {</dt><dd><p>EarlybirdFieldConstant field = ID_TO_FIELD_MAP.get(fieldId);
if (field == null) {</p>
<blockquote>
<div><p>throw new IllegalArgumentException(“Unknown field: “ + fieldId);</p>
</div></blockquote>
<p>}
return field;</p>
</dd>
</dl>
<p>}</p>
<dl>
<dt>/**</dt><dd><ul class="simple">
<li><p>Determines if there’s a field with the given ID.</p></li>
</ul>
<p><a href="#id29"><span class="problematic" id="id30">*</span></a>/</p>
</dd>
<dt>public static boolean hasFieldConstant(int fieldId) {</dt><dd><p>return ID_TO_FIELD_MAP.keySet().contains(fieldId);</p>
</dd>
</dl>
<p>}</p>
<p>&#64;Override
public final int getFieldID(String fieldName) {</p>
<blockquote>
<div><p>return getFieldConstant(fieldName).getFieldId();</p>
</div></blockquote>
<p>}</p>
<dl class="simple">
<dt>public static final String formatGeoType(ThriftGeoLocationSource source) {</dt><dd><p>return “__geo_location_type_” + source.name().toLowerCase();</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
<p>}</p>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../../../../../index.html">twit</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../../../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, jare.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../../../../../../_sources/src/java/com/twitter/search/common/schema/earlybird/EarlybirdFieldConstants.java.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
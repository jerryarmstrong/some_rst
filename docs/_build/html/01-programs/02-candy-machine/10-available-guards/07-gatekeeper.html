<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>docs/01-programs/02-candy-machine/10-available-guards/07-gatekeeper.md &#8212; twit  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=039e1c02" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="docs-01-programs-02-candy-machine-10-available-guards-07-gatekeeper-md">
<h1>docs/01-programs/02-candy-machine/10-available-guards/07-gatekeeper.md<a class="headerlink" href="#docs-01-programs-02-candy-machine-10-available-guards-07-gatekeeper-md" title="Permalink to this heading">¶</a></h1>
<p>Last edited: 2023-08-08 19:56:25</p>
<p>Contents:</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>---
</pre></div>
</div>
<p>description: “Restricts minting via a Gatekeeper Network e.g. Captcha integration.”
—</p>
<p>import { Accordion, AccordionItem } from ‘/src/accordion.jsx’;</p>
<p># Gatekeeper</p>
<p>## Overview</p>
<p>The <strong>Gatekeeper</strong> guard checks whether the minting wallet has a valid <strong>Gateway Token</strong> — also known as a <strong>Civic Pass</strong> — from a specified <strong>Gatekeeper Network</strong>.</p>
<p>In most cases, this token will be obtained after completing a Captcha challenge but any Gatekeeper Network may be used.</p>
<p>There isn’t much to set up on the Candy Machine side but, depending on the selected Gatekeeper Network, you may need to ask the minting wallet to perform so pre-validation checks to grant them the required Gateway Token.</p>
<p>Here are some additional recommended materials you may find helpful when setting up a Gatekeep Network.</p>
<ul class="simple">
<li><p>[The CIVIC Documentation](<a class="reference external" href="https://docs.civic.com/civic-pass/overview">https://docs.civic.com/civic-pass/overview</a>)</p></li>
<li><p>[Gateway JS Library](<a class="reference external" href="https://www.npmjs.com/package/&#64;identity.com/solana-gateway-ts">https://www.npmjs.com/package/&#64;identity.com/solana-gateway-ts</a>)</p></li>
<li><p>[Gateway React Components](<a class="reference external" href="https://www.npmjs.com/package/&#64;civic/solana-gateway-react">https://www.npmjs.com/package/&#64;civic/solana-gateway-react</a>)</p></li>
</ul>
<p>![CandyMachinesV3-GuardsGatekeeper.png](/assets/candy-machine-v3/CandyMachinesV3-GuardsGatekeeper.png#radius)</p>
<p>## Guard Settings</p>
<p>The Gatekeeper guard contains the following settings:</p>
<ul class="simple">
<li><p><strong>Gatekeeper Network</strong>: The public key of the Gatekeeper Network that will be used to check the validity of the minting wallet. For instance, you may use the “<strong>Civic Captcha Pass</strong>” Network — which ensures the minting wallet has passed a captcha — by using the following address: <cite>ignREusXmGrscGNUesoU9mxfds9AiYTezUKex2PsZV6</cite>.</p></li>
<li><p><strong>Expire On Use</strong>: Whether we should mark the Gateway Token of the minting wallet as expired after the NFT has been minting.
- When set to <cite>true</cite>, they will need to go through the Gatekeeper Network again to mint another NFT.
- When set to <cite>false</cite>, they will be able to mint another NFT until the Gateway Token expires naturally.</p></li>
</ul>
<p>&lt;Accordion&gt;
&lt;AccordionItem title=”JavaScript — Umi library (recommended)” open={true}&gt;
&lt;div className=”accordion-item-padding”&gt;</p>
<p>Here’s how we can set up a Candy Machine using the Gatekeeper guard.</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>ts
create(umi, {</p>
<blockquote>
<div><p>// …
guards: {</p>
<blockquote>
<div><dl class="simple">
<dt>gatekeeper: some({</dt><dd><p>network: publicKey(“ignREusXmGrscGNUesoU9mxfds9AiYTezUKex2PsZV6”),
expireOnUse: true,</p>
</dd>
</dl>
<p>}),</p>
</div></blockquote>
<p>},</p>
</div></blockquote>
<section id="id5">
<h2>});<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h2>
<p>API References: [create](<a class="reference external" href="https://mpl-candy-machine-js-docs.vercel.app/functions/create.html">https://mpl-candy-machine-js-docs.vercel.app/functions/create.html</a>), [Gatekeeper](<a class="reference external" href="https://mpl-candy-machine-js-docs.vercel.app/types/Gatekeeper.html">https://mpl-candy-machine-js-docs.vercel.app/types/Gatekeeper.html</a>)</p>
<p>&lt;/div&gt;
&lt;/AccordionItem&gt;
&lt;AccordionItem title=”JavaScript — SDK”&gt;
&lt;div className=”accordion-item-padding”&gt;</p>
<p>Here’s how we can set up a Candy Machine using the Gatekeeper guard via the JS SDK.</p>
<p><a href="#id6"><span class="problematic" id="id7">``</span></a><a href="#id8"><span class="problematic" id="id9">`</span></a>tsx
import { PublicKey } from “&#64;solana/web3.js”;</p>
<dl class="simple">
<dt>const CAPTCHA_NETWORK = new PublicKey(</dt><dd><p>“ignREusXmGrscGNUesoU9mxfds9AiYTezUKex2PsZV6”</p>
</dd>
</dl>
<p>);</p>
<dl>
<dt>const { candyMachine } = await metaplex.candyMachines().create({</dt><dd><p>// …
guards: {</p>
<blockquote>
<div><dl class="simple">
<dt>gatekeeper: {</dt><dd><p>network: CAPTCHA_NETWORK,
expireOnUse: true,</p>
</dd>
</dl>
<p>},</p>
</div></blockquote>
<p>},</p>
</dd>
</dl>
</section>
<section id="id10">
<h2>});<a class="headerlink" href="#id10" title="Permalink to this heading">¶</a></h2>
<p>API References: [Operation](<a class="reference external" href="https://metaplex-foundation.github.io/js/classes/js.CandyMachineClient.html#create">https://metaplex-foundation.github.io/js/classes/js.CandyMachineClient.html#create</a>), [Input](<a class="reference external" href="https://metaplex-foundation.github.io/js/types/js.CreateCandyMachineInput.html">https://metaplex-foundation.github.io/js/types/js.CreateCandyMachineInput.html</a>), [Output](<a class="reference external" href="https://metaplex-foundation.github.io/js/types/js.CreateCandyMachineOutput.html">https://metaplex-foundation.github.io/js/types/js.CreateCandyMachineOutput.html</a>), [Transaction Builder](<a class="reference external" href="https://metaplex-foundation.github.io/js/classes/js.CandyMachineBuildersClient.html#create">https://metaplex-foundation.github.io/js/classes/js.CandyMachineBuildersClient.html#create</a>), [Guard Settings](<a class="reference external" href="https://metaplex-foundation.github.io/js/types/js.GatekeeperGuardSettings.html">https://metaplex-foundation.github.io/js/types/js.GatekeeperGuardSettings.html</a>).</p>
<p>&lt;/div&gt;
&lt;/AccordionItem&gt;
&lt;/Accordion&gt;</p>
<p>## Mint Settings</p>
<p>The Gatekeeper guard accepts the following mint settings:</p>
<ul class="simple">
<li><p><strong>Gatekeeper Network</strong>: The public key of the Gatekeeper Network that will be used to check the validity of the minting wallet.</p></li>
<li><p><strong>Expire On Use</strong>: Whether we should mark the Gateway Token of the minting wallet as expired after the NFT has been minting.</p></li>
<li><p><strong>Token Account</strong> (optional): As a little disclaimer, you should very rarely need to provide this setting but it’s here if you need to. This refers to the Gateway Token PDA derived from the payer and the Gatekeeper Network which is used to verify the payer’s eligibility to mint. This PDA address can be inferred by our SDKs which is why you do not need to provide it. However, some Gatekeeper Networks may issue multiple Gateway Tokens to the same wallet. To differentiate their PDA addresses, it uses a <strong>Seeds</strong> array which defaults to <cite>[0, 0, 0, 0, 0, 0, 0, 0]</cite>.</p></li>
</ul>
<p>Note that, if you’re planning on constructing instructions without the help of our SDKs, you will need to provide these Mint Settings and more as a combination of instruction arguments and remaining accounts. See the [Candy Guard’s program documentation](<a class="reference external" href="https://github.com/metaplex-foundation/mpl-candy-machine/tree/main/programs/candy-guard#gatekeeper">https://github.com/metaplex-foundation/mpl-candy-machine/tree/main/programs/candy-guard#gatekeeper</a>) for more details.</p>
<p>&lt;Accordion&gt;
&lt;AccordionItem title=”JavaScript — Umi library (recommended)” open={true}&gt;
&lt;div className=”accordion-item-padding”&gt;</p>
<p>You may pass the Mint Settings of the Gatekeeper guard using the <cite>mintArgs</cite> argument like so.</p>
<p><a href="#id11"><span class="problematic" id="id12">``</span></a><a href="#id13"><span class="problematic" id="id14">`</span></a>ts
mintV2(umi, {</p>
<blockquote>
<div><p>// …
mintArgs: {</p>
<blockquote>
<div><dl class="simple">
<dt>gatekeeper: some({</dt><dd><p>network: publicKey(“ignREusXmGrscGNUesoU9mxfds9AiYTezUKex2PsZV6”),
expireOnUse: true,</p>
</dd>
</dl>
<p>}),</p>
</div></blockquote>
<p>},</p>
</div></blockquote>
</section>
<section id="id15">
<h2>});<a class="headerlink" href="#id15" title="Permalink to this heading">¶</a></h2>
<p>API References: [mintV2](<a class="reference external" href="https://mpl-candy-machine-js-docs.vercel.app/functions/mintV2.html">https://mpl-candy-machine-js-docs.vercel.app/functions/mintV2.html</a>), [GatekeeperMintArgs](<a class="reference external" href="https://mpl-candy-machine-js-docs.vercel.app/types/GatekeeperMintArgs.html">https://mpl-candy-machine-js-docs.vercel.app/types/GatekeeperMintArgs.html</a>)</p>
<p>&lt;/div&gt;
&lt;/AccordionItem&gt;
&lt;AccordionItem title=”JavaScript — SDK”&gt;
&lt;div className=”accordion-item-padding”&gt;</p>
<p>In the vast majority of cases, we should not need to provide any Mint Settings to the Gatekeeper guard as the JS SDK will default to provide the right addresses and PDAs to the mint instruction.</p>
<p><a href="#id16"><span class="problematic" id="id17">``</span></a><a href="#id18"><span class="problematic" id="id19">`</span></a>tsx
const { nft } = await metaplex.candyMachines().mint({</p>
<blockquote>
<div><p>// …
guards: {</p>
<blockquote>
<div><p>// No mint settings required…</p>
</div></blockquote>
<p>},</p>
</div></blockquote>
</section>
<section id="id20">
<h2>});<a class="headerlink" href="#id20" title="Permalink to this heading">¶</a></h2>
<p>However, in some rare use cases, we may need to explicitly provide the PDA address of the Gateway Token. Thus, here’s an example providing a Gateway Token that uses non-default seeds.</p>
<p><a href="#id21"><span class="problematic" id="id22">``</span></a><a href="#id23"><span class="problematic" id="id24">`</span></a>tsx
import { Pda } from “&#64;metaplex-foundation/js”;</p>
<p>const gatewayProgram = metaplex.programs().getGateway(programs);
const gatewayToken = Pda.find(gatewayProgram.address, [</p>
<blockquote>
<div><p>payer.publicKey.toBuffer(),
Buffer.from(“gateway”),
Buffer.from([0, 0, 0, 0, 0, 0, 0, 1]), // &lt;- Custom seeds array.
gatewayNetwork.toBuffer(),</p>
</div></blockquote>
<p>]);</p>
<dl>
<dt>const { nft } = await metaplex.candyMachines().mint({</dt><dd><p>// …
guards: {</p>
<blockquote>
<div><dl class="simple">
<dt>gatekeeper: {</dt><dd><p>tokenAccount: gatewayToken,</p>
</dd>
</dl>
<p>},</p>
</div></blockquote>
<p>},</p>
</dd>
</dl>
</section>
<section id="id25">
<h2>});<a class="headerlink" href="#id25" title="Permalink to this heading">¶</a></h2>
<p>API References: [Operation](<a class="reference external" href="https://metaplex-foundation.github.io/js/classes/js.CandyMachineClient.html#mint">https://metaplex-foundation.github.io/js/classes/js.CandyMachineClient.html#mint</a>), [Input](<a class="reference external" href="https://metaplex-foundation.github.io/js/types/js.MintFromCandyMachineInput.html">https://metaplex-foundation.github.io/js/types/js.MintFromCandyMachineInput.html</a>), [Output](<a class="reference external" href="https://metaplex-foundation.github.io/js/types/js.MintFromCandyMachineOutput.html">https://metaplex-foundation.github.io/js/types/js.MintFromCandyMachineOutput.html</a>), [Transaction Builder](<a class="reference external" href="https://metaplex-foundation.github.io/js/classes/js.CandyMachineBuildersClient.html#mint">https://metaplex-foundation.github.io/js/classes/js.CandyMachineBuildersClient.html#mint</a>), [Mint Settings](<a class="reference external" href="https://metaplex-foundation.github.io/js/types/js.GatekeeperGuardMintSettings.html">https://metaplex-foundation.github.io/js/types/js.GatekeeperGuardMintSettings.html</a>).</p>
<p>&lt;/div&gt;
&lt;/AccordionItem&gt;
&lt;/Accordion&gt;</p>
<p>## Route Instruction</p>
<p>_The Gatekeeper guard does not support the route instruction._</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">twit</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, jare.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/01-programs/02-candy-machine/10-available-guards/07-gatekeeper.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
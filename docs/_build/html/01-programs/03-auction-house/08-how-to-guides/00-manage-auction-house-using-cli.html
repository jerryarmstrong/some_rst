<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>docs/01-programs/03-auction-house/08-how-to-guides/00-manage-auction-house-using-cli.md &#8212; twit  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=039e1c02" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="docs-01-programs-03-auction-house-08-how-to-guides-00-manage-auction-house-using-cli-md">
<h1>docs/01-programs/03-auction-house/08-how-to-guides/00-manage-auction-house-using-cli.md<a class="headerlink" href="#docs-01-programs-03-auction-house-08-how-to-guides-00-manage-auction-house-using-cli-md" title="Permalink to this heading">¶</a></h1>
<p>Last edited: 2023-08-08 19:56:25</p>
<p>Contents:</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>---
</pre></div>
</div>
<p>description: “How to manage Auction House using CLI”
—</p>
<p># How to manage Auction House using CLI</p>
<p>## Prerequisites</p>
<ul class="simple">
<li><p><cite>ts-node</cite></p></li>
<li><p><cite>git</cite></p></li>
<li><p><cite>yarn</cite></p></li>
</ul>
<p>## Setup</p>
<p>In order to get started with the Auction House CLI please follow these steps.</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">git</span> <span class="pre">clone</span> <span class="pre">https://github.com/metaplex-foundation/metaplex-program-library.git</span>
<span class="pre">cd</span> <span class="pre">auction-house/cli</span>
<span class="pre">`</span></code>
Note: By default you will be using the latest code on the tip of the <cite>main</cite> branch.</p>
<p>Then:
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">cd</span> <span class="pre">js</span> <span class="pre">&amp;&amp;</span> <span class="pre">yarn</span> <span class="pre">install</span> <span class="pre">&amp;&amp;</span> <span class="pre">yarn</span> <span class="pre">bootstrap</span>
<span class="pre">cd</span> <span class="pre">src</span>
<span class="pre">`</span></code></p>
<p>Once you have cloned the repo and installed packages, make sure you have a local <cite>Keypair</cite> setup. If you need help with that see these guides.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.solana.com/cli/install-solana-cli-tools">https://docs.solana.com/cli/install-solana-cli-tools</a></p></li>
<li><p><a class="reference external" href="https://docs.solana.com/wallet-guide/file-system-wallet">https://docs.solana.com/wallet-guide/file-system-wallet</a></p></li>
</ul>
<p>## Running Commands</p>
<p>To run commands you will use
<cite>ts-node auction-house-cli.ts</cite></p>
<p>### Help</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a>`
ts-node auction-house-cli.ts
Usage: auction-house-cli [options] [command]</p>
<p>Options:
-V, –version                     output the version number
-h, –help                        display help for command</p>
<p>Commands:
show_escrow [options]
withdraw [options]
sell [options]
withdraw_from_treasury [options]
withdraw_from_fees [options]
cancel [options]
execute_sale [options]
buy [options]
deposit [options]
show [options]
create_auction_house [options]
update_auction_house [options]
help [command]                    display help for command</p>
<p><a href="#id3"><span class="problematic" id="id4">``</span></a><a href="#id5"><span class="problematic" id="id6">`</span></a></p>
<p>### Create</p>
<p>Creates an Auction House</p>
<p>See the command help with</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">ts-node</span> <span class="pre">auction-house-cli.ts</span> <span class="pre">help</span> <span class="pre">create_auction_house</span>
<span class="pre">`</span></code></p>
<p>Find your current Keypair, lets say it lives at <cite>~/mywallet.key</cite> or on Windows <cite>C:Userswindowsusermywallet.key</cite>. To create an Auction House you will run.</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">ts-node</span> <span class="pre">auction-house-cli.ts</span> <span class="pre">create_auction_house</span> <span class="pre">--keypair</span> <span class="pre">~/mywallet.key</span> <span class="pre">-e</span> <span class="pre">devnet</span> <span class="pre">-sfbp</span> <span class="pre">1000</span> <span class="pre">-ccsp</span> <span class="pre">false</span> <span class="pre">-rso</span> <span class="pre">false</span>
<span class="pre">`</span></code></p>
<p>In this case we don’t need to require sign-off because we want to make a fully decentralized auction house. Since we did not specify <cite>-tm, –treasury-mint &lt;string&gt;</cite> The currency for payment will be SOL.
Also, the options below will default to being set as the public key of <cite>~/mywallet.key</cite></p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">-twd,</span> <span class="pre">--treasury-withdrawal-destination</span> <span class="pre">&lt;string&gt;</span>
<span class="pre">-fwd,</span> <span class="pre">--fee-withdrawal-destination</span> <span class="pre">&lt;string&gt;</span>
<span class="pre">`</span></code></p>
<p>If all goes well you will see</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">wallet</span> <span class="pre">public</span> <span class="pre">key:</span> <span class="pre">Gsv13oph2i6nkJvNkVfuzkcbHWchz6viUtEg2vsxQMtM</span>
<span class="pre">No</span> <span class="pre">treasury</span> <span class="pre">withdrawal</span> <span class="pre">dest</span> <span class="pre">detected,</span> <span class="pre">using</span> <span class="pre">keypair</span>
<span class="pre">No</span> <span class="pre">fee</span> <span class="pre">withdrawal</span> <span class="pre">dest</span> <span class="pre">detected,</span> <span class="pre">using</span> <span class="pre">keypair</span>
<span class="pre">No</span> <span class="pre">treasury</span> <span class="pre">mint</span> <span class="pre">detected,</span> <span class="pre">using</span> <span class="pre">SOL.</span>
<span class="pre">Created</span> <span class="pre">auction</span> <span class="pre">house</span> <span class="pre">HsKwc8dQtm8KLxshw67dwsNePkH6wMXo5Lwn1FuKjVYVS</span> <span class="pre">&lt;---</span> <span class="pre">Your</span> <span class="pre">auction</span> <span class="pre">house</span> <span class="pre">key</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">different</span>
<span class="pre">`</span></code></p>
<p>Save this key <cite>HsKwc8dQtm8KLxshw67dwsNePkH6wMXo5Lwn1FuKjVYVS</cite> since it is the public key of the solana account that holds your Auction House. In all subsequent commands you will pass this key with the <cite>-ah</cite> option.</p>
<p>## Show</p>
<p>Prints the balances of the fee and treasury wallets configured for the auction house and its current settings options.</p>
<p>See the command help with</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">ts-node</span> <span class="pre">auction-house-cli.ts</span> <span class="pre">help</span> <span class="pre">show</span>
<span class="pre">`</span></code></p>
<p>Notice I switched <cite>–keypair</cite> for <cite>-k</cite> this is shorthand but works just the same.</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">ts-node</span> <span class="pre">auction-house-cli.ts</span> <span class="pre">show</span> <span class="pre">-k</span> <span class="pre">~/mywallet.key</span> <span class="pre">-ah</span> <span class="pre">HsKwc8dQtm8KLxshw67dwsNePkH6wMXo5Lwn1FuKjVYVS</span>
<span class="pre">`</span></code></p>
<p>The output will differ but similar to the following.</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">No</span> <span class="pre">treasury</span> <span class="pre">mint</span> <span class="pre">detected,</span> <span class="pre">using</span> <span class="pre">SOL.</span>
<span class="pre">-----</span>
<span class="pre">Auction</span> <span class="pre">House:</span> <span class="pre">HsKwc8dQtm8KLxshw67dwsNePkH6wMXo5Lwn1FuKjVYVS</span>
<span class="pre">Mint:</span> <span class="pre">So11111111111111111111111111111111111111112</span>
<span class="pre">Authority:</span> <span class="pre">DCDcpZaJUghstQNMHy9VAPnwQe1cGsHq7fbeqkti4kM3</span>
<span class="pre">Creator:</span> <span class="pre">DCDcpZaJUghstQNMHy9VAPnwQe1cGsHq7fbeqkti4kM3</span>
<span class="pre">Fee</span> <span class="pre">Payer</span> <span class="pre">Acct:</span> <span class="pre">AcWpR41NPMq73FZUspCiXxoLrJnW7zytgHKY5xqtETkU</span>
<span class="pre">Treasury</span> <span class="pre">Acct:</span> <span class="pre">HFW5CY73qN3XK3qEP7ZFxbpBBkQtipPfPQzaDj3mbbY1</span>
<span class="pre">Fee</span> <span class="pre">Payer</span> <span class="pre">Withdrawal</span> <span class="pre">Acct:</span> <span class="pre">DCDcpZaJUghstQNMHy9VAPnwQe1cGsHq7fbeqkti4kM3</span>
<span class="pre">Treasury</span> <span class="pre">Withdrawal</span> <span class="pre">Acct:</span> <span class="pre">DCDcpZaJUghstQNMHy9VAPnwQe1cGsHq7fbeqkti4kM3</span>
<span class="pre">Fee</span> <span class="pre">Payer</span> <span class="pre">Bal:</span> <span class="pre">0</span>
<span class="pre">Treasury</span> <span class="pre">Bal:</span> <span class="pre">0</span>
<span class="pre">Seller</span> <span class="pre">Fee</span> <span class="pre">Basis</span> <span class="pre">Points:</span> <span class="pre">1000</span>
<span class="pre">Requires</span> <span class="pre">Sign</span> <span class="pre">Off:</span> <span class="pre">false</span>
<span class="pre">Can</span> <span class="pre">Change</span> <span class="pre">Sale</span> <span class="pre">Price:</span> <span class="pre">false</span>
<span class="pre">AH</span> <span class="pre">Bump:</span> <span class="pre">255</span>
<span class="pre">AH</span> <span class="pre">Fee</span> <span class="pre">Bump:</span> <span class="pre">252</span>
<span class="pre">AH</span> <span class="pre">Treasury</span> <span class="pre">Bump:</span> <span class="pre">254</span>
<span class="pre">`</span></code></p>
<p>### Fee Account</p>
<p>In the above Show command you see a Fee Payer account.
This account can be used to pay the fees on chain for sales execution, transfers and account creation. For this exercise we will teach you how to fund that account by airdropping some SOL on devnet. Your Auction House fee account is used only when the Auction House authority is signing the transaction. This is usually only in the case of <cite>Requires Sign Off</cite></p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">$</span> <span class="pre">solana</span> <span class="pre">airdrop</span> <span class="pre">2</span> <span class="pre">AcWpR41NPMq73FZUspCiXxoLrJnW7zytgHKY5xqtETkU</span>
<span class="pre">Requesting</span> <span class="pre">airdrop</span> <span class="pre">of</span> <span class="pre">2</span> <span class="pre">SOL</span>
<span class="pre">Signature:</span> <span class="pre">4qYFoD8GN6TZLDjLsqyyt6mhjYEjwKF36LJCDLtL88nTD3y3bFzXmVFHP6Nczf5Dn4GnmBJYtbqV9tN2WbsYynpX</span>
<span class="pre">2</span> <span class="pre">SOL</span>
<span class="pre">`</span></code></p>
<p>:::caution</p>
<p>The <cite>solana airdrop</cite> command is sometimes unreliable. If the command doesn’t work, you can use the airdrop tool at <a class="reference external" href="https://solfaucet.com">https://solfaucet.com</a>.</p>
<p>::</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## Sell</span>
</pre></div>
</div>
<p>Place and NFT UP for sale.</p>
<p>See the command help with</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">ts-node</span> <span class="pre">auction-house-cli.ts</span> <span class="pre">help</span> <span class="pre">sell</span>
<span class="pre">`</span></code></p>
<p>Place an NFT for sale by its mint address with the auction house for 1 SOL.</p>
<p><a href="#id7"><span class="problematic" id="id8">``</span></a>`
ts-node auction-house-cli.ts sell </p>
<blockquote>
<div><p>-k ~/mywallet.key -ah HsKwc8dQtm8KLxshw67dwsNePkH6wMXo5Lwn1FuKjVYVS –buy-price 1 –mint F7fejo7cT1fRyJxj1W2aWy3aeJz8iqLU9YvbBAzwJGh2 –token-size 1</p>
</div></blockquote>
<p><a href="#id9"><span class="problematic" id="id10">``</span></a><a href="#id11"><span class="problematic" id="id12">`</span></a></p>
<p>Output</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">wallet</span> <span class="pre">public</span> <span class="pre">key:</span> <span class="pre">CCJC2s8FDGAs8GqmngE9gviusEuNnkdUwchcYMZ8ZmHB</span>
<span class="pre">wallet</span> <span class="pre">public</span> <span class="pre">key:</span> <span class="pre">DCDcpZaJUghstQNMHy9VAPnwQe1cGsHq7fbeqkti4kM3</span>
<span class="pre">Set</span> <span class="pre">1</span> <span class="pre">F7fejo7cT1fRyJxj1W2aWy3aeJz8iqLU9YvbBAzwJGh2</span> <span class="pre">for</span> <span class="pre">sale</span> <span class="pre">for</span> <span class="pre">1</span> <span class="pre">from</span> <span class="pre">your</span> <span class="pre">account</span> <span class="pre">with</span> <span class="pre">Auction</span> <span class="pre">House</span> <span class="pre">Ee53kiwLVw5XG98gSLNHoQRi4J22XEhz3zsKYY2ttsb7</span>
<span class="pre">`</span></code></p>
<p>### Require Sign-off</p>
<p>If the auction house is set up to require sign off its wallet, as well as the seller are provided to the command.
Do this using the <cite>-ak</cite> option.</p>
<p>See the command help with</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">ts-node</span> <span class="pre">auction-house-cli.ts</span> <span class="pre">help</span> <span class="pre">sell</span>
<span class="pre">`</span></code></p>
<p>In a production scenario where the keypair for the auction house is stored on a sever managed by the organization hosting the auction house the transaction should be partially signed by the seller from the client then passed to the server for signing by the auction house before submitting to Solana.</p>
<p>## Buy</p>
<p>Place an offer on an NFT by its mint address at some price in SOL when using native SOL as the mint.</p>
<p>See the command help with</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">ts-node</span> <span class="pre">auction-house-cli.ts</span> <span class="pre">help</span> <span class="pre">buy</span>
<span class="pre">`</span></code></p>
<p>The buy command is an offer on the NFT and will not result in a sale until the <cite>execute_sale</cite> action is triggered. This command offers 2 SOL for the NFT.</p>
<p><a href="#id13"><span class="problematic" id="id14">``</span></a>`
ts-node auction-house-cli.ts buy </p>
<blockquote>
<div><p>-k ~/mywallet.key -ah HsKwc8dQtm8KLxshw67dwsNePkH6wMXo5Lwn1FuKjVYVS –buy-price 2 –token-size 1 –mint 7v8kcqCHLih31bp2xwMojGWTMdrcFfzZsYXNbiLiRYgE</p>
</div></blockquote>
<p>wallet public key: 3DikCrEsfAVHv9rXENg2Hdmc16L71EjveQEF4NbSfRak
wallet public key: DCDcpZaJUghstQNMHy9VAPnwQe1cGsHq7fbeqkti4kM3
Made offer for  2
<a href="#id15"><span class="problematic" id="id16">``</span></a><a href="#id17"><span class="problematic" id="id18">`</span></a></p>
<p>## Execute Sale</p>
<p>Sell an NFT to a buyer at the price set by the seller.  Note that this currently requires the auction house authority, the buyer, or the seller to be the fee payer and thus sign the transaction.</p>
<p>:::info</p>
<p>In a future version of the Auction House, this action will become <cite>permissionless</cite>, meaning anyone will be able to call this instruction with two matching (price must match) orders (bid/sell). This will allow your UI to execute the sale once an order matches on the client side or have a backend process or bot finish the process.</p>
<p>::</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>```
</pre></div>
</div>
<dl class="simple">
<dt>$ ts-node auction-house-cli.ts execute_sale</dt><dd><p>-k ~/mywallet.key -ah HsKwc8dQtm8KLxshw67dwsNePkH6wMXo5Lwn1FuKjVYVS –buy-price 2 –mint DCqt9QQ3ot3qv53EhWrYAWFuh4XgSvFJvLRjgsDnhLTp –buyer-wallet 3DikCrEsfAVHv9rXENg2Hdmc16L71EjveQEF4NbSfRak –seller-wallet CCJC2s8FDGAs8GqmngE9gviusEuNnkdUwchcYMZ8ZmHB –token-size 1</p>
</dd>
</dl>
<p>wallet public key: CCJC2s8FDGAs8GqmngE9gviusEuNnkdUwchcYMZ8ZmHB
wallet public key: DCDcpZaJUghstQNMHy9VAPnwQe1cGsHq7fbeqkti4kM3
Accepted 1 DCqt9QQ3ot3qv53EhWrYAWFuh4XgSvFJvLRjgsDnhLTp sale from wallet CCJC2s8FDGAs8GqmngE9gviusEuNnkdUwchcYMZ8ZmHB to 3DikCrEsfAVHv9rXENg2Hdmc16L71EjveQEF4NbSfRak for 2 from your account with Auction House HsKwc8dQtm8KLxshw67dwsNePkH6wMXo5Lwn1FuKjVYVS
<a href="#id19"><span class="problematic" id="id20">``</span></a><a href="#id21"><span class="problematic" id="id22">`</span></a></p>
<p>## Other Actions</p>
<p>Other actions are documented in the CLI and can be found using the <cite>help</cite> and <cite>&lt;command&gt; help</cite> subcommand:</p>
<ul class="simple">
<li><p>_Cancel_ - Potential buyer revokes their offer.</p></li>
<li><p>_Show <a href="#id23"><span class="problematic" id="id24">Escrow_</span></a> - Print out the balance of an auction house escrow account for a given wallet.</p></li>
<li><p>_Withdraw_ - Transfer funds from user’s buyer escrow account for the auction house to their wallet.</p></li>
<li><p>_Deposit_ - Add funds to user’s buyer escrow account for the auction house.</p></li>
<li><p>_Withdraw from <a href="#id25"><span class="problematic" id="id26">Fee_</span></a> - Transfer funds from auction house fee wallet to the auction house authority.</p></li>
<li><p>_Withdraw from <a href="#id27"><span class="problematic" id="id28">Treasury_</span></a> - Transfer funds from the auction house treasury wallet to the auction house authority.</p></li>
<li><p>_Update Auction <a href="#id29"><span class="problematic" id="id30">House_</span></a> - Update any of the auction house settings including its authority or seller fee.</p></li>
</ul>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">twit</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, jare.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/01-programs/03-auction-house/08-how-to-guides/00-manage-auction-house-using-cli.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>docs/src/implemented-proposals/installer.md &#8212; twit  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=039e1c02" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="docs-src-implemented-proposals-installer-md">
<h1>docs/src/implemented-proposals/installer.md<a class="headerlink" href="#docs-src-implemented-proposals-installer-md" title="Permalink to this heading">¶</a></h1>
<p>Last edited: 2023-08-11 21:38:33</p>
<p>Contents:</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>---
</pre></div>
</div>
<p>title: Cluster Software Installation and Updates
—</p>
<p>Currently users are required to build the solana cluster software themselves from the git repository and manually update it, which is error prone and inconvenient.</p>
<p>This document proposes an easy to use software install and updater that can be used to deploy pre-built binaries for supported platforms. Users may elect to use binaries supplied by Solana or any other party provider. Deployment of updates is managed using an on-chain update manifest program.</p>
<p>## Motivating Examples</p>
<p>### Fetch and run a pre-built installer using a bootstrap curl/shell script</p>
<p>The easiest install method for supported platforms:</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">$</span> <span class="pre">curl</span> <span class="pre">-sSf</span> <span class="pre">https://raw.githubusercontent.com/solana-labs/solana/v1.0.0/install/solana-install-init.sh</span> <span class="pre">|</span> <span class="pre">sh</span>
<span class="pre">`</span></code></p>
<p>This script will check github for the latest tagged release and download and run the <cite>solana-install-init</cite> binary from there.</p>
<p>If additional arguments need to be specified during the installation, the following shell syntax is used:</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">$</span> <span class="pre">init_args=....</span> <span class="pre">#</span> <span class="pre">arguments</span> <span class="pre">for</span> <span class="pre">`solana-install-init</span> <span class="pre">...`</span>
<span class="pre">$</span> <span class="pre">curl</span> <span class="pre">-sSf</span> <span class="pre">https://raw.githubusercontent.com/solana-labs/solana/v1.0.0/install/solana-install-init.sh</span> <span class="pre">|</span> <span class="pre">sh</span> <span class="pre">-s</span> <span class="pre">-</span> <span class="pre">${init_args}</span>
<span class="pre">`</span></code></p>
<p>### Fetch and run a pre-built installer from a Github release</p>
<p>With a well-known release URL, a pre-built binary can be obtained for supported platforms:</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">$</span> <span class="pre">curl</span> <span class="pre">-o</span> <span class="pre">solana-install-init</span> <span class="pre">https://github.com/solana-labs/solana/releases/download/v1.0.0/solana-install-init-x86_64-apple-darwin</span>
<span class="pre">$</span> <span class="pre">chmod</span> <span class="pre">+x</span> <span class="pre">./solana-install-init</span>
<span class="pre">$</span> <span class="pre">./solana-install-init</span> <span class="pre">--help</span>
<span class="pre">`</span></code></p>
<p>### Build and run the installer from source</p>
<p>If a pre-built binary is not available for a given platform, building the installer from source is always an option:</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">$</span> <span class="pre">git</span> <span class="pre">clone</span> <span class="pre">https://github.com/solana-labs/solana.git</span>
<span class="pre">$</span> <span class="pre">cd</span> <span class="pre">solana/install</span>
<span class="pre">$</span> <span class="pre">cargo</span> <span class="pre">run</span> <span class="pre">--</span> <span class="pre">--help</span>
<span class="pre">`</span></code></p>
<p>### Deploy a new update to a cluster</p>
<p>Given a solana release tarball (as created by <cite>ci/publish-tarball.sh</cite>) that has already been uploaded to a publicly accessible URL, the following commands will deploy the update:</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">$</span> <span class="pre">solana-keygen</span> <span class="pre">new</span> <span class="pre">-o</span> <span class="pre">update-manifest.json</span>&#160; <span class="pre">#</span> <span class="pre">&lt;--</span> <span class="pre">only</span> <span class="pre">generated</span> <span class="pre">once,</span> <span class="pre">the</span> <span class="pre">public</span> <span class="pre">key</span> <span class="pre">is</span> <span class="pre">shared</span> <span class="pre">with</span> <span class="pre">users</span>
<span class="pre">$</span> <span class="pre">solana-install</span> <span class="pre">deploy</span> <span class="pre">http://example.com/path/to/solana-release.tar.bz2</span> <span class="pre">update-manifest.json</span>
<span class="pre">`</span></code></p>
<p>### Run a validator node that auto updates itself</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">$</span> <span class="pre">solana-install</span> <span class="pre">init</span> <span class="pre">--pubkey</span> <span class="pre">92DMonmBYXwEMHJ99c9ceRSpAmk9v6i3RdvDdXaVcrfj</span>&#160; <span class="pre">#</span> <span class="pre">&lt;--</span> <span class="pre">pubkey</span> <span class="pre">is</span> <span class="pre">obtained</span> <span class="pre">from</span> <span class="pre">whoever</span> <span class="pre">is</span> <span class="pre">deploying</span> <span class="pre">the</span> <span class="pre">updates</span>
<span class="pre">$</span> <span class="pre">export</span> <span class="pre">PATH=~/.local/share/solana-install/bin:$PATH</span>
<span class="pre">$</span> <span class="pre">solana-keygen</span> <span class="pre">...</span>&#160; <span class="pre">#</span> <span class="pre">&lt;--</span> <span class="pre">runs</span> <span class="pre">the</span> <span class="pre">latest</span> <span class="pre">solana-keygen</span>
<span class="pre">$</span> <span class="pre">solana-install</span> <span class="pre">run</span> <span class="pre">solana-validator</span> <span class="pre">...</span>&#160; <span class="pre">#</span> <span class="pre">&lt;--</span> <span class="pre">runs</span> <span class="pre">a</span> <span class="pre">validator,</span> <span class="pre">restarting</span> <span class="pre">it</span> <span class="pre">as</span> <span class="pre">necessary</span> <span class="pre">when</span> <span class="pre">an</span> <span class="pre">update</span> <span class="pre">is</span> <span class="pre">applied</span>
<span class="pre">`</span></code></p>
<p>## On-chain Update Manifest</p>
<p>An update manifest is used to advertise the deployment of new release tarballs on a solana cluster. The update manifest is stored using the <cite>config</cite> program, and each update manifest account describes a logical update channel for a given target triple (eg, <cite>x86_64-apple-darwin</cite>). The account public key is well-known between the entity deploying new updates and users consuming those updates.</p>
<p>The update tarball itself is hosted elsewhere, off-chain and can be fetched from the specified <cite>download_url</cite>.</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>text
use solana_sdk::signature::Signature;</p>
<p>/// Information required to download and apply a given update
pub struct UpdateManifest {</p>
<blockquote>
<div><p>pub timestamp_secs: u64, // When the release was deployed in seconds since UNIX EPOCH
pub download_url: String, // Download URL to the release tar.bz2
pub download_sha256: String, // SHA256 digest of the release tar.bz2 file</p>
</div></blockquote>
<p>}</p>
<p>/// Data of an Update Manifest program Account.
#[derive(Serialize, Deserialize, Default, Debug, PartialEq)]
pub struct SignedUpdateManifest {</p>
<blockquote>
<div><p>pub manifest: UpdateManifest,
pub manifest_signature: Signature,</p>
</div></blockquote>
<section id="id5">
<h2>}<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h2>
<p>Note that the <cite>manifest</cite> field itself contains a corresponding signature (<cite>manifest_signature</cite>) to guard against man-in-the-middle attacks between the <cite>solana-install</cite> tool and the solana cluster RPC API.</p>
<p>To guard against rollback attacks, <cite>solana-install</cite> will refuse to install an update with an older <cite>timestamp_secs</cite> than what is currently installed.</p>
<p>## Release Archive Contents</p>
<p>A release archive is expected to be a tar file compressed with bzip2 with the following internal structure:</p>
<ul>
<li><p><cite>/version.yml</cite> - a simple YAML file containing the field <cite>“target”</cite> - the</p>
<p>target tuple. Any additional fields are ignored.</p>
</li>
<li><p><cite>/bin/</cite> – directory containing available programs in the release.</p>
<p><cite>solana-install</cite> will symlink this directory to</p>
<p><cite>~/.local/share/solana-install/bin</cite> for use by the <cite>PATH</cite> environment</p>
<p>variable.</p>
</li>
<li><p><cite>…</cite> – any additional files and directories are permitted</p></li>
</ul>
<p>## solana-install Tool</p>
<p>The <cite>solana-install</cite> tool is used by the user to install and update their cluster software.</p>
<p>It manages the following files and directories in the user’s home directory:</p>
<ul class="simple">
<li><p><cite>~/.config/solana/install/config.yml</cite> - user configuration and information about currently installed software version</p></li>
<li><p><cite>~/.local/share/solana/install/bin</cite> - a symlink to the current release. eg, <cite>~/.local/share/solana-update/&lt;update-pubkey&gt;-&lt;manifest_signature&gt;/bin</cite></p></li>
<li><p><cite>~/.local/share/solana/install/releases/&lt;download_sha256&gt;/</cite> - contents of a release</p></li>
</ul>
<p>### Command-line Interface</p>
<p><a href="#id6"><span class="problematic" id="id7">``</span></a><a href="#id8"><span class="problematic" id="id9">`</span></a>text
solana-install 0.16.0
The solana cluster software installer</p>
<dl>
<dt>USAGE:</dt><dd><p>solana-install [OPTIONS] &lt;SUBCOMMAND&gt;</p>
</dd>
<dt>FLAGS:</dt><dd><dl class="option-list">
<dt><kbd><span class="option">-h</span>, <span class="option">--help</span></kbd></dt>
<dd><p>Prints help information</p>
</dd>
<dt><kbd><span class="option">-V</span>, <span class="option">--version</span></kbd></dt>
<dd><p>Prints version information</p>
</dd>
</dl>
</dd>
<dt>OPTIONS:</dt><dd><dl class="option-list">
<dt><kbd><span class="option">-c</span>, <span class="option">--config <var>&lt;PATH&gt;</var></span></kbd></dt>
<dd><p>Configuration file to use [default: …/Library/Preferences/solana/install.yml]</p>
</dd>
</dl>
</dd>
<dt>SUBCOMMANDS:</dt><dd><p>deploy    deploys a new update
help      Prints this message or the help of the given subcommand(s)
info      displays information about the current installation
init      initializes a new installation
run       Runs a program while periodically checking and applying software updates
update    checks for an update, and if available downloads and applies it</p>
</dd>
</dl>
<p><a href="#id10"><span class="problematic" id="id11">``</span></a><a href="#id12"><span class="problematic" id="id13">`</span></a></p>
<p><a href="#id14"><span class="problematic" id="id15">``</span></a><a href="#id16"><span class="problematic" id="id17">`</span></a>text
solana-install-init
initializes a new installation</p>
<dl>
<dt>USAGE:</dt><dd><p>solana-install init [OPTIONS]</p>
</dd>
<dt>FLAGS:</dt><dd><dl class="option-list">
<dt><kbd><span class="option">-h</span>, <span class="option">--help</span></kbd></dt>
<dd><p>Prints help information</p>
</dd>
</dl>
</dd>
<dt>OPTIONS:</dt><dd><dl class="option-list">
<dt><kbd><span class="option">-d</span>, <span class="option">--data_dir <var>&lt;PATH&gt;</var></span></kbd></dt>
<dd><p>Directory to store install data [default: …/Library/Application Support/solana]</p>
</dd>
<dt><kbd><span class="option">-u</span>, <span class="option">--url <var>&lt;URL&gt;</var></span></kbd></dt>
<dd><p>JSON RPC URL for the solana cluster [default: <a class="reference external" href="http://api.devnet.solana.com">http://api.devnet.solana.com</a>]</p>
</dd>
<dt><kbd><span class="option">-p</span>, <span class="option">--pubkey <var>&lt;PUBKEY&gt;</var></span></kbd></dt>
<dd><p>Public key of the update manifest [default: 9XX329sPuskWhH4DQh6k16c87dHKhXLBZTL3Gxmve8Gp]</p>
</dd>
</dl>
</dd>
</dl>
<p><a href="#id18"><span class="problematic" id="id19">``</span></a><a href="#id20"><span class="problematic" id="id21">`</span></a></p>
<p><a href="#id22"><span class="problematic" id="id23">``</span></a><a href="#id24"><span class="problematic" id="id25">`</span></a>text
solana-install info
displays information about the current installation</p>
<dl>
<dt>USAGE:</dt><dd><p>solana-install info [FLAGS]</p>
</dd>
<dt>FLAGS:</dt><dd><dl class="option-list">
<dt><kbd><span class="option">-h</span>, <span class="option">--help</span></kbd></dt>
<dd><p>Prints help information</p>
</dd>
<dt><kbd><span class="option">-l</span>, <span class="option">--local</span></kbd></dt>
<dd><p>only display local information, don’t check the cluster for new updates</p>
</dd>
</dl>
</dd>
</dl>
<p><a href="#id26"><span class="problematic" id="id27">``</span></a><a href="#id28"><span class="problematic" id="id29">`</span></a></p>
<p><a href="#id30"><span class="problematic" id="id31">``</span></a><a href="#id32"><span class="problematic" id="id33">`</span></a>text
solana-install deploy
deploys a new update</p>
<dl>
<dt>USAGE:</dt><dd><p>solana-install deploy &lt;download_url&gt; &lt;update_manifest_keypair&gt;</p>
</dd>
<dt>FLAGS:</dt><dd><dl class="option-list">
<dt><kbd><span class="option">-h</span>, <span class="option">--help</span></kbd></dt>
<dd><p>Prints help information</p>
</dd>
</dl>
</dd>
<dt>ARGS:</dt><dd><p>&lt;download_url&gt;               URL to the solana release archive
&lt;update_manifest_keypair&gt;    Keypair file for the update manifest (/path/to/keypair.json)</p>
</dd>
</dl>
<p><a href="#id34"><span class="problematic" id="id35">``</span></a><a href="#id36"><span class="problematic" id="id37">`</span></a></p>
<p><a href="#id38"><span class="problematic" id="id39">``</span></a><a href="#id40"><span class="problematic" id="id41">`</span></a>text
solana-install update
checks for an update, and if available downloads and applies it</p>
<dl>
<dt>USAGE:</dt><dd><p>solana-install update</p>
</dd>
<dt>FLAGS:</dt><dd><dl class="option-list">
<dt><kbd><span class="option">-h</span>, <span class="option">--help</span></kbd></dt>
<dd><p>Prints help information</p>
</dd>
</dl>
</dd>
</dl>
<p><a href="#id42"><span class="problematic" id="id43">``</span></a><a href="#id44"><span class="problematic" id="id45">`</span></a></p>
<p><a href="#id46"><span class="problematic" id="id47">``</span></a><a href="#id48"><span class="problematic" id="id49">`</span></a>text
solana-install run
Runs a program while periodically checking and applying software updates</p>
<dl>
<dt>USAGE:</dt><dd><p>solana-install run &lt;program_name&gt; [program_arguments]…</p>
</dd>
<dt>FLAGS:</dt><dd><dl class="option-list">
<dt><kbd><span class="option">-h</span>, <span class="option">--help</span></kbd></dt>
<dd><p>Prints help information</p>
</dd>
</dl>
</dd>
<dt>ARGS:</dt><dd><p>&lt;program_name&gt;            program to run
&lt;program_arguments&gt;…    arguments to supply to the program</p>
</dd>
</dl>
<p>The program will be restarted upon a successful software update
<a href="#id50"><span class="problematic" id="id51">``</span></a><a href="#id52"><span class="problematic" id="id53">`</span></a></p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">twit</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, jare.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/src/implemented-proposals/installer.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
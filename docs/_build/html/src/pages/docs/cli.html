<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>docs/src/pages/docs/cli.md &#8212; twit  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=039e1c02" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="docs-src-pages-docs-cli-md">
<h1>docs/src/pages/docs/cli.md<a class="headerlink" href="#docs-src-pages-docs-cli-md" title="Permalink to this heading">¶</a></h1>
<p>Last edited: 2022-12-14 20:15:57</p>
<p>Contents:</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>---
</pre></div>
</div>
<p>title: CLI
description: Anchor - CLI
—</p>
<p>A CLI is provided to support building and managing an Anchor workspace.
For a comprehensive list of commands and options, run <cite>anchor -h</cite> on any
of the following subcommands.</p>
<p>—</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>shell
anchor-cli</p>
<dl>
<dt>USAGE:</dt><dd><p>anchor &lt;SUBCOMMAND&gt;</p>
</dd>
<dt>FLAGS:</dt><dd><dl class="option-list">
<dt><kbd><span class="option">-h</span>, <span class="option">--help</span></kbd></dt>
<dd><p>Prints help information</p>
</dd>
<dt><kbd><span class="option">-V</span>, <span class="option">--version</span></kbd></dt>
<dd><p>Prints version information</p>
</dd>
</dl>
</dd>
<dt>SUBCOMMANDS:</dt><dd><p>account    Fetch and deserialize an account using the IDL provided
build      Builds the workspace
cluster    Cluster commands
deploy     Deploys each program in the workspace
expand     Expands the macros of a program or the workspace
help       Prints this message or the help of the given subcommand(s)
idl        Commands for interacting with interface definitions
init       Initializes a workspace
migrate    Runs the deploy migration script
new        Creates a new program
shell      Starts a node shell with an Anchor client setup according to the local config
test       Runs integration tests against a localnetwork
upgrade    Upgrades a single program. The configured wallet must be the upgrade authority
verify     Verifies the on-chain bytecode matches the locally compiled artifact. Run this</p>
<blockquote>
<div><p>command inside a program subdirectory, i.e., in the dir containing the program’s
Cargo.toml</p>
</div></blockquote>
</dd>
</dl>
<p><a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<p>## Account</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">anchor</span> <span class="pre">account</span> <span class="pre">&lt;program-name&gt;.&lt;AccountTypeName&gt;</span> <span class="pre">&lt;account_pubkey&gt;</span>
<span class="pre">`</span></code></p>
<p>Fetches an account with the given public key and deserializes the data to JSON using the type name provided. If this command is run from within a workspace, the workspace’s IDL files will be used to get the data types. Otherwise, the path to the IDL file must be provided.</p>
<p>The <cite>program-name</cite> is the name of the program where the account struct resides, usually under <cite>programs/&lt;program-name&gt;</cite>. <cite>program-name</cite> should be provided in a case-sensitive manner exactly as the folder name, usually in kebab-case.</p>
<p>The <cite>AccountTypeName</cite> is the name of the account struct, usually in PascalCase.</p>
<p>The <cite>account_pubkey</cite> refers to the Pubkey of the account to deserialise, in Base58.</p>
<p>Example Usage: <cite>anchor account anchor-escrow.EscrowAccount 3PNkzWKXCsbjijbasnx55NEpJe8DFXvEEbJKdRKpDcfK</cite>, deserializes an account in the given pubkey with the account struct <cite>EscrowAccount</cite> defined in the <cite>anchor-escrow</cite> program.</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">anchor</span> <span class="pre">account</span> <span class="pre">&lt;program-name&gt;.&lt;AccountTypeName&gt;</span> <span class="pre">&lt;account_pubkey&gt;</span> <span class="pre">--idl</span> <span class="pre">&lt;path/to/idl.json&gt;</span>
<span class="pre">`</span></code></p>
<p>Deserializes the account with the data types provided in the given IDL file even if inside a workspace.</p>
<p>## Build</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">build</span>
<span class="pre">`</span></code></p>
<p>Builds programs in the workspace targeting Solana’s BPF runtime and emitting IDLs in the <cite>target/idl</cite> directory.</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">build</span> <span class="pre">--verifiable</span>
<span class="pre">`</span></code></p>
<p>Runs the build inside a docker image so that the output binary is deterministic (assuming a Cargo.lock file is used). This command must be run from within a single crate subdirectory within the workspace. For example, <cite>programs/&lt;my-program&gt;/</cite>.</p>
<p>## Cluster</p>
<p>### Cluster list</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">cluster</span> <span class="pre">list</span>
<span class="pre">`</span></code></p>
<p>This lists cluster endpoints:</p>
<p><a href="#id9"><span class="problematic" id="id10">``</span></a><a href="#id11"><span class="problematic" id="id12">`</span></a>shell
Cluster Endpoints:</p>
<ul class="simple">
<li><p>Mainnet - <a class="reference external" href="https://solana-api.projectserum.com">https://solana-api.projectserum.com</a></p></li>
<li><p>Mainnet - <a class="reference external" href="https://api.mainnet-beta.solana.com">https://api.mainnet-beta.solana.com</a></p></li>
<li><p>Devnet  - <a class="reference external" href="https://api.devnet.solana.com">https://api.devnet.solana.com</a></p></li>
<li><p>Testnet - <a class="reference external" href="https://api.testnet.solana.com">https://api.testnet.solana.com</a></p></li>
</ul>
<p><a href="#id13"><span class="problematic" id="id14">``</span></a><a href="#id15"><span class="problematic" id="id16">`</span></a></p>
<p>## Deploy</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">deploy</span>
<span class="pre">`</span></code></p>
<p>Deploys all programs in the workspace to the configured cluster.</p>
<p>{% callout title=”Tip” %}
This is different from the <cite>solana program deploy</cite> command, because everytime it’s run
it will generate a _new_ program address.
{% /callout %}</p>
<p>## Expand</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">expand</span>
<span class="pre">`</span></code></p>
<p>If run inside a program folder, expands the macros of the program.</p>
<p>If run in the workspace but outside a program folder, expands the macros of the workspace.</p>
<p>If run with the <cite>–program-name</cite> option, expand only the given program.</p>
<p>## Idl</p>
<p>The <cite>idl</cite> subcommand provides commands for interacting with interface definition files.
It’s recommended to use these commands to store an IDL on chain, at a deterministic
address, as a function of nothing but the the program’s ID. This
allows us to generate clients for a program using nothing but the program ID.</p>
<p>### Idl Init</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">idl</span> <span class="pre">init</span> <span class="pre">-f</span> <span class="pre">&lt;target/idl/program.json&gt;</span> <span class="pre">&lt;program-id&gt;</span>
<span class="pre">`</span></code></p>
<p>Creates an idl account, writing the given <cite>&lt;target/idl/program.json&gt;</cite> file into a program owned account. By default, the size of the account is double the size of the IDL,
allowing room for growth in case the idl needs to be upgraded in the future.</p>
<p>### Idl Fetch</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">idl</span> <span class="pre">fetch</span> <span class="pre">-o</span> <span class="pre">&lt;out-file.json&gt;</span> <span class="pre">&lt;program-id&gt;</span>
<span class="pre">`</span></code></p>
<p>Fetches an IDL from the configured blockchain. For example, make sure
your <cite>Anchor.toml</cite> is pointing to the <cite>mainnet</cite> cluster and run</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">idl</span> <span class="pre">fetch</span> <span class="pre">GrAkKfEpTKQuVHG2Y97Y2FF4i7y7Q5AHLK94JBy7Y5yv</span>
<span class="pre">`</span></code></p>
<p>### Idl Authority</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">idl</span> <span class="pre">authority</span> <span class="pre">&lt;program-id&gt;</span>
<span class="pre">`</span></code></p>
<p>Outputs the IDL account’s authority. This is the wallet that has the ability to
update the IDL.</p>
<p>### Idl Erase Authority</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">idl</span> <span class="pre">erase-authority</span> <span class="pre">-p</span> <span class="pre">&lt;program-id&gt;</span>
<span class="pre">`</span></code></p>
<p>Erases the IDL account’s authority so that upgrades can no longer occur. The
configured wallet must be the current authority.</p>
<p>### Idl Upgrade</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">idl</span> <span class="pre">upgrade</span> <span class="pre">&lt;program-id&gt;</span> <span class="pre">-f</span> <span class="pre">&lt;target/idl/program.json&gt;</span>
<span class="pre">`</span></code></p>
<p>Upgrades the IDL file on chain to the new <cite>target/idl/program.json</cite> idl.
The configured wallet must be the current authority.</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">idl</span> <span class="pre">set-authority</span> <span class="pre">-n</span> <span class="pre">&lt;new-authority&gt;</span> <span class="pre">-p</span> <span class="pre">&lt;program-id&gt;</span>
<span class="pre">`</span></code></p>
<p>Sets a new authority on the IDL account. Both the <cite>new-authority</cite> and <cite>program-id</cite>
must be encoded in base 58.</p>
<p>## Init</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">init</span>
<span class="pre">`</span></code></p>
<p>Initializes a project workspace with the following structure.</p>
<ul class="simple">
<li><p><cite>Anchor.toml</cite>: Anchor configuration file.</p></li>
<li><p><cite>Cargo.toml</cite>: Rust workspace configuration file.</p></li>
<li><p><cite>package.json</cite>: JavaScript dependencies file.</p></li>
<li><p><cite>programs/</cite>: Directory for Solana program crates.</p></li>
<li><p><cite>app/</cite>: Directory for your application frontend.</p></li>
<li><p><cite>tests/</cite>: Directory for JavaScript integration tests.</p></li>
<li><p><cite>migrations/deploy.js</cite>: Deploy script.</p></li>
</ul>
<p>## Migrate</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">migrate</span>
<span class="pre">`</span></code></p>
<p>Runs the deploy script located at <cite>migrations/deploy.js</cite>, injecting a provider configured
from the workspace’s <cite>Anchor.toml</cite>. For example,</p>
<p><a href="#id17"><span class="problematic" id="id18">``</span></a><a href="#id19"><span class="problematic" id="id20">`</span></a>javascript
// File: migrations/deploys.js</p>
<p>const anchor = require(<a class="reference external" href="mailto:'&#37;&#52;&#48;project-serum/anchor">‘<span>&#64;</span>project-serum/anchor</a>’)</p>
<dl>
<dt>module.exports = async function (provider) {</dt><dd><p>anchor.setProvider(provider)</p>
<p>// Add your deploy script here.</p>
</dd>
</dl>
<section id="id21">
<h2>}<a class="headerlink" href="#id21" title="Permalink to this heading">¶</a></h2>
<p>Migrations are a new feature
and only support this simple deploy script at the moment.</p>
<p>## New</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">new</span> <span class="pre">&lt;program-name&gt;</span>
<span class="pre">`</span></code></p>
<p>Creates a new program in the workspace’s <cite>programs/</cite> directory initialized with boilerplate.</p>
<p>## Shell</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">shell</span>
<span class="pre">`</span></code></p>
<p>Starts a node js shell with an Anchor client setup according to the local config. This client can be used to interact with deployed Solana programs in the workspace.</p>
<p>## Test</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">test</span>
<span class="pre">`</span></code></p>
<p>Run an integration test suit against the configured cluster, deploying new versions
of all workspace programs before running them.</p>
<p>If the configured network is a localnet, then automatically starts the localnetwork and runs
the test.</p>
<p>{% callout title=”Note” %}
Be sure to shutdown any other local validators, otherwise <cite>anchor test</cite> will fail to run.</p>
<p>If you’d prefer to run the program against your local validator use <cite>anchor test –skip-local-validator</cite>.
{% /callout %}</p>
<p>When running tests we stream program logs to <cite>.anchor/program-logs/&lt;address&gt;.&lt;program-name&gt;.log</cite></p>
<p>{% callout title=”Note” %}
The Anchor workflow [recommends](<a class="reference external" href="https://www.parity.io/paritys-checklist-for-secure-smart-contract-development/">https://www.parity.io/paritys-checklist-for-secure-smart-contract-development/</a>) to test your program using integration tests in a language other than Rust to make sure that bugs related to syntax misunderstandings are coverable with tests and not just replicated in tests.
{% /callout %}</p>
<p>## Upgrade</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">upgrade</span> <span class="pre">&lt;target/deploy/program.so&gt;</span> <span class="pre">--program-id</span> <span class="pre">&lt;program-id&gt;</span>
<span class="pre">`</span></code></p>
<p>Uses Solana’s upgradeable BPF loader to upgrade the on chain program code.</p>
<p>## Verify</p>
<p><code class="docutils literal notranslate"><span class="pre">`shell</span>
<span class="pre">anchor</span> <span class="pre">verify</span> <span class="pre">&lt;program-id&gt;</span>
<span class="pre">`</span></code></p>
<p>Verifies the on-chain bytecode matches the locally compiled artifact.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">twit</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, jare.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/src/pages/docs/cli.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
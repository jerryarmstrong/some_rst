<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>docs/src/cli/sign-offchain-message.md &#8212; twit  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=039e1c02" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="docs-src-cli-sign-offchain-message-md">
<h1>docs/src/cli/sign-offchain-message.md<a class="headerlink" href="#docs-src-cli-sign-offchain-message-md" title="Permalink to this heading">¶</a></h1>
<p>Last edited: 2023-08-11 21:38:33</p>
<p>Contents:</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>---
</pre></div>
</div>
<p>title: Off-Chain Message Signing
—</p>
<p>Off-chain message signing is a method of signing non-transaction messages with
a Solana wallet. This feature can be used to authenticate users or provide
proof of wallet ownership.</p>
<p>## Sign Off-Chain Message</p>
<p>To sign an arbitrary off-chain message, run the following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">solana</span> <span class="pre">sign-offchain-message</span> <span class="pre">&lt;MESSAGE&gt;</span>
<span class="pre">`</span></code></p>
<p>The message will be encoded and signed with CLI’s default private key and
signature printed to the output. If you want to sign it with another key, just
use the <cite>-k/–keypair</cite> option:</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">solana</span> <span class="pre">sign-offchain-message</span> <span class="pre">-k</span> <span class="pre">&lt;KEYPAIR&gt;</span> <span class="pre">&lt;MESSAGE&gt;</span>
<span class="pre">`</span></code></p>
<p>By default, the messages constructed are version 0, the only version currently
supported. When other versions become available, you can override the default
value with the <cite>–version</cite> option:</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">solana</span> <span class="pre">sign-offchain-message</span> <span class="pre">-k</span> <span class="pre">&lt;KEYPAIR&gt;</span> <span class="pre">--version</span> <span class="pre">&lt;VERSION&gt;</span> <span class="pre">&lt;MESSAGE&gt;</span>
<span class="pre">`</span></code></p>
<p>The message format is determined automatically based on the version and text
of the message.</p>
<p>Version <cite>0</cite> headers specify three message formats allowing for trade-offs
between compatibility and composition of messages:</p>
<div class="line-block">
<div class="line">ID  |      Encoding       | Maximum Length | Hardware Wallet Support |</div>
<div class="line">:-: | :—————–: | :————: | :———————: |</div>
<div class="line-block">
<div class="line">0  | Restricted ASCII * |      1212      |           Yes           |</div>
<div class="line">1  |        UTF-8        |      1212      |     Blind sign only     |</div>
<div class="line">2  |        UTF-8        |     65515      |           No            |</div>
</div>
</div>
<p>* Those characters for which [<cite>isprint(3)</cite>](<a class="reference external" href="https://linux.die.net/man/3/isprint">https://linux.die.net/man/3/isprint</a>)
returns true. That is, <cite>0x20..=0x7e</cite>.</p>
<p>Formats <cite>0</cite> and <cite>1</cite> are motivated by hardware wallet support where both RAM to
store the payload and font character support are limited.</p>
<p>To sign an off-chain message with Ledger, ensure your Ledger is running latest
firmware and Solana Ledger App version 1.3.0 or later. After Ledger is
unlocked and Solana Ledger App is open, run:</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">solana</span> <span class="pre">sign-offchain-message</span> <span class="pre">-k</span> <span class="pre">usb://ledger</span> <span class="pre">&lt;MESSAGE&gt;</span>
<span class="pre">`</span></code></p>
<p>For more information on how to setup and work with the ledger device see this
[link](../wallet-guide/hardware-wallets/ledger.md).</p>
<p>Please note that UTF-8 encoded messages require <cite>Allow blind sign</cite> option
enabled in Solana Ledger App. Also, due to the lack of UTF-8 support in Ledger
devices, only the hash of the message will be displayed in such cases.</p>
<p>If <cite>Display mode</cite> is set to <cite>Expert</cite>, Ledger will display technical
information about the message to be signed.</p>
<p>## Verify Off-Chain Message Signature</p>
<p>To verify the off-chain message signature, run the following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">solana</span> <span class="pre">verify-offchain-signature</span> <span class="pre">&lt;MESSAGE&gt;</span> <span class="pre">&lt;SIGNATURE&gt;</span>
<span class="pre">`</span></code></p>
<p>The public key of the default CLI signer will be used. You can specify another
key with the <cite>–signer</cite> option:</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">solana</span> <span class="pre">verify-offchain-signature</span> <span class="pre">--signer</span> <span class="pre">&lt;PUBKEY&gt;</span> <span class="pre">&lt;MESSAGE&gt;</span> <span class="pre">&lt;SIGNATURE&gt;</span>
<span class="pre">`</span></code></p>
<p>If the signed message has a version different from the default, you need to
specify the matching version explicitly:</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">solana</span> <span class="pre">verify-offchain-signature</span> <span class="pre">--version</span> <span class="pre">&lt;VERSION&gt;</span> <span class="pre">&lt;MESSAGE&gt;</span> <span class="pre">&lt;SIGNATURE&gt;</span>
<span class="pre">`</span></code></p>
<p>## Protocol Specification</p>
<p>To ensure that off-chain messages are not valid transactions, they are encoded
with a fixed prefix: <cite>xffsolana offchain</cite>, where first byte is chosen such
that it is implicitly illegal as the first byte in a transaction
<cite>MessageHeader</cite> today. More details about the payload format and other
considerations are available in the
[proposal](<a class="reference external" href="https://github.com/solana-labs/solana/blob/e80f67dd58b7fa3901168055211f346164efa43a/docs/src/proposals/off-chain-message-signing.md">https://github.com/solana-labs/solana/blob/e80f67dd58b7fa3901168055211f346164efa43a/docs/src/proposals/off-chain-message-signing.md</a>).</p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">twit</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, jare.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/src/cli/sign-offchain-message.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>docs/src/proposals/rust-clients.md &#8212; twit  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=039e1c02" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="docs-src-proposals-rust-clients-md">
<h1>docs/src/proposals/rust-clients.md<a class="headerlink" href="#docs-src-proposals-rust-clients-md" title="Permalink to this heading">¶</a></h1>
<p>Last edited: 2023-08-11 21:38:33</p>
<p>Contents:</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>---
</pre></div>
</div>
<p>title: Rust Clients
—</p>
<p>## Problem</p>
<p>High-level tests, such as bench-tps, are written in terms of the <cite>Client</cite>
trait. When we execute these tests as part of the test suite, we use the
low-level <cite>BankClient</cite> implementation. When we need to run the same test
against a cluster, we use the <cite>ThinClient</cite> implementation. The problem with
that approach is that it means the trait will continually expand to include new
utility functions and all implementations of it need to add the new
functionality. By separating the user-facing object from the trait that abstracts
the network interface, we can expand the user-facing object to include all sorts
of useful functionality, such as the “spinner” from RpcClient, without concern
for needing to extend the trait and its implementations.</p>
<p>## Proposed Solution</p>
<p>Instead of implementing the <cite>Client</cite> trait, <cite>ThinClient</cite> should be constructed
with an implementation of it. That way, all utility functions currently in the
<cite>Client</cite> trait can move into <cite>ThinClient</cite>. <cite>ThinClient</cite> could then move into
<cite>solana-sdk</cite> since all its network dependencies would be in the implementation
of <cite>Client</cite>. We would then add a new implementation of <cite>Client</cite>, called
<cite>ClusterClient</cite>, and that would live in the <cite>solana-client</cite> crate, where
<cite>ThinClient</cite> currently resides.</p>
<p>After this reorg, any code needing a client would be written in terms of
<cite>ThinClient</cite>. In unit tests, the functionality would be invoked with
<cite>ThinClient&lt;BankClient&gt;</cite>, whereas <cite>main()</cite> functions, benchmarks and
integration tests would invoke it with <cite>ThinClient&lt;ClusterClient&gt;</cite>.</p>
<p>If higher-level components require more functionality than what could be
implemented by <cite>BankClient</cite>, it should be implemented by a second object
that implements a second trait, following the same pattern described here.</p>
<p>### Error Handling</p>
<p>The <cite>Client</cite> should use the existing <cite>TransportError</cite> enum for errors, except
that the <cite>Custom(String)</cite> field should be changed to <cite>Custom(Box&lt;dyn Error&gt;)</cite>.</p>
<p>### Implementation Strategy</p>
<ol class="arabic simple">
<li><p>Add new object to <cite>solana-sdk</cite>, <cite>RpcClientTng</cite>, where the <cite>Tng</cite> suffix is
temporary and stands for “The Next Generation”</p></li>
<li><p>Initialize <cite>RpcClientTng</cite> with a <cite>SyncClient</cite> implementation.</p></li>
<li><p>Add new object to <cite>solana-sdk</cite>, <cite>ThinClientTng</cite>; initialize it with
<cite>RpcClientTng</cite> and an <cite>AsyncClient</cite> implementation</p></li>
<li><p>Move all unit-tests from <cite>BankClient</cite> to <cite>ThinClientTng&lt;BankClient&gt;</cite></p></li>
<li><p>Add <cite>ClusterClient</cite></p></li>
<li><p>Move <cite>ThinClient</cite> users to <cite>ThinClientTng&lt;ClusterClient&gt;</cite></p></li>
<li><p>Delete <cite>ThinClient</cite> and rename <cite>ThinClientTng</cite> to <cite>ThinClient</cite></p></li>
<li><p>Move <cite>RpcClient</cite> users to new <cite>ThinClient&lt;ClusterClient&gt;</cite></p></li>
<li><p>Delete <cite>RpcClient</cite> and rename <cite>RpcClientTng</cite> to <cite>RpcClient</cite></p></li>
</ol>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">twit</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, jare.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/src/proposals/rust-clients.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
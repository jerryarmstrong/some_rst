<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>docs/src/stake-pool/fees.md &#8212; twit  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=039e1c02" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="docs-src-stake-pool-fees-md">
<h1>docs/src/stake-pool/fees.md<a class="headerlink" href="#docs-src-stake-pool-fees-md" title="Permalink to this heading">¶</a></h1>
<p>Last edited: 2022-07-07 18:10:20</p>
<p>Contents:</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>---
</pre></div>
</div>
<p>title: Fees
—</p>
<p>Operators of stake pools should take time to understand the purpose of each fee
and think about them carefully to ensure that the pool cannot be abused.</p>
<p>There are five different sources of fees.</p>
<p>### Epoch Fee</p>
<p>Every epoch (roughly 2 days), the stake accounts in the pool earn
inflation rewards, so the stake pool mints pool tokens into the manager’s fee
account as a proportion of the earned rewards.</p>
<p>For example, if the pool earns 10 SOL in rewards, and the fee is set to 2%, the
manager will earn pool tokens worth 0.2 SOL.</p>
<p>Note that the epoch fee is charged after normal validator
commissions are assessed. For example, if a validator charges 8% commission,
and the stake pool charges 2%, and a stake in the pool earns 100 SOL pre-commission,
then that stake will actually enrich the pool by 90.16 SOL. The total rewards
on that validator will be reduced by ~9.84%.</p>
<p>### SOL Withdraw Fee</p>
<p>Sends a proportion of the desired withdrawal amount to the manager.</p>
<p>For example, if a user wishes to withdraw 100 pool tokens, and the fee is set
to 3%, 3 pool tokens go to the manager, and the remaining 97 tokens are converted
to SOL and sent to the user.</p>
<p>### Stake Withdraw Fee</p>
<p>Sends a proportion of the desired withdrawal amount to the manager before
creating a new stake for the user.</p>
<p>For example, if a user wishes to withdraw 100 pool tokens, and the fee is set
to 0.5%, 0.5 pool tokens go to the manager, and the remaining 99.5 tokens are
converted to SOL then sent to the user as an activated stake account.</p>
<p>### SOL Deposit Fee</p>
<p>Converts the entire SOL deposit into pool tokens, then sends a proportion of
the pool tokens to the manager, and the rest to the user.</p>
<p>For example, if a user deposits 100 SOL, which converts to 90 pool tokens,
and the fee is 1%, then the user receives 89.1 pool tokens, and the manager receives
0.9 pool tokens.</p>
<p>### Stake Deposit Fee</p>
<p>Converts the stake account’s delegation plus rent-exemption to pool tokens,
sends a proportion of those to the manager, and the rest to the user. The rent-
exempt portion of the stake account is converted at the SOL deposit rate, and
the stake is converted at the stake deposit rate.</p>
<p>For example, let’s say the pool token to SOL exchange rate is 1:1, the SOL deposit rate
is 10%, and the stake deposit rate is 5%. If a user deposits a stake account with
100 SOL staked and 0.00228288 SOL for the rent exemption. The fee from the stake
is worth 5 pool tokens, and the fee from the rent exemption is worth 0.000228288
pool tokens, so the user receives 95.002054592 pool tokens, and the manager
receives 5.000228288 pool tokens.</p>
<p>## Referral Fees</p>
<p>For partner applications, the manager may set a referral fee on deposits.
During SOL or stake deposits, the stake pool redistributes a percentage of
the pool token fees to another address as a referral fee.</p>
<p>This option is particularly attractive for wallet providers. When a wallet
integrates a stake pool, the wallet developer will have the option to earn
additional tokens anytime a user deposits into the stake pool. Stake pool
managers can use this feature to create strategic partnerships and entice
greater adoption of stake pools!</p>
<p>## Best Practices</p>
<p>Outside of monetization, fees are a crucial tool for avoiding economic attacks
on the stake pool and keeping it running. For this reason, the stake pool CLI
will prevent managers from creating a pool with no fees, unless they also provide
the <cite>–yolo</cite> flag.</p>
<p>### Epoch</p>
<p>If a stake pool with 1000 validators runs a rebalancing script every epoch, the
staker needs to send roughly 200 transactions to update the stake pool balances,
followed by up to 1000 transactions to increase or decrease the stake on every
validator.</p>
<p>At the time of writing, the current transaction fee is 5,000 lamports per signature,
so the minimum cost for these 1,200 transactions is 6,000,000 lamports, or 0.006 SOL.
For the stake pool manager to break even, they must earn 0.006 SOL per epoch in
fees.</p>
<p>For example, let’s say we have a stake pool with 10,000 SOL staked, whose stakes
are earning 6% APY / ~3.3 basis points per epoch, yielding roughly 3.3 SOL per epoch
in rewards.  The minimal break-even epoch fee for this stake pool is 0.18%.</p>
<p>### Stake Deposit / Withdraw</p>
<p>If a stake pool has no deposit or withdraw fees, a malicious pool token holder
can easily leech value from the stake pool.</p>
<p>In the simplest attack, right before the end of every epoch, the malicious pool
token holder finds the highest performing validator in the pool for that epoch,
withdraws an active stake worth all of their pool tokens, waits until the epoch
rolls over, earns the maximum stake rewards, and then deposits right back into
the stake pool.</p>
<p>Practically speaking, the malicious depositor is always delegated to the best
performing validator in the stake pool, without ever actually committing a stake
to that validator. On top of that, the malicious depositor goes around any
epoch fees.</p>
<p>To render this attack unviable, the stake pool manager can set a deposit or withdraw
fee. If the stake pool has an overall performance of 6% APY / ~3.3 basis points
per epoch, and the best validator has a performance of 6.15% APY / ~3.37 basis
points per epoch, then the minimum stake deposit / withdrawal fee would be
0.07 basis points.</p>
<p>For total safety, in case a delinquent validator in the pool brings down
performance, a manager may want to go much higher.</p>
<p>### SOL Deposit / Withdrawal</p>
<p>If a stake pool has 0 SOL deposit / withdrawal fee, then a malicious SOL holder
can perform a similar attack to extract even more value from the pool.</p>
<p>If they deposit SOL into a stake pool, withdraw a stake account on the top
validator in the pool, wait until the epoch rolls over, then deposit that stake
back into the pool, then withdraw SOL, they have essentially earned free instant
rewards without any time commitment of their SOL.  In the meantime, the stake
pool performance has decreased because the deposited liquid SOL does not earn
rewards.</p>
<p>For example, if the best performing validator in the stake pool earns 6.15%
APY / ~3.37 basis points per epoch, then the minimum SOL deposit / withdrawal
fee should be 3.37 basis points.</p>
<p>## Final thoughts</p>
<p>The attacks outlined in the previous sections are the simplest attacks that anyone
can easily perform with a couple of scripts running a few times per epoch. There are
likely more complex attacks possible for zero or very low fee stake pools, so be
sure to protect your depositors with fees!</p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">twit</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, jare.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/src/stake-pool/fees.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
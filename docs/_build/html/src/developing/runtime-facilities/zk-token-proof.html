<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>docs/src/developing/runtime-facilities/zk-token-proof.md &#8212; twit  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=039e1c02" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="docs-src-developing-runtime-facilities-zk-token-proof-md">
<h1>docs/src/developing/runtime-facilities/zk-token-proof.md<a class="headerlink" href="#docs-src-developing-runtime-facilities-zk-token-proof-md" title="Permalink to this heading">¶</a></h1>
<p>Last edited: 2023-08-11 21:38:33</p>
<p>Contents:</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>---
</pre></div>
</div>
<p>title: ZK Token Proof Program
—</p>
<p>The native Solana ZK Token proof program verifies a number of zero-knowledge
proofs that are tailored to work with Pedersen commitments and ElGamal
encryption over the elliptic curve
[curve25519](<a class="reference external" href="https://www.rfc-editor.org/rfc/rfc7748#section-4.1">https://www.rfc-editor.org/rfc/rfc7748#section-4.1</a>). The program
was originally designed to verify the zero-knowledge proofs that are required
for the [SPL Token 2022](<a class="reference external" href="https://spl.solana.com/token-2022">https://spl.solana.com/token-2022</a>) program. However,
the zero-knowledge proofs in the proof program can be used in more general
contexts outside of SPL Token 2022 as well.</p>
<ul class="simple">
<li><p>Program id: <cite>ZkTokenProof1111111111111111111111111111111</cite></p></li>
<li><p>Instructions:
[ProofInstruction](<a class="reference external" href="https://github.com/solana-labs/solana/blob/master/zk-token-sdk/src/zk_token_proof_instruction.rs">https://github.com/solana-labs/solana/blob/master/zk-token-sdk/src/zk_token_proof_instruction.rs</a>)</p></li>
</ul>
<p>### Pedersen commitments and ElGamal encryption</p>
<p>The ZK Token proof program verifies zero-knowledge proofs for Pedersen
commitments and ElGamal encryption, which are common cryptographic primitives
that are incorporated in many existing cryptographic protocols.</p>
<p>ElGamal encryption is a popular instantiation of a public-key encryption scheme.
An ElGamal keypair consists of an ElGamal public key and an ElGamal secret key.
Messages can be encrypted under a public key to produce a ciphertext. A
ciphertext can then be decrypted using a corresponding ElGamal secret key. The
variant that is used in the proof program is the
[twisted ElGamal encryption](<a class="reference external" href="https://eprint.iacr.org/2019/319">https://eprint.iacr.org/2019/319</a>) over the elliptic
curve [curve25519](<a class="reference external" href="https://www.rfc-editor.org/rfc/rfc7748#section-4.1">https://www.rfc-editor.org/rfc/rfc7748#section-4.1</a>).</p>
<p>The Pedersen commitment scheme is a popular instantiation of a cryptographic
commitment scheme. A commitment scheme allows a user to wrap a message into a
commitment with a purpose of revealing the committed message later on. Like a
ciphertext, the resulting commitment does not reveal any information about the
containing message. At the same time, the commitment is binding in that the user
cannot change the original value that is contained in a commitment.</p>
<p>Interested readers can refer to the following resources for a more in-depth
treatment of Pedersen commitment and the (twisted) ElGamal encryption schemes.</p>
<ul class="simple">
<li><p>[Notes](./zk-docs/twisted_elgamal.pdf) on the twisted ElGamal encryption</p></li>
<li><p>A technical
[overview](<a class="reference external" href="https://github.com/solana-labs/solana-program-library/blob/master/token/zk-token-protocol-paper/part1.pdf">https://github.com/solana-labs/solana-program-library/blob/master/token/zk-token-protocol-paper/part1.pdf</a>)
of the SPL Token 2022 confidential extension</p></li>
<li><p>Pretty Good Confidentiality [research paper](<a class="reference external" href="https://eprint.iacr.org/2019/319">https://eprint.iacr.org/2019/319</a>)</p></li>
</ul>
<p>The ZK Token proof program contains proof verification instructions on various
zero-knowledge proofs for working with the Pedersen commitment and ElGamal
encryption schemes. For example, the <cite>VerifyRangeProofU64</cite> instruction verifies
a zero-knowledge proof certifying that a Pedersen commitment contains an
unsigned 64-bit number as the message. The <cite>VerifyPubkeyValidity</cite> instruction
verifies a zero-knowledge proof certifying that an ElGamal public key is a
properly formed public key.</p>
<p>### Context Data</p>
<p>The proof data associated with each of the ZK Token proof instructions are
logically divided into two parts:</p>
<ul class="simple">
<li><p>The &lt;em&gt;context&lt;/em&gt; component contains the data that a zero-knowledge proof
is certifying. For example, context component for a <cite>VerifyRangeProofU64</cite>
instruction data is the Pedersen commitment that holds an unsigned 64-bit
number. The context component for a <cite>VerifyPubkeyValidity</cite> instruction data is
the ElGamal public key that is properly formed.</p></li>
<li><p>The &lt;em&gt;proof&lt;/em&gt; component contains the actual mathematical pieces that
certify different properties of the context data.</p></li>
</ul>
<p>The ZK Token proof program processes a proof instruction in two steps:</p>
<ol class="arabic simple">
<li><p>Verify the zero-knowledge proof data associated with the proof instruction.</p></li>
<li><p>If specified in the instruction, the program stores the context data in a
dedicated context state account.</p></li>
</ol>
<p>The simplest way to use a proof instruction is to execute it without producing a
context state account. In this case, the proof instruction can be included as
part of a larger Solana transaction that contains instructions of other Solana
programs. Programs should directly access the context data from the proof
instruction data and use it in its program logic.</p>
<p>Alternatively, a proof instruction can be executed to produce a context state
account. In this case, the context data associated with a proof instruction
persists even after the transaction containing the proof instruction is finished
with its execution. The creation of context state accounts can be useful in
settings where ZK proofs are required from PDAs or when proof data is too large
to fit inside a single transaction.</p>
<p>## Proof Instructions</p>
<p>The ZK Token proof program supports the following list of zero-knowledge proofs.</p>
<p>#### Proofs on ElGamal encryption</p>
<ul class="simple">
<li><p><cite>VerifyPubkeyValidity</cite>:</p>
<ul>
<li><p>The ElGamal public-key validity proof instruction certifies that an ElGamal
public-key is a properly formed public key.</p></li>
<li><p>Mathematical description and proof of security:
[[Notes]](./zk-docs/pubkey_proof.pdf)</p></li>
</ul>
</li>
<li><p><cite>VerifyZeroBalance</cite>:</p>
<ul>
<li><p>The zero-balance proof certifies that an ElGamal ciphertext encrypts the
number zero.</p></li>
<li><p>Mathematical description and proof of security:
[[Notes]](./zk-docs/zero_proof.pdf)</p></li>
</ul>
</li>
</ul>
<p>#### Equality proofs</p>
<ul class="simple">
<li><p><cite>VerifyCiphertextCommitmentEquality</cite>:</p>
<ul>
<li><p>The ciphertext-commitment equality proof certifies that an ElGamal
ciphertext and a Pedersen commitment encode the same message.</p></li>
<li><p>Mathematical description and proof of security:
[[Notes]](./zk-docs/ciphertext_commitment_equality.pdf)</p></li>
</ul>
</li>
<li><p><cite>VerifyCiphertextCiphertextEquality</cite>:</p>
<ul>
<li><p>The ciphertext-ciphertext equality proof certifies that two ElGamal
ciphertexts encrypt the same message.</p></li>
<li><p>Mathematical description and proof of security:
[[Notes]](./zk-docs/ciphertext_ciphertext_equality.pdf)</p></li>
</ul>
</li>
</ul>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">twit</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, jare.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/src/developing/runtime-facilities/zk-token-proof.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
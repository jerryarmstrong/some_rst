<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>docs/src/developing/on-chain-programs/developing-rust.md &#8212; twit  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=039e1c02" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="docs-src-developing-on-chain-programs-developing-rust-md">
<h1>docs/src/developing/on-chain-programs/developing-rust.md<a class="headerlink" href="#docs-src-developing-on-chain-programs-developing-rust-md" title="Permalink to this heading">¶</a></h1>
<p>Last edited: 2023-08-11 21:38:33</p>
<p>Contents:</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>---
</pre></div>
</div>
<p>title: “Developing with Rust”
—</p>
<p>Solana supports writing on-chain programs using the
[Rust](<a class="reference external" href="https://www.rust-lang.org/">https://www.rust-lang.org/</a>) programming language.</p>
<p>## Project Layout</p>
<p>Solana Rust programs follow the typical [Rust project
layout](<a class="reference external" href="https://doc.rust-lang.org/cargo/guide/project-layout.html">https://doc.rust-lang.org/cargo/guide/project-layout.html</a>):</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">/inc/</span>
<span class="pre">/src/</span>
<span class="pre">/Cargo.toml</span>
<span class="pre">`</span></code></p>
<p>Solana Rust programs may depend directly on each other in order to gain access
to instruction helpers when making [cross-program invocations](developing/programming-model/calling-between-programs.md#cross-program-invocations).
When doing so it’s important to not pull in the dependent program’s entrypoint
symbols because they may conflict with the program’s own. To avoid this,
programs should define an <cite>no-entrypoint</cite> feature in <cite>Cargo.toml</cite> and use
to exclude the entrypoint.</p>
<ul class="simple">
<li><p>[Define the
feature](<a class="reference external" href="https://github.com/solana-labs/solana-program-library/blob/fca9836a2c8e18fc7e3595287484e9acd60a8f64/token/program/Cargo.toml#L12">https://github.com/solana-labs/solana-program-library/blob/fca9836a2c8e18fc7e3595287484e9acd60a8f64/token/program/Cargo.toml#L12</a>)</p></li>
<li><p>[Exclude the
entrypoint](<a class="reference external" href="https://github.com/solana-labs/solana-program-library/blob/fca9836a2c8e18fc7e3595287484e9acd60a8f64/token/program/src/lib.rs#L12">https://github.com/solana-labs/solana-program-library/blob/fca9836a2c8e18fc7e3595287484e9acd60a8f64/token/program/src/lib.rs#L12</a>)</p></li>
</ul>
<p>Then when other programs include this program as a dependency, they should do so
using the <cite>no-entrypoint</cite> feature.</p>
<ul class="simple">
<li><p>[Include without
entrypoint](<a class="reference external" href="https://github.com/solana-labs/solana-program-library/blob/fca9836a2c8e18fc7e3595287484e9acd60a8f64/token-swap/program/Cargo.toml#L22">https://github.com/solana-labs/solana-program-library/blob/fca9836a2c8e18fc7e3595287484e9acd60a8f64/token-swap/program/Cargo.toml#L22</a>)</p></li>
</ul>
<p>## Project Dependencies</p>
<p>At a minimum, Solana Rust programs must pull in the
[solana-program](<a class="reference external" href="https://crates.io/crates/solana-program">https://crates.io/crates/solana-program</a>) crate.</p>
<p>Solana SBF programs have some [restrictions](#restrictions) that may prevent the
inclusion of some crates as dependencies or require special handling.</p>
<p>For example:</p>
<ul class="simple">
<li><p>Crates that require the architecture be a subset of the ones supported by the
official toolchain. There is no workaround for this unless that crate is
forked and SBF added to that those architecture checks.</p></li>
<li><p>Crates may depend on <cite>rand</cite> which is not supported in Solana’s deterministic
program environment. To include a <cite>rand</cite> dependent crate refer to [Depending
on Rand](#depending-on-rand).</p></li>
<li><p>Crates may overflow the stack even if the stack overflowing code isn’t
included in the program itself. For more information refer to
[Stack](./faq.md#stack).</p></li>
</ul>
<p>## How to Build</p>
<p>First setup the environment:</p>
<ul class="simple">
<li><p>Install the latest Rust stable from <a class="reference external" href="https://rustup.rs/">https://rustup.rs/</a></p></li>
<li><p>Install the latest [Solana command-line tools](../../cli/install-solana-cli-tools.md)</p></li>
</ul>
<p>The normal cargo build is available for building programs against your host
machine which can be used for unit testing:</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">$</span> <span class="pre">cargo</span> <span class="pre">build</span>
<span class="pre">`</span></code></p>
<p>To build a specific program, such as SPL Token, for the Solana SBF target which
can be deployed to the cluster:</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">$</span> <span class="pre">cd</span> <span class="pre">&lt;the</span> <span class="pre">program</span> <span class="pre">directory&gt;</span>
<span class="pre">$</span> <span class="pre">cargo</span> <span class="pre">build-bpf</span>
<span class="pre">`</span></code></p>
<p>## How to Test</p>
<p>Solana programs can be unit tested via the traditional <cite>cargo test</cite> mechanism by
exercising program functions directly.</p>
<p>To help facilitate testing in an environment that more closely matches a live
cluster, developers can use the
[<cite>program-test</cite>](<a class="reference external" href="https://crates.io/crates/solana-program-test">https://crates.io/crates/solana-program-test</a>) crate. The
<cite>program-test</cite> crate starts up a local instance of the runtime and allows tests
to send multiple transactions while keeping state for the duration of the test.</p>
<p>For more information the [test in sysvar
example](<a class="reference external" href="https://github.com/solana-labs/solana-program-library/blob/master/examples/rust/sysvar/tests/functional.rs">https://github.com/solana-labs/solana-program-library/blob/master/examples/rust/sysvar/tests/functional.rs</a>)
shows how an instruction containing sysvar account is sent and processed by the
program.</p>
<p>## Program Entrypoint</p>
<p>Programs export a known entrypoint symbol which the Solana runtime looks up and
calls when invoking a program. Solana supports multiple versions of the BPF
loader and the entrypoints may vary between them.
Programs must be written for and deployed to the same loader. For more details
see the [FAQ section on Loaders](./faq.md#loaders).</p>
<p>Currently there are two supported loaders [BPF
Loader](<a class="reference external" href="https://github.com/solana-labs/solana/blob/d9b0fc0e3eec67dfe4a97d9298b15969b2804fab/sdk/program/src/bpf_loader.rs#L17">https://github.com/solana-labs/solana/blob/d9b0fc0e3eec67dfe4a97d9298b15969b2804fab/sdk/program/src/bpf_loader.rs#L17</a>)
and [BPF loader
deprecated](<a class="reference external" href="https://github.com/solana-labs/solana/blob/d9b0fc0e3eec67dfe4a97d9298b15969b2804fab/sdk/program/src/bpf_loader_deprecated.rs#L14">https://github.com/solana-labs/solana/blob/d9b0fc0e3eec67dfe4a97d9298b15969b2804fab/sdk/program/src/bpf_loader_deprecated.rs#L14</a>)</p>
<p>They both have the same raw entrypoint definition, the following is the raw
symbol that the runtime looks up and calls:</p>
<p><code class="docutils literal notranslate"><span class="pre">`rust</span>
<span class="pre">#[no_mangle]</span>
<span class="pre">pub</span> <span class="pre">unsafe</span> <span class="pre">extern</span> <span class="pre">&quot;C&quot;</span> <span class="pre">fn</span> <span class="pre">entrypoint(input:</span> <span class="pre">*mut</span> <span class="pre">u8)</span> <span class="pre">-&gt;</span> <span class="pre">u64;</span>
<span class="pre">`</span></code></p>
<p>This entrypoint takes a generic byte array which contains the serialized program
parameters (program id, accounts, instruction data, etc…). To deserialize the
parameters each loader contains its own wrapper macro that exports the raw
entrypoint, deserializes the parameters, calls a user defined instruction
processing function, and returns the results.</p>
<p>You can find the entrypoint macros here:</p>
<ul class="simple">
<li><p>[BPF Loader’s entrypoint
macro](<a class="reference external" href="https://github.com/solana-labs/solana/blob/9b1199cdb1b391b00d510ed7fc4866bdf6ee4eb3/sdk/program/src/entrypoint.rs#L42">https://github.com/solana-labs/solana/blob/9b1199cdb1b391b00d510ed7fc4866bdf6ee4eb3/sdk/program/src/entrypoint.rs#L42</a>)</p></li>
<li><p>[BPF Loader deprecated’s entrypoint
macro](<a class="reference external" href="https://github.com/solana-labs/solana/blob/9b1199cdb1b391b00d510ed7fc4866bdf6ee4eb3/sdk/program/src/entrypoint_deprecated.rs#L38">https://github.com/solana-labs/solana/blob/9b1199cdb1b391b00d510ed7fc4866bdf6ee4eb3/sdk/program/src/entrypoint_deprecated.rs#L38</a>)</p></li>
</ul>
<p>The program defined instruction processing function that the entrypoint macros
call must be of this form:</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>rust
pub type ProcessInstruction =</p>
<blockquote>
<div><p>fn(program_id: &amp;Pubkey, accounts: &amp;[AccountInfo], instruction_data: &amp;[u8]) -&gt; ProgramResult;</p>
</div></blockquote>
<p><a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<p>### Parameter Deserialization</p>
<p>Each loader provides a helper function that deserializes the program’s input
parameters into Rust types. The entrypoint macros automatically calls the
deserialization helper:</p>
<ul class="simple">
<li><p>[BPF Loader
deserialization](<a class="reference external" href="https://github.com/solana-labs/solana/blob/d9b0fc0e3eec67dfe4a97d9298b15969b2804fab/sdk/program/src/entrypoint.rs#L146">https://github.com/solana-labs/solana/blob/d9b0fc0e3eec67dfe4a97d9298b15969b2804fab/sdk/program/src/entrypoint.rs#L146</a>)</p></li>
<li><p>[BPF Loader deprecated
deserialization](<a class="reference external" href="https://github.com/solana-labs/solana/blob/d9b0fc0e3eec67dfe4a97d9298b15969b2804fab/sdk/program/src/entrypoint_deprecated.rs#L57">https://github.com/solana-labs/solana/blob/d9b0fc0e3eec67dfe4a97d9298b15969b2804fab/sdk/program/src/entrypoint_deprecated.rs#L57</a>)</p></li>
</ul>
<p>Some programs may want to perform deserialization themselves and they can by
providing their own implementation of the [raw entrypoint](#program-entrypoint).
Take note that the provided deserialization functions retain references back to
the serialized byte array for variables that the program is allowed to modify
(lamports, account data). The reason for this is that upon return the loader
will read those modifications so they may be committed. If a program implements
their own deserialization function they need to ensure that any modifications
the program wishes to commit be written back into the input byte array.</p>
<p>Details on how the loader serializes the program inputs can be found in the
[Input Parameter Serialization](./faq.md#input-parameter-serialization) docs.</p>
<p>### Data Types</p>
<p>The loader’s entrypoint macros call the program defined instruction processor
function with the following parameters:</p>
<p><code class="docutils literal notranslate"><span class="pre">`rust</span>
<span class="pre">program_id:</span> <span class="pre">&amp;Pubkey,</span>
<span class="pre">accounts:</span> <span class="pre">&amp;[AccountInfo],</span>
<span class="pre">instruction_data:</span> <span class="pre">&amp;[u8]</span>
<span class="pre">`</span></code></p>
<p>The program id is the public key of the currently executing program.</p>
<p>The accounts is an ordered slice of the accounts referenced by the instruction
and represented as an
[AccountInfo](<a class="reference external" href="https://github.com/solana-labs/solana/blob/d9b0fc0e3eec67dfe4a97d9298b15969b2804fab/sdk/program/src/account_info.rs#L12">https://github.com/solana-labs/solana/blob/d9b0fc0e3eec67dfe4a97d9298b15969b2804fab/sdk/program/src/account_info.rs#L12</a>)
structures. An account’s place in the array signifies its meaning, for example,
when transferring lamports an instruction may define the first account as the
source and the second as the destination.</p>
<p>The members of the <cite>AccountInfo</cite> structure are read-only except for <cite>lamports</cite>
and <cite>data</cite>. Both may be modified by the program in accordance with the [runtime
enforcement policy](developing/programming-model/accounts.md#policy). Both of
these members are protected by the Rust <cite>RefCell</cite> construct, so they must be
borrowed to read or write to them. The reason for this is they both point back
to the original input byte array, but there may be multiple entries in the
accounts slice that point to the same account. Using <cite>RefCell</cite> ensures that the
program does not accidentally perform overlapping read/writes to the same
underlying data via multiple <cite>AccountInfo</cite> structures. If a program implements
their own deserialization function care should be taken to handle duplicate
accounts appropriately.</p>
<p>The instruction data is the general purpose byte array from the [instruction’s
instruction data](developing/programming-model/transactions.md#instruction-data)
being processed.</p>
<p>## Heap</p>
<p>Rust programs implement the heap directly by defining a custom
[<cite>global_allocator</cite>](<a class="reference external" href="https://github.com/solana-labs/solana/blob/d9b0fc0e3eec67dfe4a97d9298b15969b2804fab/sdk/program/src/entrypoint.rs#L72">https://github.com/solana-labs/solana/blob/d9b0fc0e3eec67dfe4a97d9298b15969b2804fab/sdk/program/src/entrypoint.rs#L72</a>)</p>
<p>Programs may implement their own <cite>global_allocator</cite> based on its specific needs.
Refer to the [custom heap example](#examples) for more information.</p>
<p>## Restrictions</p>
<p>On-chain Rust programs support most of Rust’s libstd, libcore, and liballoc, as
well as many 3rd party crates.</p>
<p>There are some limitations since these programs run in a resource-constrained,
single-threaded environment, as well as being deterministic:</p>
<ul class="simple">
<li><p>No access to
- <cite>rand</cite>
- <cite>std::fs</cite>
- <cite>std::net</cite>
- <cite>std::future</cite>
- <cite>std::process</cite>
- <cite>std::sync</cite>
- <cite>std::task</cite>
- <cite>std::thread</cite>
- <cite>std::time</cite></p></li>
<li><p>Limited access to:
- <cite>std::hash</cite>
- <cite>std::os</cite></p></li>
<li><p>Bincode is extremely computationally expensive in both cycles and call depth
and should be avoided</p></li>
<li><p>String formatting should be avoided since it is also computationally
expensive.</p></li>
<li><p>No support for <cite>println!</cite>, <cite>print!</cite>, the Solana [logging helpers](#logging)
should be used instead.</p></li>
<li><p>The runtime enforces a limit on the number of instructions a program can
execute during the processing of one instruction. See
[computation budget](developing/programming-model/runtime.md#compute-budget) for more
information.</p></li>
</ul>
<p>## Depending on Rand</p>
<p>Programs are constrained to run deterministically, so random numbers are not
available. Sometimes a program may depend on a crate that depends itself on
<cite>rand</cite> even if the program does not use any of the random number functionality.
If a program depends on <cite>rand</cite>, the compilation will fail because there is no
<cite>get-random</cite> support for Solana. The error will typically look like this:</p>
<p><a href="#id9"><span class="problematic" id="id10">``</span></a>`
error: target is not supported, for more information see: <a class="reference external" href="https://docs.rs/getrandom/#unsupported-targets">https://docs.rs/getrandom/#unsupported-targets</a></p>
<blockquote>
<div><dl>
<dt>–&gt; /Users/jack/.cargo/registry/src/github.com-1ecc6299db9ec823/getrandom-0.1.14/src/lib.rs:257:9</dt><dd><div class="line-block">
<div class="line"><br /></div>
</div>
</dd>
</dl>
</div></blockquote>
<p>257 | /         compile_error!(”258 | |             target is not supported, for more information see: 259 | |             <a class="reference external" href="https://docs.rs/getrandom/#unsupported-targets">https://docs.rs/getrandom/#unsupported-targets</a>260 | |         “);</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a href="#id11"><span class="problematic" id="id12">|</span></a>___________^</div>
</div>
</div></blockquote>
<p><a href="#id13"><span class="problematic" id="id14">``</span></a><a href="#id15"><span class="problematic" id="id16">`</span></a></p>
<p>To work around this dependency issue, add the following dependency to the
program’s <cite>Cargo.toml</cite>:</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">getrandom</span> <span class="pre">=</span> <span class="pre">{</span> <span class="pre">version</span> <span class="pre">=</span> <span class="pre">&quot;0.1.14&quot;,</span> <span class="pre">features</span> <span class="pre">=</span> <span class="pre">[&quot;dummy&quot;]</span> <span class="pre">}</span>
<span class="pre">`</span></code></p>
<p>or if the dependency is on getrandom v0.2 add:</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">getrandom</span> <span class="pre">=</span> <span class="pre">{</span> <span class="pre">version</span> <span class="pre">=</span> <span class="pre">&quot;0.2.2&quot;,</span> <span class="pre">features</span> <span class="pre">=</span> <span class="pre">[&quot;custom&quot;]</span> <span class="pre">}</span>
<span class="pre">`</span></code></p>
<p>## Logging</p>
<p>Rust’s <cite>println!</cite> macro is computationally expensive and not supported. Instead
the helper macro
[<cite>msg!</cite>](<a class="reference external" href="https://github.com/solana-labs/solana/blob/d9b0fc0e3eec67dfe4a97d9298b15969b2804fab/sdk/program/src/log.rs#L33">https://github.com/solana-labs/solana/blob/d9b0fc0e3eec67dfe4a97d9298b15969b2804fab/sdk/program/src/log.rs#L33</a>)
is provided.</p>
<p><cite>msg!</cite> has two forms:</p>
<p><code class="docutils literal notranslate"><span class="pre">`rust</span>
<span class="pre">msg!(&quot;A</span> <span class="pre">string&quot;);</span>
<span class="pre">`</span></code></p>
<p>or</p>
<p><code class="docutils literal notranslate"><span class="pre">`rust</span>
<span class="pre">msg!(0_64,</span> <span class="pre">1_64,</span> <span class="pre">2_64,</span> <span class="pre">3_64,</span> <span class="pre">4_64);</span>
<span class="pre">`</span></code></p>
<p>Both forms output the results to the program logs. If a program so wishes they
can emulate <cite>println!</cite> by using <cite>format!</cite>:</p>
<p><code class="docutils literal notranslate"><span class="pre">`rust</span>
<span class="pre">msg!(&quot;Some</span> <span class="pre">variable:</span> <span class="pre">{:?}&quot;,</span> <span class="pre">variable);</span>
<span class="pre">`</span></code></p>
<p>The [debugging](debugging.md#logging) section has more information about working
with program logs the [Rust examples](#examples) contains a logging example.</p>
<p>## Panicking</p>
<p>Rust’s <cite>panic!</cite>, <cite>assert!</cite>, and internal panic results are printed to the
[program logs](debugging.md#logging) by default.</p>
<p><a href="#id17"><span class="problematic" id="id18">``</span></a>`
INFO  solana_runtime::message_processor] Finalized account CGLhHSuWsp1gT4B7MY2KACqp9RUwQRhcUFfVSuxpSajZ
INFO  solana_runtime::message_processor] Call SBF program CGLhHSuWsp1gT4B7MY2KACqp9RUwQRhcUFfVSuxpSajZ
INFO  solana_runtime::message_processor] Program log: Panicked at: ‘assertion failed: <cite>(left == right)</cite></p>
<blockquote>
<div><blockquote>
<div><p>left: <cite>1</cite>,</p>
</div></blockquote>
<p>right: <cite>2</cite>’, rust/panic/src/lib.rs:22:5</p>
</div></blockquote>
<p>INFO  solana_runtime::message_processor] SBF program consumed 5453 of 200000 units
INFO  solana_runtime::message_processor] SBF program CGLhHSuWsp1gT4B7MY2KACqp9RUwQRhcUFfVSuxpSajZ failed: BPF program panicked
<a href="#id19"><span class="problematic" id="id20">``</span></a><a href="#id21"><span class="problematic" id="id22">`</span></a></p>
<p>### Custom Panic Handler</p>
<p>Programs can override the default panic handler by providing their own
implementation.</p>
<p>First define the <cite>custom-panic</cite> feature in the program’s <cite>Cargo.toml</cite></p>
<p><code class="docutils literal notranslate"><span class="pre">`toml</span>
<span class="pre">[features]</span>
<span class="pre">default</span> <span class="pre">=</span> <span class="pre">[&quot;custom-panic&quot;]</span>
<span class="pre">custom-panic</span> <span class="pre">=</span> <span class="pre">[]</span>
<span class="pre">`</span></code></p>
<p>Then provide a custom implementation of the panic handler:</p>
<p><a href="#id23"><span class="problematic" id="id24">``</span></a><a href="#id25"><span class="problematic" id="id26">`</span></a>rust
#[cfg(all(feature = “custom-panic”, target_os = “solana”))]
#[no_mangle]
fn custom_panic(info: &amp;core::panic::PanicInfo&lt;’_&gt;) {</p>
<blockquote>
<div><p>solana_program::msg!(“program custom panic enabled”);
solana_program::msg!(“{}”, info);</p>
</div></blockquote>
<section id="id27">
<h2>}<a class="headerlink" href="#id27" title="Permalink to this heading">¶</a></h2>
<p>In the above snippit, the default implementation is shown, but developers may
replace that with something that better suits their needs.</p>
<p>One of the side effects of supporting full panic messages by default is that
programs incur the cost of pulling in more of Rust’s <cite>libstd</cite> implementation
into program’s shared object. Typical programs will already be pulling in a
fair amount of <cite>libstd</cite> and may not notice much of an increase in the shared
object size. But programs that explicitly attempt to be very small by avoiding
<cite>libstd</cite> may take a significant impact (~25kb). To eliminate that impact,
programs can provide their own custom panic handler with an empty
implementation.</p>
<p><a href="#id28"><span class="problematic" id="id29">``</span></a><a href="#id30"><span class="problematic" id="id31">`</span></a>rust
#[cfg(all(feature = “custom-panic”, target_os = “solana”))]
#[no_mangle]
fn custom_panic(info: &amp;core::panic::PanicInfo&lt;’_&gt;) {</p>
<blockquote>
<div><p>// Do nothing to save space</p>
</div></blockquote>
</section>
<section id="id32">
<h2>}<a class="headerlink" href="#id32" title="Permalink to this heading">¶</a></h2>
<p>## Compute Budget</p>
<p>Use the system call
[<cite>sol_log_compute_units()</cite>](<a class="reference external" href="https://github.com/solana-labs/solana/blob/d9b0fc0e3eec67dfe4a97d9298b15969b2804fab/sdk/program/src/log.rs#L141">https://github.com/solana-labs/solana/blob/d9b0fc0e3eec67dfe4a97d9298b15969b2804fab/sdk/program/src/log.rs#L141</a>)
to log a message containing the remaining number of compute units the program
may consume before execution is halted</p>
<p>See [compute budget](developing/programming-model/runtime.md#compute-budget)
for more information.</p>
<p>## ELF Dump</p>
<p>The SBF shared object internals can be dumped to a text file to gain more
insight into a program’s composition and what it may be doing at runtime. The
dump will contain both the ELF information as well as a list of all the symbols
and the instructions that implement them. Some of the BPF loader’s error log
messages will reference specific instruction numbers where the error occurred.
These references can be looked up in the ELF dump to identify the offending
instruction and its context.</p>
<p>To create a dump file:</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">$</span> <span class="pre">cd</span> <span class="pre">&lt;program</span> <span class="pre">directory&gt;</span>
<span class="pre">$</span> <span class="pre">cargo</span> <span class="pre">build-bpf</span> <span class="pre">--dump</span>
<span class="pre">`</span></code></p>
<p>## Examples</p>
<p>The [Solana Program Library
github](<a class="reference external" href="https://github.com/solana-labs/solana-program-library/tree/master/examples/rust">https://github.com/solana-labs/solana-program-library/tree/master/examples/rust</a>)
repo contains a collection of Rust examples.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">twit</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, jare.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/src/developing/on-chain-programs/developing-rust.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
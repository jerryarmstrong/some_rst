<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>docs/rpc.md &#8212; twit  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=039e1c02" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=b3ba4146"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="docs-rpc-md">
<h1>docs/rpc.md<a class="headerlink" href="#docs-rpc-md" title="Permalink to this heading">¶</a></h1>
<p>Last edited: 2023-07-27 15:49:41</p>
<p>Contents:</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span><span class="gh"># Connecting with an RPC</span>
</pre></div>
</div>
<p>Contacting the Solana blockchain via an RPC is an important part of any decentralized application. Umi provides a [RpcInterface](<a class="reference external" href="https://umi-docs.vercel.app/interfaces/umi.RpcInterface.html">https://umi-docs.vercel.app/interfaces/umi.RpcInterface.html</a>) that helps us do just that.</p>
<p>## Configuring the RPC’s endpoint</p>
<p>When creating a new Umi instance via the default bundle, you must pass the RPC’s endpoint as the first argument. Going forward, this it the endpoint that will be used every time you call a method on the RPC interface.</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>ts
import { createUmi } from <a class="reference external" href="mailto:'&#37;&#52;&#48;metaplex-foundation/umi-bundle-defaults">‘<span>&#64;</span>metaplex-foundation/umi-bundle-defaults</a>’;</p>
<p>const umi = createUmi(”<a class="reference external" href="https://api.mainnet-beta.solana.com">https://api.mainnet-beta.solana.com</a>”);
<a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<p>Alternatively, you may set or update the RPC implementation explicitly by the using the plugin they provide. For instance, the <cite>web3JsRpc</cite> plugin will set the RPC implementation to use the <cite>&#64;solana/web3.js</cite> library.</p>
<p><a href="#id9"><span class="problematic" id="id10">``</span></a><a href="#id11"><span class="problematic" id="id12">`</span></a>ts
import { web3JsRpc } from <a class="reference external" href="mailto:'&#37;&#52;&#48;metaplex-foundation/umi-rpc-web3js">‘<span>&#64;</span>metaplex-foundation/umi-rpc-web3js</a>’;</p>
<p>umi.use(web3JsRpc(”<a class="reference external" href="https://api.mainnet-beta.solana.com">https://api.mainnet-beta.solana.com</a>”));
<a href="#id13"><span class="problematic" id="id14">``</span></a><a href="#id15"><span class="problematic" id="id16">`</span></a></p>
<p>## Getting the RPC’s endpoint and cluster</p>
<p>Once an RPC implementation has been set, you may access its endpoint and cluster via the following methods:</p>
<p><code class="docutils literal notranslate"><span class="pre">`ts</span>
<span class="pre">const</span> <span class="pre">endpoint</span> <span class="pre">=</span> <span class="pre">umi.rpc.getEndpoint();</span>
<span class="pre">const</span> <span class="pre">cluster</span> <span class="pre">=</span> <span class="pre">umi.rpc.getCluster();</span>
<span class="pre">`</span></code></p>
<p>Where <cite>cluster</cite> is one of the following:</p>
<p><code class="docutils literal notranslate"><span class="pre">`ts</span>
<span class="pre">type</span> <span class="pre">Cluster</span> <span class="pre">=</span> <span class="pre">&quot;mainnet-beta&quot;</span> <span class="pre">|</span> <span class="pre">&quot;devnet&quot;</span> <span class="pre">|</span> <span class="pre">&quot;testnet&quot;</span> <span class="pre">|</span> <span class="pre">&quot;localnet&quot;</span> <span class="pre">|</span> <span class="pre">&quot;custom&quot;</span>
<span class="pre">`</span></code></p>
<p>## Sending transactions</p>
<p>The following methods can be used to send, confirm and fetch transactions:</p>
<p><code class="docutils literal notranslate"><span class="pre">`ts</span>
<span class="pre">const</span> <span class="pre">signature</span> <span class="pre">=</span> <span class="pre">await</span> <span class="pre">umi.rpc.sendTransaction(myTransaction);</span>
<span class="pre">const</span> <span class="pre">confirmResult</span> <span class="pre">=</span> <span class="pre">await</span> <span class="pre">umi.rpc.confirmTransaction(signature,</span> <span class="pre">{</span> <span class="pre">strategy</span> <span class="pre">});</span>
<span class="pre">const</span> <span class="pre">transaction</span> <span class="pre">=</span> <span class="pre">await</span> <span class="pre">umi.rpc.getTransaction(signature);</span>
<span class="pre">`</span></code></p>
<p>Since transactions are an important component of Solana clients, we discuss them in more detail on the [Sending transactions](./transactions.md) documentation page.</p>
<p>## Fetching accounts</p>
<p>The following methods can be used to fetch accounts or check for their existence:</p>
<p><code class="docutils literal notranslate"><span class="pre">`ts</span>
<span class="pre">const</span> <span class="pre">accountExists</span> <span class="pre">=</span> <span class="pre">await</span> <span class="pre">umi.rpc.accountExists(myPublicKey);</span>
<span class="pre">const</span> <span class="pre">maybeAccount</span> <span class="pre">=</span> <span class="pre">await</span> <span class="pre">umi.rpc.getAccount(myPublicKey);</span>
<span class="pre">const</span> <span class="pre">maybeAccounts</span> <span class="pre">=</span> <span class="pre">await</span> <span class="pre">umi.rpc.getAccounts(myPublicKeys);</span>
<span class="pre">const</span> <span class="pre">accounts</span> <span class="pre">=</span> <span class="pre">await</span> <span class="pre">umi.rpc.getProgramAccounts(myProgramId,</span> <span class="pre">{</span> <span class="pre">filters</span> <span class="pre">});</span>
<span class="pre">`</span></code></p>
<p>Since fetching accounts is one of the most common operations, we discuss it in more detail on the [Fetching accounts](./accounts.md) documentation page.</p>
<p>## Airdropping SOL on supported clusters</p>
<p>If the used cluster supports airdrops, you can use the following method to send SOL to an account and confirm the request.</p>
<p><code class="docutils literal notranslate"><span class="pre">`ts</span>
<span class="pre">//</span> <span class="pre">Send</span> <span class="pre">1.5</span> <span class="pre">SOL</span> <span class="pre">to</span> <span class="pre">&quot;myPublicKey&quot;</span> <span class="pre">and</span> <span class="pre">wait</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">transaction</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">confirmed.</span>
<span class="pre">await</span> <span class="pre">umi.rpc.airdrop(myPublicKey,</span> <span class="pre">sol(1.5));</span>
<span class="pre">`</span></code></p>
<p>## Getting the balance of an account</p>
<p>You may use the following method to get the SOL balance of any account. This will return a <cite>SolAmount</cite> object [as documented here](./helpers.md#amounts).</p>
<p><code class="docutils literal notranslate"><span class="pre">`ts</span>
<span class="pre">const</span> <span class="pre">balance</span> <span class="pre">=</span> <span class="pre">await</span> <span class="pre">umi.rpc.getBalance(myPublicKey);</span>
<span class="pre">`</span></code></p>
<p>## Getting the latest blockhash</p>
<p>You may get the latest blockhash with its expiry block height via the following method:</p>
<p><code class="docutils literal notranslate"><span class="pre">`ts</span>
<span class="pre">const</span> <span class="pre">{</span> <span class="pre">blockhash,</span> <span class="pre">lastValidBlockHeight</span> <span class="pre">}</span> <span class="pre">=</span> <span class="pre">await</span> <span class="pre">umi.rpc.getLatestBlockhash();</span>
<span class="pre">`</span></code></p>
<p>## Getting the most recent slot</p>
<p>You may get the most recent slot as a number via the following method:</p>
<p><code class="docutils literal notranslate"><span class="pre">`ts</span>
<span class="pre">const</span> <span class="pre">recentSlot</span> <span class="pre">=</span> <span class="pre">await</span> <span class="pre">umi.rpc.getSlot();</span>
<span class="pre">`</span></code></p>
<p>## Getting the rent exemption</p>
<p>If you need to figure out the storage fees for an account, you may use the <cite>getRent</cite> method and pass in the amount bytes that the account’s data will require. This will return the rent-exemption fee — a.k.a storage fee — as a <cite>SolAmount</cite>.</p>
<blockquote>
<div><p><a href="#id17"><span class="problematic" id="id18">``</span></a><a href="#id19"><span class="problematic" id="id20">`</span></a>ts</p>
</div></blockquote>
<p>const rent = await umi.rpc.getRent(100);
<a href="#id21"><span class="problematic" id="id22">``</span></a><a href="#id23"><span class="problematic" id="id24">`</span></a></p>
<p>Note that this will automatically take the size of the account header into consideration so you only need to pass in the bytes of the account’s data.</p>
<p>Say you now wanted to get the rent-exemption fee for 3 accounts with 100 bytes of data each. Running <cite>umi.rpc.getRent(100 * 3)</cite> will not provide an accurate response since it will only add the account header for one account and not three. This is why Umi allows you to pass in the account header size explicitly by setting the <cite>includesHeaderBytes</cite> option to <cite>true</cite>.</p>
<p><a href="#id25"><span class="problematic" id="id26">``</span></a><a href="#id27"><span class="problematic" id="id28">`</span></a>ts
const rent = await umi.rpc.getRent((ACCOUNT_HEADER_SIZE + 100) * 3, {</p>
<blockquote>
<div><p>includesHeaderBytes: true</p>
</div></blockquote>
<section id="id29">
<h2>});<a class="headerlink" href="#id29" title="Permalink to this heading">¶</a></h2>
<p>## Sending custom RPC requests</p>
<p>Because each RPC endpoint may provide their own custom methods, Umi allows you to send custom requests to the RPC via the <cite>call</cite> method. It takes the method name as the first argument and an optional array of parameters as the second argument.</p>
<p><code class="docutils literal notranslate"><span class="pre">`ts</span>
<span class="pre">const</span> <span class="pre">rpcResult</span> <span class="pre">=</span> <span class="pre">await</span> <span class="pre">umi.rpc.call(&quot;myCustomMethod&quot;,</span> <span class="pre">[myFirstParam,</span> <span class="pre">mySecondParam]);</span>
<span class="pre">`</span></code></p>
<p>&lt;p align=”center”&gt;
&lt;strong&gt;Next: &lt;a href=”./transactions.md”&gt;Sending transactions ≫&lt;/a&gt;&lt;/strong&gt;
&lt;/p&gt;</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">twit</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, jare.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/rpc.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>